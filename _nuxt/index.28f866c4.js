import Se from"./toast.esm.ef8cdcd7.js";import te from"./button.esm.a55c2431.js";import Ne from"./multiselect.esm.aa936d27.js";import Me from"./inputicon.esm.d7523654.js";import oe from"./inputtext.esm.5cd40da3.js";import De from"./iconfield.esm.1b32a169.js";import Pe from"./toolbar.esm.473997f4.js";import Le from"./progressspinner.esm.2773c17b.js";import{ao as se,$ as l,a3 as ae,a4 as ie,ar as me,o as I,b as X,i as t,l as o,u as e,a5 as v,e as A,ap as ne,aq as re,q as H,a6 as de,c as z,w as M,P as Ae,a as Te,s as Be}from"./entry.570ab878.js";import{u as K,a as _e}from"./cookie.3ed14f9e.js";import{u as ue}from"./fetch.11b9759f.js";import Y from"./column.esm.6208f1b7.js";import Fe from"./datatable.esm.3837e306.js";import he from"./textarea.esm.c90f9326.js";import Oe from"./password.esm.4c141a5a.js";import ve from"./dropdown.esm.4fa36b0b.js";import{a as ee}from"./usePermission.23a55d5e.js";import le from"./dialog.esm.0b6d087d.js";import"./portal.esm.1e4af6e4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./baseicon.esm.c7f0dea4.js";import"./index.esm.2547ec1e.js";import"./index.esm.c6f3b761.js";import"./index.esm.417f68ee.js";import"./badge.esm.54d3e6c5.js";import"./index.esm.b72e702d.js";import"./checkbox.esm.1ad534d4.js";import"./index.esm.d468d720.js";import"./index.esm.2cce7489.js";import"./overlayeventbus.esm.c91907e9.js";import"./virtualscroller.esm.84c3372a.js";import"./paginator.esm.23dce669.js";import"./index.esm.c592065e.js";import"./inputnumber.esm.9d737ca0.js";import"./index.esm.bb3da758.js";import"./index.esm.e450f24c.js";import"./index.esm.f3846021.js";import"./index.esm.b806f7cb.js";import"./index.esm.feb1baca.js";import"./radiobutton.esm.b232767f.js";import"./index.esm.a8b59750.js";import"./index.esm.ecdc2543.js";import"./index.esm.3c79b49a.js";const Z=d=>(ne("data-v-3127aac2"),d=d(),re(),d),Re={class:"field"},He=Z(()=>t("label",{for:"company"},[H("Name"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),ze={class:"field"},qe=Z(()=>t("label",{for:"email"},[H("Email address"),t("i",{class:"text-red-400"},"*")],-1)),je={class:"field"},Ge=Z(()=>t("label",{for:"phoneNo"},"Phone ",-1)),Ye={class:"field"},Ke=Z(()=>t("label",{for:"company"},"Address ",-1)),Xe={class:"field"},Ze=Z(()=>t("label",{for:"company"},[H("Password"),t("i",{class:"text-red-400"},"*")],-1)),Je={class:"field"},Qe=Z(()=>t("label",{for:"company"},"Employee ID ",-1)),We={class:"field flex flex-column"},el=Z(()=>t("label",null,[H("Role"),t("i",{class:"text-red-400"},"*")],-1)),ll={key:0,style:{color:"red"}},tl={class:"create-btn-wrapper mb-0"},ol={__name:"CreateEmployee",props:{param:{type:Object,required:!0}},emits:["closeCreateModal"],setup(d,{emit:T}){const q=de(),P=l(d.param.rolesLists),w=l([]),y=ae(),r=l(""),c=l(""),b=l(""),k=l(""),f=l(""),E=l("");l("");const p=l(!1),$=l(!0),U=T,_=l(!1),B=async()=>{var m,a,u;if(_.value=!0,r.value===""||c.value===""||f.value===""||w.value.length===0){p.value=!0,_.value=!1;return}else if(p.value=!1,!p.value){const D=K("token"),{data:C,error:h,pending:g}=await ue(`${q.public.apiUrl}/users/create`,{method:"POST",headers:{Authorization:`Bearer ${D.value}`},body:{name:r.value,email:c.value,address:k.value,phone:b.value,password:f.value,employee_id:E.value,password_confirmation:f.value,role:w.value.name}},"$HYNtwi2ZAs");if(h!=null&&h.value){if(((a=(m=h==null?void 0:h.value)==null?void 0:m.data)==null?void 0:a.code)===422){_.value=!1,y.add({severity:"error",summary:"Error",detail:"Email already exists!",group:"br",life:3e3});return}}else if(((u=C==null?void 0:C.value)==null?void 0:u.code)===201){_.value=!1,r.value=null,c.value=null,b.value=null,k.value=null,f.value=null,$.value=!1,U("closeCreateModal",!1),y.add({severity:"success",summary:"Success",detail:"Employee created successfully!",group:"br",life:3e3});return}else{_.value=!1,y.add({severity:"error",summary:"Error",detail:"Failed to create employee!",group:"br",life:3e3});return}}};return ie(()=>{const m=document.getElementById("createEmployeeName");me(()=>{m&&m.focus()})}),(m,a)=>{const u=oe,D=he,C=Oe,h=ve,g=te;return I(),X("div",null,[t("div",Re,[He,o(u,{id:"createEmployeeName",modelValue:e(r),"onUpdate:modelValue":a[0]||(a[0]=V=>v(r)?r.value=V:null),class:"w-full",placeholder:"Enter Name"},null,8,["modelValue"])]),t("div",ze,[qe,o(u,{type:"email",modelValue:e(c),"onUpdate:modelValue":a[1]||(a[1]=V=>v(c)?c.value=V:null),class:"w-full",placeholder:"Enter Email"},null,8,["modelValue"])]),t("div",je,[Ge,o(u,{modelValue:e(b),"onUpdate:modelValue":a[2]||(a[2]=V=>v(b)?b.value=V:null),inputId:"worktype",type:"tel",class:"w-full",maxlength:"14",placeholder:"Enter Phone No."},null,8,["modelValue"])]),t("div",Ye,[Ke,o(D,{modelValue:e(k),"onUpdate:modelValue":a[3]||(a[3]=V=>v(k)?k.value=V:null),rows:"3",cols:"20",class:"w-full",placeholder:"Enter Address"},null,8,["modelValue"])]),t("div",Xe,[Ze,o(C,{modelValue:e(f),"onUpdate:modelValue":a[4]||(a[4]=V=>v(f)?f.value=V:null),placeholder:"Enter password",feedback:!1,invalid:m.confirmPassError,toggleMask:"",class:"w-full",inputClass:"w-full"},null,8,["modelValue","invalid"])]),t("div",Je,[Qe,o(u,{modelValue:e(E),"onUpdate:modelValue":a[5]||(a[5]=V=>v(E)?E.value=V:null),class:"w-full",placeholder:"Enter Employee ID"},null,8,["modelValue"])]),t("div",We,[el,o(h,{modelValue:e(w),"onUpdate:modelValue":a[6]||(a[6]=V=>v(w)?w.value=V:null),options:e(P),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Role",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e(p)?(I(),X("p",ll,"Please fill/check up all the fields")):A("",!0),t("div",tl,[o(g,{loading:e(_),label:"Save",icon:"pi pi-check",text:"",onClick:B},null,8,["loading"])])])}}},sl=se(ol,[["__scopeId","data-v-3127aac2"]]);const Q=d=>(ne("data-v-b429c25a"),d=d(),re(),d),al={class:"field"},il=Q(()=>t("label",{for:"company"},[H("Name"),t("i",{class:"text-red-500"},"*")],-1)),nl={class:"field"},rl=Q(()=>t("label",{for:"email"},[H("Email address"),t("i",{class:"text-red-500"},"*")],-1)),dl={class:"field"},ul=Q(()=>t("label",{for:"worktype"},"Phone",-1)),cl={class:"field"},pl=Q(()=>t("label",{for:"company"},"Address",-1)),ml={class:"field"},vl=Q(()=>t("label",{for:"company"},"Employee ID ",-1)),fl={class:"field flex flex-column"},yl=Q(()=>t("label",null,[H("Role"),t("i",{class:"text-red-500"},"*")],-1)),_l={key:0,style:{color:"red"}},hl={class:"create-btn-wrappe"},bl={__name:"EditEmployee",props:{param:{type:Object,required:!0}},emits:["closeEditModal"],setup(d,{emit:T}){const q=de(),S=d,P=ae(),w=l(S.param.id),y=l(S.param.name),r=l(S.param.email),c=l(S.param.phone),b=l(S.param.address),k=l(S.param.rolesLists),f=l(S.param.user_type),E=l(S.param.employeeId),p=l(!1),$=l(!0),U=T,_=l(!1),B=async()=>{var m,a,u;if(_.value=!0,y.value===""||r.value===""){p.value=!0,_.value=!1;return}else if(p.value=!1,!p.value){const D=K("token"),{data:C,error:h,pending:g}=await ue(`${q.public.apiUrl}/users/update/${w.value}`,{method:"POST",headers:{Authorization:`Bearer ${D.value}`},body:{name:y.value,email:r.value,address:b.value,phone:c.value,role:f.value.name,employee_id:E.value}},"$D8HfpvkorG");if(h!=null&&h.value){if(((a=(m=h==null?void 0:h.value)==null?void 0:m.data)==null?void 0:a.code)===500){_.value=!1,P.add({severity:"error",summary:"Error",detail:"Email already exists!",group:"br",life:3e3});return}}else if(((u=C==null?void 0:C.value)==null?void 0:u.code)===200){_.value=!1,$.value=!1,U("closeEditModal",!1),P.add({severity:"success",summary:"Success",detail:"Employee Updated successfully!",group:"br",life:3e3});return}else{_.value=!1,P.add({severity:"error",summary:"Error",detail:"Failed to update employee!",group:"br",life:3e3});return}}};return ie(()=>{const m=document.getElementById("editEmployeeName");me(()=>{m&&m.focus()})}),(m,a)=>{const u=oe,D=he,C=ve,h=te;return I(),X("div",null,[t("div",al,[il,o(u,{id:"editEmployeeName",modelValue:e(y),"onUpdate:modelValue":a[0]||(a[0]=g=>v(y)?y.value=g:null),class:"w-full",placeholder:"Edit Name"},null,8,["modelValue"])]),t("div",nl,[rl,o(u,{type:"email",modelValue:e(r),"onUpdate:modelValue":a[1]||(a[1]=g=>v(r)?r.value=g:null),class:"w-full",placeholder:"Edit Email"},null,8,["modelValue"])]),t("div",dl,[ul,o(u,{modelValue:e(c),"onUpdate:modelValue":a[2]||(a[2]=g=>v(c)?c.value=g:null),type:"tel",class:"w-full",placeholder:"Edit Phone No."},null,8,["modelValue"])]),t("div",cl,[pl,o(D,{modelValue:e(b),"onUpdate:modelValue":a[3]||(a[3]=g=>v(b)?b.value=g:null),rows:"3",cols:"20",class:"w-full",placeholder:"Edit Address"},null,8,["modelValue"])]),t("div",ml,[vl,o(u,{modelValue:e(E),"onUpdate:modelValue":a[4]||(a[4]=g=>v(E)?E.value=g:null),class:"w-full",placeholder:"Edit Employee ID"},null,8,["modelValue"])]),t("div",fl,[yl,o(C,{modelValue:e(f),"onUpdate:modelValue":a[5]||(a[5]=g=>v(f)?f.value=g:null),options:e(k),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Role",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e(p)?(I(),X("p",_l,"Please fill/check up all the fields")):A("",!0),t("div",hl,[o(h,{label:"Update",icon:"pi pi-check",text:"",onClick:B,loading:e(_)},null,8,["loading"])])])}}},El=se(bl,[["__scopeId","data-v-b429c25a"]]);const be=d=>(ne("data-v-d515e90e"),d=d(),re(),d),$l={class:"field"},gl=be(()=>t("label",{for:"email"},[H("Email address"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),xl={class:"field flex flex-column"},wl=be(()=>t("label",null,[H("Role"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),kl={key:0,style:{color:"red"}},Vl={class:"create-btn-wrapper"},Il={__name:"InviteGuest",props:{param:{type:Object,required:!0}},emits:["closeInviteModal"],setup(d,{emit:T}){const q=de(),P=l(d.param.rolesLists),w=l([]),y=ae(),r=l(""),c=l(!1),b=l("false"),k=l(!0),f=T,E=async()=>{var p;if(r.value===""||w.value.length===0){c.value=!0;return}else if(b.value=!0,c.value=!1,!c.value){const $=K("token"),{data:U,pending:_}=await ue(`${q.public.apiUrl}/invite-user`,{method:"POST",headers:{Authorization:`Bearer ${$.value}`},body:{email:r.value,role:w.value.name}},"$uaOzqXhdzF");((p=U==null?void 0:U.value)==null?void 0:p.code)===201?(r.value=null,k.value=!1,f("closeInviteModal",!1),b.value=!1,y.add({severity:"success",summary:"Success",detail:"Employee invitation sent!",group:"br",life:3e3})):y.add({severity:"error",summary:"Error",detail:"Employee invitation failed!",group:"br",life:3e3})}};return ie(()=>{const p=document.getElementById("inviteEmail");me(()=>{p&&p.focus()})}),(p,$)=>{const U=oe,_=ve,B=te;return I(),X("div",null,[t("div",$l,[gl,o(U,{id:"inviteEmail",type:"email",modelValue:e(r),"onUpdate:modelValue":$[0]||($[0]=m=>v(r)?r.value=m:null),class:"w-full"},null,8,["modelValue"])]),t("div",xl,[wl,o(_,{modelValue:e(w),"onUpdate:modelValue":$[1]||($[1]=m=>v(w)?w.value=m:null),options:e(P),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Role",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e(c)?(I(),X("p",kl,"Please fill/check up all the fields")):A("",!0),t("div",Vl,[e(b)=="false"?(I(),z(B,{key:0,label:"Send",icon:"pi pi-check",text:"",onClick:E})):(I(),z(B,{key:1,label:"Sending...",icon:"pi pi-spin pi-spinner",text:"",disabled:""}))])])}}},Ul=se(Il,[["__scopeId","data-v-d515e90e"]]);const ce=d=>(ne("data-v-c52d75a6"),d=d(),re(),d),Cl={key:0,class:"card"},Sl={class:"d-flex mr-2"},Nl=ce(()=>t("div",{class:"d-flex mr-2"},[t("h5",{class:"mb-1"},"Employee List")],-1)),Ml=ce(()=>t("i",{class:"pi pi-search"},null,-1)),Dl=ce(()=>t("p",{class:"text-center"},"No Data found...",-1)),Pl=ce(()=>t("p",null,"Are you sure you want to delete?",-1)),Ll={__name:"index",setup(d){const T=de(),q=l(ee("read_user")),S=l(ee("create_user")),P=l(ee("update_user")),w=l(ee("delete_user")),y=l(),r=l(!0),c=l(!1),b=ae(),k=l(!1),f=l(!1),E=l(!1),p=l([]),$=l(!1),U=l(""),_=l(""),B=l(""),m=l(""),a=l(""),u=l([]),D=l([]),C=l(""),h=i=>{k.value=!1,J()},g=i=>{E.value=!1,J()},V=()=>{k.value=!0},Ee=()=>{f.value=!0},$e=i=>{f.value=!1,J()},W=l([]),fe=l([]),ge=i=>{E.value=!0,U.value=i.id,_.value=i.name,B.value=i.email,m.value=i.phone,a.value=i.address,D.value=i.user_type,C.value=i.employee_id,u.value.map(s=>{s.name===i.user_type&&(D.value=s)})},xe=i=>{$.value=!0,U.value=i},we=async()=>{c.value=!0;const i=K("token"),{data:s,pending:N}=await ue(`${T.public.apiUrl}/users/delete/${U.value}`,{method:"DELETE",headers:{Authorization:`Bearer ${i.value}`}},"$BmbV2j3TY3");s.value.code===200?($.value=!1,b.add({severity:"success",summary:"Success",detail:"Employee Deleted successfully!",group:"br",life:3e3}),c.value=!1,J()):(b.add({severity:"error",summary:"Error",detail:"Employee Deleted Failed!",group:"br",life:3e3}),c.value=!1)},ye=l(),ke=async()=>{ye.value=W.value?W.value.map(i=>i.id):"",J(ye.value)},J=async i=>{var F,O,R;const s=K("token"),{data:N,pending:x,error:j}=await _e("taskAssignModalData",()=>$fetch(`${T.public.apiUrl}/users/list${i?`?role_id=${i}`:""}`,{headers:{Authorization:`Bearer ${s.value}`}}));((O=(F=N.value)==null?void 0:F.data)==null?void 0:O.length)>0&&(p.value=(R=N.value)==null?void 0:R.data.map((L,G)=>({...L,index:G+1})))},Ve=async()=>{var j,F,O,R;const i=K("token"),{data:s,pending:N,error:x}=await _e("roleLiist",()=>$fetch(`${T.public.apiUrl}/roles/list`,{headers:{Authorization:`Bearer ${i.value}`}}));((F=(j=s.value)==null?void 0:j.data)==null?void 0:F.length)>0&&(u.value=(O=s.value)==null?void 0:O.data.map((L,G)=>({...L,index:G+1})),fe.value=(R=s.value)==null?void 0:R.data.map(L=>({name:L.name,id:L.id})),console.log("rolesLists",u.value))},Ie=()=>{y.value={global:{value:null,matchMode:Ae.CONTAINS}}};K("rolePermission"),ie(()=>{J(),Ve(),r.value=!1}),Ie();const Ue=()=>{if(p.value.length>0){const i=`data:text/csv;charset=utf-8,"Serial No.","Employee Name","Email","Phone","Address","User Type",
`+p.value.map((x,j)=>{const F=j+1,O=x.name,R=x.email,L=x.phone,G=x.address,pe=x.user_type;return`"${F}","${O}","${R}","${L}","${G}","${pe}"`}).join(`
`),s=encodeURI(i),N=document.createElement("a");N.setAttribute("href",s),N.setAttribute("download","tasks.csv"),document.body.appendChild(N),N.click(),document.body.removeChild(N)}else b.add({severity:"error",summary:"Error",detail:"No data found to download",group:"br",life:3e3})};return(i,s)=>{const N=Se,x=te,j=Ne,F=Me,O=oe,R=De,L=Pe,G=Le,pe=Te("tooltip");return e(q)?(I(),X("div",Cl,[t("div",Sl,[o(N,{position:"bottom-right",group:"br"}),Nl]),o(L,{class:"border-0 px-0"},{start:M(()=>[e(S)?(I(),z(x,{key:0,icon:"pi pi-plus",label:"Create",onClick:V,class:"mr-2",severity:"secondary"})):A("",!0),e(S)?(I(),z(x,{key:1,icon:"pi pi-users",onClick:Ee,label:"Invite a guest",severity:"secondary"})):A("",!0)]),end:M(()=>[Be(o(x,{onClick:s[0]||(s[0]=n=>Ue(i.tasks)),loading:e(r),severity:"secondary",class:"px-4",icon:"pi pi-file-excel"},null,8,["loading"]),[[pe,{value:"Download Employee List"},void 0,{left:!0}]]),o(j,{onChange:s[1]||(s[1]=n=>ke()),modelValue:e(W),"onUpdate:modelValue":s[2]||(s[2]=n=>v(W)?W.value=n:null),options:e(fe),display:"chip",filter:"",resetFilterOnHide:"",maxSelectedLabels:2,optionLabel:"name",placeholder:"Filter User Type",class:"w-full mx-2 filtr"},null,8,["modelValue","options"]),o(R,{iconPosition:"right",raised:""},{default:M(()=>[o(F,null,{default:M(()=>[Ml]),_:1}),o(O,{modelValue:e(y).global.value,"onUpdate:modelValue":s[3]||(s[3]=n=>e(y).global.value=n),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),_:1}),o(e(Fe),{filters:e(y),"onUpdate:filters":s[4]||(s[4]=n=>v(y)?y.value=n:null),class:"table-st",value:e(p),stripedRows:"",paginator:"",rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem",rows:10,dataKey:"id",filterDisplay:"menu",loading:e(r)},{empty:M(()=>[Dl]),loading:M(()=>[o(G,{style:{width:"50px",height:"50px"}})]),default:M(()=>[o(e(Y),{field:"index",header:"Serial",sortable:""}),o(e(Y),{field:"name",header:"Employee Name"}),o(e(Y),{field:"email",header:"Email Address"}),o(e(Y),{field:"employee_id",header:"Employee ID"}),o(e(Y),{field:"phone",header:"Phone"}),o(e(Y),{field:"user_type",header:"User Type"}),o(e(Y),{field:"action",header:"Action"},{body:M(n=>[e(P)?(I(),z(x,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:Ce=>ge(n.data)},null,8,["onClick"])):A("",!0),e(P)?A("",!0):(I(),z(x,{key:1,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",style:{visibility:"hidden"}})),e(w)?(I(),z(x,{key:2,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:Ce=>xe(n.data.id)},null,8,["onClick"])):A("",!0),e(w)?A("",!0):(I(),z(x,{key:3,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),o(e(le),{visible:e(k),"onUpdate:visible":s[6]||(s[6]=n=>v(k)?k.value=n:null),modal:"",header:"Create Employee",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:M(()=>[o(sl,{param:{rolesLists:e(u)},onCloseCreateModal:s[5]||(s[5]=n=>h(n))},null,8,["param"])]),_:1},8,["visible"]),o(e(le),{visible:e(E),"onUpdate:visible":s[8]||(s[8]=n=>v(E)?E.value=n:null),modal:"",header:"Edit Employee",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:M(()=>[o(El,{param:{id:e(U),name:e(_),address:e(a),phone:e(m),email:e(B),user_type:e(D),employeeId:e(C),rolesLists:e(u)},onCloseEditModal:s[7]||(s[7]=n=>g(n))},null,8,["param"])]),_:1},8,["visible"]),o(e(le),{visible:e($),"onUpdate:visible":s[10]||(s[10]=n=>v($)?$.value=n:null),header:" ",style:{width:"25rem"},dismissableMask:"true"},{default:M(()=>[Pl,o(x,{label:"No",icon:"pi pi-times",text:"",onClick:s[9]||(s[9]=n=>$.value=!1)}),o(x,{label:"Yes",icon:"pi pi-check",text:"",onClick:we,loading:e(c)},null,8,["loading"])]),_:1},8,["visible"]),o(e(le),{visible:e(f),"onUpdate:visible":s[12]||(s[12]=n=>v(f)?f.value=n:null),modal:"",header:"Invite Employee",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:M(()=>[o(Ul,{param:{rolesLists:e(u)},onCloseInviteModal:s[11]||(s[11]=n=>$e(n))},null,8,["param"])]),_:1},8,["visible"])])):A("",!0)}}},Vt=se(Ll,[["__scopeId","data-v-c52d75a6"]]);export{Vt as default};
