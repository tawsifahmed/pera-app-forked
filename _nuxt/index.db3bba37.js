import Ve from"./toast.esm.ef8cdcd7.js";import de from"./button.esm.a55c2431.js";import Se from"./inputicon.esm.d7523654.js";import ce from"./inputtext.esm.5cd40da3.js";import Ce from"./iconfield.esm.1b32a169.js";import De from"./toolbar.esm.473997f4.js";import Ee from"./progressspinner.esm.2773c17b.js";import{ao as ue,$ as l,a3 as me,a4 as pe,ar as ge,o as w,b as E,i as t,l as a,u as e,a5 as h,e as z,ap as ve,aq as fe,q as I,a6 as _e,w as b,P as Ne,c as ie,t as ne,F as he,f as ye,K as Ue}from"./entry.570ab878.js";import{u as X,a as Ie}from"./cookie.3ed14f9e.js";import{u as be}from"./fetch.11b9759f.js";import A from"./column.esm.6208f1b7.js";import Be from"./datatable.esm.3837e306.js";import xe from"./textarea.esm.c90f9326.js";import Te from"./dropdown.esm.4fa36b0b.js";import $e from"./multiselect.esm.aa936d27.js";import{u as Z}from"./company.198e2c6a.js";import{a as W}from"./usePermission.23a55d5e.js";import re from"./dialog.esm.0b6d087d.js";import"./portal.esm.1e4af6e4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./baseicon.esm.c7f0dea4.js";import"./index.esm.2547ec1e.js";import"./index.esm.c6f3b761.js";import"./index.esm.417f68ee.js";import"./badge.esm.54d3e6c5.js";import"./index.esm.b72e702d.js";import"./paginator.esm.23dce669.js";import"./index.esm.c592065e.js";import"./inputnumber.esm.9d737ca0.js";import"./index.esm.bb3da758.js";import"./index.esm.e450f24c.js";import"./index.esm.f3846021.js";import"./index.esm.d468d720.js";import"./index.esm.2cce7489.js";import"./overlayeventbus.esm.c91907e9.js";import"./virtualscroller.esm.84c3372a.js";import"./index.esm.b806f7cb.js";import"./index.esm.feb1baca.js";import"./checkbox.esm.1ad534d4.js";import"./radiobutton.esm.b232767f.js";import"./index.esm.a8b59750.js";import"./index.esm.ecdc2543.js";import"./workCompany.886927d5.js";const R=c=>(ve("data-v-001db4c9"),c=c(),fe(),c),Ae={class:"field"},Fe=R(()=>t("label",{for:"company"},[I("Name"),t("i",{class:"text-red-400"},"*")],-1)),Oe={class:"field flex flex-column"},qe=R(()=>t("label",{for:"email"},"Description ",-1)),ze={class:"field flex flex-column"},je=R(()=>t("label",null,[I("Line Manager"),t("i",{class:"text-red-400"},"*")],-1)),He={class:"field flex flex-column"},Ke=R(()=>t("label",null,[I("Team Lead"),t("i",{class:"text-red-400"},"*")],-1)),Re={class:"field"},Qe=R(()=>t("label",null,[I("Team Members"),t("i",{class:"text-red-400"},"*")],-1)),Ye={key:0,style:{color:"red"}},Ge={class:"create-btn-wrapper mb-0"},Je={__name:"CreateTeam",props:{param:{type:Object,required:!0}},emits:["closeCreateModal"],setup(c,{emit:j}){const F=_e(),B=l(c.param.usersLists),m=l([]),k=l([]),L=l([]),p=me(),_=l(""),v=l(""),x=l(!1),y=l(!1),T=l(!0),$=j,V=l(!1),O=async()=>{var i;if(V.value=!0,_.value===""||m.value.length===0||k.value.length===0||L.value.length===0){y.value=!0,V.value=!1;return}else if(y.value=!1,!y.value){const n=X("token"),{data:u,error:r,pending:g}=await be(`${F.public.apiUrl}/teams/create`,{method:"POST",headers:{Authorization:`Bearer ${n.value}`},body:{name:_.value,description:v.value,team_lead_id:m.value.id,line_manager_id:k.value.id,members:L.value.map(S=>S.id)}},"$LDh3IAOr92");if(((i=u==null?void 0:u.value)==null?void 0:i.code)===201){V.value=!1,_.value=null,v.value=null,m.value=[],k.value=[],L.value=[],T.value=!1,$("closeCreateModal",!1),p.add({severity:"success",summary:"Success",detail:"Team created successfully!",group:"br",life:3e3});return}else{V.value=!1,p.add({severity:"error",summary:"Error",detail:"Failed to create team!",group:"br",life:3e3});return}}};return pe(()=>{const i=document.getElementById("createTeamName");ge(()=>{i&&i.focus()})}),(i,n)=>{const u=ce,r=xe,g=Te,S=$e,D=de;return w(),E("div",null,[t("div",Ae,[Fe,a(u,{id:"createTeamName",modelValue:e(_),"onUpdate:modelValue":n[0]||(n[0]=f=>h(_)?_.value=f:null),class:"w-full"},null,8,["modelValue"])]),t("div",Oe,[qe,a(r,{id:"description",class:"border-gray-300",modelValue:e(v),"onUpdate:modelValue":n[1]||(n[1]=f=>h(v)?v.value=f:null),rows:"3",cols:"20",invalid:e(x)},null,8,["modelValue","invalid"])]),t("div",ze,[je,a(g,{modelValue:e(k),"onUpdate:modelValue":n[2]||(n[2]=f=>h(k)?k.value=f:null),options:e(B),optionLabel:"name",placeholder:"Select Line Manager",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),t("div",He,[Ke,a(g,{modelValue:e(m),"onUpdate:modelValue":n[3]||(n[3]=f=>h(m)?m.value=f:null),options:e(B),optionLabel:"name",placeholder:"Select Team Lead",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),t("div",Re,[Qe,a(S,{display:"chip",modelValue:e(L),"onUpdate:modelValue":n[4]||(n[4]=f=>h(L)?L.value=f:null),options:e(B),filter:"",optionLabel:"name",placeholder:"Select Team Members",class:"w-full"},null,8,["modelValue","options"])]),e(y)?(w(),E("p",Ye,"Please fill/check up all the fields")):z("",!0),t("div",Ge,[a(D,{loading:e(V),label:"Save",icon:"pi pi-check",text:"",onClick:O},null,8,["loading"])])])}}},Pe=ue(Je,[["__scopeId","data-v-001db4c9"]]);const Q=c=>(ve("data-v-e4bdffc0"),c=c(),fe(),c),We={class:"field"},Xe=Q(()=>t("label",{for:"company"},[I("Name"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),Ze={class:"field flex flex-column"},et=Q(()=>t("label",{for:"email"},"Description",-1)),tt={class:"field flex flex-column"},lt=Q(()=>t("label",null,[I("Line Manager"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),at={class:"field flex flex-column"},st=Q(()=>t("label",null,[I("Team Lead"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),ot={class:"field"},it=Q(()=>t("label",null,[I("Team Members"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),nt={key:0,style:{color:"red"}},rt={class:"create-btn-wrappe"},dt={__name:"EditTeam",props:{param:{type:Object,required:!0}},emits:["closeEditModal"],setup(c,{emit:j}){const F=Z(),{getTaskAssignModalData:H}=Z(),B=_e(),m=c,k=me(),L=l(m.param.id),p=l(m.param.editName),_=l(m.param.editDescription),v=l(m.param.editLineManager),x=l(m.param.editTeamLead),y=l(m.param.editMembers),T=l(F.users),$=l(!1),V=l(!0),O=j,i=l(!1),n=async()=>{var u;if(i.value=!0,p.value===""||x.value.length===0||v.value.length===0||y.value.length===0){$.value=!0,i.value=!1;return}else if($.value=!1,!$.value){const r=X("token"),{data:g,error:S,pending:D}=await be(`${B.public.apiUrl}/teams/update/${L.value}`,{method:"POST",headers:{Authorization:`Bearer ${r.value}`},body:{name:p.value,description:_.value,team_lead_id:x.value.id,line_manager_id:v.value.id,members:y.value.map(f=>f.id)}},"$L7Q6VHiEVV");if(((u=g==null?void 0:g.value)==null?void 0:u.code)===200){i.value=!1,V.value=!1,O("closeEditModal",!1),k.add({severity:"success",summary:"Success",detail:"Team Updated successfully!",group:"br",life:3500});return}else{i.value=!1,k.add({severity:"error",summary:"Error",detail:"Failed to update team!",group:"br",life:3e3});return}}};return pe(async()=>{await H(),T.value=F.users;const u=document.getElementById("editTeamName");ge(()=>{u&&u.focus()})}),(u,r)=>{const g=ce,S=xe,D=Te,f=$e,te=de;return w(),E("div",null,[t("div",We,[Xe,a(g,{id:"editTeamName",modelValue:e(p),"onUpdate:modelValue":r[0]||(r[0]=M=>h(p)?p.value=M:null),class:"w-full"},null,8,["modelValue"])]),t("div",Ze,[et,a(S,{id:"description",class:"border-gray-300",modelValue:e(_),"onUpdate:modelValue":r[1]||(r[1]=M=>h(_)?_.value=M:null),rows:"3",cols:"20",invalid:u.teamDescriptionError},null,8,["modelValue","invalid"])]),t("div",tt,[lt,a(D,{modelValue:e(v),"onUpdate:modelValue":r[2]||(r[2]=M=>h(v)?v.value=M:null),options:e(T),optionLabel:"name",placeholder:"Select Line Manager",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),t("div",at,[st,a(D,{modelValue:e(x),"onUpdate:modelValue":r[3]||(r[3]=M=>h(x)?x.value=M:null),options:e(T),optionLabel:"name",placeholder:"Select Team Lead",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),t("div",ot,[it,a(f,{display:"chip",modelValue:e(y),"onUpdate:modelValue":r[4]||(r[4]=M=>h(y)?y.value=M:null),options:e(T),filter:"",optionLabel:"name",placeholder:"Select Team Members",class:"w-full"},null,8,["modelValue","options"])]),e($)?(w(),E("p",nt,"Please fill/check up all the fields")):z("",!0),t("div",rt,[a(te,{label:"Update",icon:"pi pi-check",text:"",onClick:n,loading:e(i)},null,8,["loading"])])])}}},ct=ue(dt,[["__scopeId","data-v-e4bdffc0"]]);const ee=c=>(ve("data-v-33b7d02d"),c=c(),fe(),c),ut={key:0,class:"card"},mt={class:"d-flex mr-2"},pt=ee(()=>t("div",{class:"d-flex mr-2"},[t("h5",{class:"mb-1"},"Team List")],-1)),vt=ee(()=>t("i",{class:"pi pi-search"},null,-1)),ft=ee(()=>t("p",{class:"text-center"},"No Data found...",-1)),_t={style:{display:"flex","flex-wrap":"wrap"}},bt=ee(()=>t("p",null,"Are you sure you want to delete?",-1)),ht={__name:"index",setup(c){const j=Z(),{getTaskAssignModalData:F}=Z(),H=_e(),B=l(W("read_team")),m=l(W("create_team")),k=l(W("update_team")),L=l(W("delete_team")),p=l(),_=l(!0),v=l(!1),x=l(!1),y=me(),T=l(!1),$=l(!1),V=l([]),O=l([]),i=l(!1),n=l(""),u=l(""),r=l(""),g=l(null),S=l(null),D=l(null),f=d=>{T.value=!1,Y()},te=d=>{$.value=!1,Y()},M=async()=>{v.value=!0,await F(),V.value=j.users,T.value=!0,v.value=!1},we=d=>{console.log("editTeamdata",d),n.value=d.id,$.value=!0,u.value=d.name,r.value=d.description,g.value={id:d.children.data.id,name:d.children.data.name},console.log("editLineManager",g.value),S.value={id:d.children.children.data.id,name:d.children.children.data.name},console.log("editTeamLead",S.value),D.value=d.children.children.children.map(o=>({id:o.data.id,name:o.data.name})),console.log("editMembers",D.value)},ke=d=>{i.value=!0,n.value=d},Me=async()=>{x.value=!0;const d=X("token"),{data:o,pending:le}=await be(`${H.public.apiUrl}/teams/delete/${n.value}`,{method:"DELETE",headers:{Authorization:`Bearer ${d.value}`}},"$0jIuqBy51n");o.value.code===200?(i.value=!1,y.add({severity:"success",summary:"Success",detail:"Employee Deleted successfully!",group:"br",life:3e3}),x.value=!1,Y()):(y.add({severity:"error",summary:"Error",detail:"Employee Deleted Failed!",group:"br",life:3e3}),x.value=!1)},Y=async()=>{var G,J,P;const d=X("token"),{data:o,pending:le,error:q}=await Ie("getTeams",()=>$fetch(`${H.public.apiUrl}/teams/list`,{headers:{Authorization:`Bearer ${d.value}`}}));((J=(G=o.value)==null?void 0:G.data)==null?void 0:J.length)>0&&(O.value=(P=o.value)==null?void 0:P.data.map((ae,se)=>({...ae,index:se+1})))},Le=()=>{p.value={global:{value:null,matchMode:Ne.CONTAINS}}};return pe(()=>{Y(),_.value=!1}),Le(),(d,o)=>{const le=Ve,q=de,G=Se,J=ce,P=Ce,ae=De,se=Ee;return e(B)?(w(),E("div",ut,[t("div",mt,[a(le,{position:"bottom-right",group:"br"}),pt]),a(ae,{class:"border-0 px-0"},{start:b(()=>[e(m)?(w(),ie(q,{key:0,icon:"pi pi-plus",label:"Create",onClick:M,class:"mr-2",severity:"secondary",loading:e(v)},null,8,["loading"])):z("",!0)]),end:b(()=>[a(P,{iconPosition:"right",raised:""},{default:b(()=>[a(G,null,{default:b(()=>[vt]),_:1}),a(J,{modelValue:e(p).global.value,"onUpdate:modelValue":o[0]||(o[0]=s=>e(p).global.value=s),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),_:1}),a(e(Be),{filters:e(p),"onUpdate:filters":o[1]||(o[1]=s=>h(p)?p.value=s:null),class:"table-st",value:e(O),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:10,rowsPerPageOptions:[5,10,20,50],dataKey:"id",filterDisplay:"menu",loading:e(_)},{empty:b(()=>[ft]),loading:b(()=>[a(se,{style:{width:"50px",height:"50px"}})]),default:b(()=>[a(e(A),{field:"index",header:"Serial",sortable:"",style:{width:"5%"}}),a(e(A),{field:"name",header:"Team Name",style:{width:"15%"}}),a(e(A),{field:"description",header:"Description",style:{width:"20%"}}),a(e(A),{field:"Line Manager",header:"Line Manager",style:{width:"10%"}},{body:b(s=>{var C,N,U;return[t("div",null,ne((U=(N=(C=s==null?void 0:s.data)==null?void 0:C.children)==null?void 0:N.data)==null?void 0:U.name),1)]}),_:1}),a(e(A),{field:"Line Manager",header:"Team Lead",style:{width:"10%"}},{body:b(s=>{var C,N,U,K;return[t("div",null,ne((K=(U=(N=(C=s==null?void 0:s.data)==null?void 0:C.children)==null?void 0:N.children)==null?void 0:U.data)==null?void 0:K.name),1)]}),_:1}),a(e(A),{field:"Members",header:"Members",style:{width:"30%"}},{body:b(s=>{var C,N,U;return[t("div",_t,[(w(!0),E(he,null,ye((U=(N=(C=s==null?void 0:s.data)==null?void 0:C.children)==null?void 0:N.children)==null?void 0:U.children,K=>(w(),E("div",{key:K,style:{display:"flex","flex-wrap":"wrap",gap:"5px"}},[(w(!0),E(he,null,ye(K,oe=>(w(),E("div",{key:oe},[t("div",{class:"mb-1",style:Ue(oe.name?"border: 1px solid rgba(167, 167, 167, 0.486); border-radius: 5px; padding: 2px 5px":" ")},ne(oe.name),5)]))),128))]))),128))])]}),_:1}),a(e(A),{field:"action",header:"Action",style:{width:"10%"}},{body:b(s=>[e(k)?(w(),ie(q,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:C=>we(s.data)},null,8,["onClick"])):z("",!0),e(L)?(w(),ie(q,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:C=>ke(s.data.id)},null,8,["onClick"])):z("",!0)]),_:1})]),_:1},8,["filters","value","loading"]),a(e(re),{visible:e(T),"onUpdate:visible":o[3]||(o[3]=s=>h(T)?T.value=s:null),modal:"",header:"Create Team",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[a(Pe,{param:{usersLists:e(V)},onCloseCreateModal:o[2]||(o[2]=s=>f(s))},null,8,["param"])]),_:1},8,["visible"]),a(e(re),{visible:e($),"onUpdate:visible":o[5]||(o[5]=s=>h($)?$.value=s:null),modal:"",header:"Edit Team",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[a(ct,{param:{id:e(n),editName:e(u),editDescription:e(r),editLineManager:e(g),editTeamLead:e(S),editMembers:e(D)},onCloseEditModal:o[4]||(o[4]=s=>te(s))},null,8,["param"])]),_:1},8,["visible"]),a(e(re),{visible:e(i),"onUpdate:visible":o[7]||(o[7]=s=>h(i)?i.value=s:null),header:" ",dismissableMask:"true",style:{width:"25rem"}},{default:b(()=>[bt,a(q,{label:"No",icon:"pi pi-times",text:"",onClick:o[6]||(o[6]=s=>i.value=!1)}),a(q,{label:"Yes",icon:"pi pi-check",text:"",onClick:Me,loading:e(x)},null,8,["loading"])]),_:1},8,["visible"])])):z("",!0)}}},dl=ue(ht,[["__scopeId","data-v-33b7d02d"]]);export{dl as default};
