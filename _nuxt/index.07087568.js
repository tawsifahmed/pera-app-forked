import{_ as Ce}from"./nuxt-link.4dabd470.js";import je from"./dropdown.esm.fdfe63be.js";import Te from"./calendar.esm.2394d0c5.js";import Se from"./button.esm.3ec7eae1.js";import De from"./chart.esm.35f62366.js";import{_ as $e}from"./CreateCompany.19c3f5df.js";import{a2 as Le,a3 as U,$ as l,a5 as Ve,ar as K,b as d,i as e,l as _,w as f,c as h,u,e as F,F as Ie,f as Me,a as Pe,o as i,t as g,s as Fe,k as Ne,K as Re,a8 as Ae,a9 as Ee,ca as Ue,an as Be}from"./entry.7ff8a81f.js";import{u as ze,a as Oe}from"./cookie.ccd6a0a0.js";import{u as He}from"./layout.03f9b79a.js";import{a as j}from"./usePermission.e23a010a.js";import{u as X}from"./auth.e846b966.js";import{u as Q}from"./company.ef9fccf0.js";import{u as W}from"./workCompany.d7a85777.js";import"./baseicon.esm.c1e52884.js";import"./basecomponent.esm.df6a4ea8.js";import"./index.esm.f6e93f94.js";import"./index.esm.02beb680.js";import"./index.esm.7de35ad8.js";import"./index.esm.5c2797ea.js";import"./index.esm.72da38a6.js";import"./overlayeventbus.esm.01179281.js";import"./portal.esm.2d1e99a5.js";import"./virtualscroller.esm.ae2f48ff.js";import"./index.esm.6a5c3d13.js";import"./index.esm.93780cfa.js";import"./index.esm.7860e4b1.js";import"./badge.esm.a113bbb4.js";import"./inputtext.esm.a45bd446.js";import"./dialog.esm.57fbd934.js";const a=T=>(Ae("data-v-5930d34e"),T=T(),Ee(),T),Ye={class:"grid"},qe={class:"col-12 lg:col-6 xl:col-3"},Ge={class:"card mb-0"},Je=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Company",-1)),Ke={class:"text-900 font-medium text-xl"},Xe=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-microsoft text-blue-500 text-xl"})],-1)),Qe={class:"col-12 lg:col-6 xl:col-3"},We={class:"card mb-0"},Ze=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Employees",-1)),et={class:"text-900 font-medium text-xl",style:{visibility:"visible"}},tt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-purple-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user text-purple-500 text-xl"})],-1)),st=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Employees"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),lt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-purple-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user text-purple-500 text-xl"})],-1)),ot={class:"col-12 lg:col-6 xl:col-3"},at={class:"card mb-0"},nt=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Roles",-1)),it={class:"text-900 font-medium text-xl"},ct=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-red-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user-edit text-red-500 text-xl"})],-1)),rt=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Roles"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),dt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-red-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user-edit text-red-500 text-xl"})],-1)),ut={class:"col-12 lg:col-6 xl:col-3"},mt={class:"card mb-0"},pt=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Tags",-1)),vt={class:"text-900 font-medium text-xl"},_t=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-green-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-tags text-green-500 text-xl"})],-1)),ft=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Tags"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),ht=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-green-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-tags text-green-500 text-xl"})],-1)),gt={key:0,class:"col-12 xl:col-6"},xt={class:"card h-full"},yt={class:"flex gap-2 align-items-center flex-wrap",style:{padding:"10px"}},bt=a(()=>e("h5",{class:"mb-2"},"Tasks",-1)),wt={class:"flex gap-2 flex-wrap justify-content-end filter-container"},kt={class:"mb-2 relative w-full md:w-12rem"},Ct={class:"task-container"},jt={key:0,class:"flex justify-content-center align-items-center",style:{height:"22rem"}},Tt=a(()=>e("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2.25rem"}},null,-1)),St=[Tt],Dt={key:1},$t=["onClick"],Lt={class:"title-group"},Vt={class:"title line-clamp-1",style:{"font-weight":"600"}},It=a(()=>e("div",{style:{"background-color":"#00000040",height:"5px",width:"5px","border-radius":"15px"}},null,-1)),Mt={style:{"font-size":"12px"}},Pt={key:2},Ft=a(()=>e("p",{class:"text-black text-lg text-center"},"No Tasks found!",-1)),Nt=[Ft],Rt={class:"w-full flex justify-content-center"},At={class:"col-12 xl:col-6"},Et={class:"card"},Ut=a(()=>e("h5",null,"Overview",-1)),Bt={key:1},zt={__name:"index",setup(T){W();const{totalCompanies:B,totalProjects:Z}=U(W()),ee=Ue(),{getChartData:te,getTaskAssignModalData:se,getRoles:le,getTagsAssignModalData:oe}=Q(),{chartProjectInfo:ae,chartTaskInfo:ne,chartClosedTaskInfo:ie,users:ce,rolesLists:z,tags:O}=U(Q());X(),U(X());const re=l(j("read_user")),de=l(j("read_role")),ue=l(j("read_tags")),me=l(j("read_task"));l(j("create_company"));const{isDarkTheme:pe}=He();l(null);const ve=l({labels:ae,datasets:[{label:"Total Tasks",data:ne,fill:!1,backgroundColor:"#6366f1",borderColor:"#6366f1",tension:.4},{label:"Closed Tasks",data:ie,fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4}]}),x=l([]);l([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const N=l(null),S=l(!1),D=l(null),_e=()=>{var o;D.value=JSON.parse(localStorage.getItem("userCompany")),console.log("hasUserCompany =>",D.value),D.value===null||((o=D.value)==null?void 0:o.length)==0?S.value=!0:S.value=!1,console.log("visibleCreateCompany =>",S.value)};Ve(()=>{le(),se(),oe(),te(),_e()});const fe=()=>{N.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"},title:{display:!0,text:"Projects"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"},title:{display:!0,text:"Numbers  of  Tasks"}}}}},he=()=>{N.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}},r=l(),H=l(),Y=l(),v=l(),$=l(!1),R=l(!1);K(r,o=>{var t,n;H.value=[{name:"All",id:""},...((n=(t=r.value)==null?void 0:t.statuses)==null?void 0:n.map(c=>({name:c.name,id:c.id})))||[]]});const w=l(),L=l(),V=l(),I=l(),q=l(1);let m=l(1);const y=async()=>{L.value=r.value?r.value.id:"",V.value=w.value?w.value.id:"",I.value=v.value,E?m.value++:m.value=1,q.value=m.value,M.value=0,A(L.value,V.value,I.value,q.value),E=!1},ge=o=>{$.value=!0;const t=new Date(o);v.value=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),y()},xe=()=>{$.value=!1,v.value="",I.value="",y()},ye=()=>{if(r.value||Y.value||v.value||m.value>1)r.value="",Y.value="",v.value="",L.value="",V.value="",w.value="",$.value=!1,y();else return},be=async o=>{const t=localStorage.getItem("userCompany");console.log("Task click: ",o),await Be({path:`/companies/${t}/spaces/${o==null?void 0:o.space_id}/projects/${o==null?void 0:o.project_id}`,query:{task_key:o.id}})},we=o=>{const t=o,n=new Date(t),c=n.getFullYear(),P=String(n.getMonth()+1).padStart(2,"0");return`${String(n.getDate()).padStart(2,"0")}-${P}-${c}`},M=l(0),G=l(!1),k=l(!1),ke=async o=>{o==="hide-loader"&&(G.value=!0),k.value=!0,m.value++,await A(L.value,V.value,I.value,m.value)},A=async(o="",t="",n="",c=1)=>{var b;G.value||(R.value=!0),console.log("status",t);try{const C=ze("token"),{data:p,pending:J,error:s}=await Oe(`${ee.public.apiUrl}/tasks/list?due_date=${n}&status=${t}&project_id=${o}&limit=15&page=${c}`,{method:"GET",headers:{Authorization:`Bearer ${C.value}`}},"$PslAyef5YX");p.value&&p.value.data&&((b=p.value.counts)!=null&&b.total_tasks)?(M.value=Math.ceil(p.value.counts.total_tasks/15),x.value=c===1?p.value.data:[...x.value,...p.value.data],k.value=!1):(x.value=[],k.value=!1),console.log("Task list: ",x.value)}catch(C){console.log(C),k.value=!1}finally{R.value=!1}};let E=!1;return window.addEventListener("scroll",()=>{const{scrollTop:o,scrollHeight:t,clientHeight:n}=document.documentElement;o+n>=t-50&&m.value<M&&(E=!0,y())}),A(),K(pe,o=>{o?he():fe()},{immediate:!0}),(o,t)=>{const n=Ce,c=je,P=Te,b=Se,C=De,p=$e,J=Pe("tooltip");return i(),d("div",Ye,[e("div",qe,[e("div",Ge,[_(n,{to:"/companies",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[Je,e("div",Ke,g(u(B)?u(B):"0"),1)]),Xe]),_:1})])]),e("div",Qe,[e("div",We,[re.value?(i(),h(n,{key:0,to:"/employees",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[Ze,e("div",et,g(u(ce).length),1)]),tt]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:f(()=>[st,lt]),_:1}))])]),e("div",ot,[e("div",at,[de.value?(i(),h(n,{key:0,to:"/roles",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[nt,e("div",it,g(u(z)?u(z).length:"0"),1)]),ct]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:f(()=>[rt,dt]),_:1}))])]),e("div",ut,[e("div",mt,[ue.value?(i(),h(n,{key:0,to:"/tags",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[pt,e("div",vt,g(u(O)?u(O).length:"0"),1)]),_t]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:f(()=>[ft,ht]),_:1}))])]),me.value?(i(),d("div",gt,[e("div",xt,[e("div",yt,[bt,e("div",wt,[_(c,{onChange:t[0]||(t[0]=s=>y()),modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),options:u(Z),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options"]),_(c,{onChange:t[2]||(t[2]=s=>y()),modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=s=>w.value=s),options:H.value,disabled:!r.value,optionLabel:"name",placeholder:"Select Status",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options","disabled"]),e("div",kt,[_(P,{onDateSelect:t[4]||(t[4]=s=>ge(s)),modelValue:v.value,"onUpdate:modelValue":t[5]||(t[5]=s=>v.value=s),placeholder:"Select Date",class:"w-full md:w-12rem"},null,8,["modelValue"]),$.value?(i(),d("p",{key:0,onClick:xe,class:"pi pi-times end-cross absolute cursor-pointer"})):F("",!0)]),_(b,{onClick:ye,label:"Reset",class:"mb-2",severity:"secondary"})])]),e("div",Ct,[R.value?(i(),d("div",jt,St)):x.value.length>0?(i(),d("div",Dt,[(i(!0),d(Ie,null,Me(x.value,s=>(i(),d("div",{key:s.id,onClick:()=>be(s),class:"task-card"},[e("div",Lt,[Fe(e("div",{class:Ne("status"),style:Re(`background-color: ${s==null?void 0:s.status_color};`)},null,4),[[J,{value:`Status: ${s.status_name}`},void 0,{left:!0}]]),e("p",Vt,g(s==null?void 0:s.name),1),It,e("p",null,g(s==null?void 0:s.project_name),1)]),e("div",null,[e("p",Mt,"Due: "+g(s.due_date?we(s==null?void 0:s.due_date):"Not Set"),1)])],8,$t))),128))])):(i(),d("div",Pt,Nt)),e("div",Rt,[u(m)<M.value?(i(),h(b,{key:0,onClick:t[6]||(t[6]=s=>ke("hide-loader")),loading:k.value,label:"Load More",severity:"secondary"},null,8,["loading"])):F("",!0)])])])])):F("",!0),e("div",At,[e("div",Et,[Ut,_(C,{type:"line",data:ve.value,options:N.value},null,8,["data","options"])])]),S.value?(i(),d("div",Bt,[_(p)])):F("",!0)])}}},gs=Le(zt,[["__scopeId","data-v-5930d34e"]]);export{gs as default};
