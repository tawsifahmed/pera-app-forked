import Ie from"./toast.esm.562faa90.js";import Se from"./dropdown.esm.9f57cc62.js";import qe from"./calendar.esm.c15c8990.js";import be from"./button.esm.bd660786.js";import Ve from"./inputtext.esm.3ef12f0a.js";import Ae from"./tabpanel.esm.3a2f4559.js";import Le from"./textarea.esm.bf1ac283.js";import{a2 as De,a3 as Oe,a4 as he,$ as n,aq as Be,a as Ne,o as $,b as R,i as e,t as H,u as l,l as t,a6 as J,q as pe,e as K,I as me,F as _e,f as $e,s as we,a7 as Ce,a8 as Fe,ca as ge,w as h,c as Z,a5 as Qe}from"./entry.cb39d925.js";import{u as P,a as O,b as Ke}from"./cookie.ad8015f5.js";import{u as Ee}from"./user.dfd281e7.js";import Re from"./toolbar.esm.21d42e31.js";import Te from"./column.esm.df8e08a6.js";import We from"./row.esm.0b17738e.js";import je from"./columngroup.esm.b8b2c59a.js";import Me from"./datatable.esm.25a34de3.js";import xe from"./dialog.esm.69acf5a0.js";import Pe from"./tabview.esm.634acc72.js";import ze from"./progressspinner.esm.8a4ffc00.js";import Ge from"./inputnumber.esm.62351b49.js";import{a as oe}from"./usePermission.76537ee7.js";import"./portal.esm.fdb67d0f.js";import"./basecomponent.esm.71a8ad56.js";import"./index.esm.d0e8b78a.js";import"./baseicon.esm.557ce846.js";import"./index.esm.ee0e358d.js";import"./index.esm.cf28461e.js";import"./index.esm.fd50d91f.js";import"./index.esm.b6eff026.js";import"./index.esm.2bbfca06.js";import"./index.esm.eb1b9bce.js";import"./overlayeventbus.esm.e90b9f2e.js";import"./virtualscroller.esm.145e540e.js";import"./index.esm.84b27f14.js";import"./index.esm.a641fea0.js";import"./index.esm.f83b2254.js";import"./badge.esm.137acad8.js";import"./paginator.esm.fcc2ca33.js";import"./index.esm.a68fe42d.js";import"./index.esm.63b25712.js";import"./index.esm.432109f7.js";import"./index.esm.a32c5a5c.js";import"./index.esm.52a89895.js";import"./checkbox.esm.31bb57e0.js";import"./radiobutton.esm.de573b1c.js";import"./index.esm.bc2c1fc6.js";import"./index.esm.3e3ccd10.js";const ce=Y=>(Ce("data-v-b97fd3db"),Y=Y(),Fe(),Y),Ye={class:"mx-auto",style:{"max-width":"55rem"}},Ze={action:"",class:"grid",style:{gap:"10px"}},He={class:"w-full col-12"},Je={class:"w-full col-12 grid"},Xe={class:"col-12 md:col-5"},el=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Team Member",-1)),ll={class:"user-name"},tl={class:"col-12 md:col-5"},al=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),ol={class:"col-12 md:col-2 flex align-items-end"},sl={key:0,class:"deadline-info mb-0 flex w-full justify-content-end"},nl=ce(()=>e("span",{class:"font-bold mr-2"},"Deadline: ",-1)),il={class:"w-full col-12 grid"},dl={class:"col-12 md:col-6"},rl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section",-1)),cl={class:"user-name"},ul={class:"col-12 md:col-6"},ml=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section",-1)),pl={class:"user-name"},_l={class:"col-12 md:col-6"},fl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),vl={class:"col-12 md:col-6"},bl={for:"icondisplay",class:"font-bold block mb-2"},hl={class:"col-12"},gl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Comment",-1)),yl={class:"col-12"},kl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"File",-1)),wl={class:"flex gap-2 align-items-center upload-wrapper w-full"},$l={key:0,class:"w-full"},Sl=ce(()=>e("span",{class:"pi pi-file-import mr-2"},null,-1)),Vl=["onClick"],xl=ce(()=>e("i",{class:"pi pi-times"},null,-1)),Ul=[xl],Dl=["id","onChange"],Cl={class:"col-12 my-3"},Fl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Employee Self Remarks",-1)),Tl={class:"gap-2 flex justify-content-center w-full"},Ml={__name:"Submission",props:["quater"],setup(Y){const{getUserData:ee}=Ee(),{userProfile:te}=Oe(Ee()),ae=he(),de=ge(),W=n(!1),A=n(!1),F=n(null),L=n(!1);console.log("Employee Value",L.value);const S=n(""),c=n([]),D=n([]),U=n([]),C=n([]),T=n([]),_=n([]),g=n(""),p=n([]);Be(S,f=>{f&&(L.value=!1,c.value=[],D.value=[],U.value=[],C.value=[],T.value=[],_.value=[],p.value=[],F.value=null)});const i=(f,s,V)=>{const M=Array.from(V.target.files);T.value[s]||(T.value[s]=[]),T.value[s].push(...M),_.value.includes(f.subsection_id)||_.value.push(f.subsection_id)},r=f=>{const s=document.getElementById(`submittedFiles${f}`);s&&s.click()},u=(f,s,V)=>{T.value[s]&&(T.value[s].splice(V,1),_.value=_.value.filter(M=>M!==f.subsection_id))},q=async()=>{var M,X,j,N,ne,re,v;if((D.value.length>0||U.value.length>0||C.value.length>0||T.value.length>0||c.value)&&(D.value=[],U.value=[],C.value=[],T.value=[],c.value=[]),W.value=!0,S.value==="")return W.value=!1,ae.add({severity:"warn",summary:"Failed",detail:"Please select quarter",group:"br",life:3e3});const f=P("token"),{data:s,error:V}=await O(`${de.public.apiUrl}/kpi/show/${(X=(M=te==null?void 0:te.value)==null?void 0:M.data)==null?void 0:X.id}?quater_id=${S.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${f.value}`}},"$GEOxJeF5tI");if(console.log("Data Value",s.value),console.log("error Value",V.value),s.value)if(((N=(j=s.value)==null?void 0:j.data)==null?void 0:N.length)!==0)W.value=!1,L.value=!0,F.value=s.value,g.value=(re=(ne=s.value)==null?void 0:ne.line_maneger)==null?void 0:re.self_remarks,console.log("selfRemarks",g.value),(v=s.value)==null||v.data.forEach(d=>{console.log("data gotcha"),console.log("Item Value",d),d.sub_section_data.forEach(I=>{c.value.push({section_name:d.section.name,section_id:d.section.id,subSection_name:I.sub_section.title,subsection_id:I.id,target_mark:I.target_mark,mark_type:I.mark_type,quater_id:I.quater_id,achive_mark:I.achive_mark,comment:I.comment}),D.value.push(I.id),U.value.push(I.achive_mark),C.value.push(I.comment),T.value.push(null)}),console.log("Submitted Ids",D.value),console.log("Submitted submittedMarks",U.value),console.log("Submitted submittedComments",C.value),console.log("Submitted submittedFiles",T.value)}),console.log("Submission Value",s==null?void 0:s.value);else return W.value=!1,L.value=!1,ae.add({severity:"error",summary:"Failed",detail:"No data found",group:"br",life:3e3});else return console.log("erorr gotcha"),L.value=!1,W.value=!1,ae.add({severity:"error",summary:"Internal Server Error",detail:"Failed to show report",group:"br",life:3e3})},B=f=>{if(!f)return"Not Set";const s=new Date(f);if(isNaN(s))return"Invalid Date";const V={day:"2-digit",month:"short",year:"numeric"};return new Intl.DateTimeFormat("en-GB",V).format(s)},le=async()=>{var X;A.value=!0;const f=P("token"),s=new FormData;c.value.forEach((j,N)=>{console.log("SubIDSValue",D.value[N]),s.append("id[]",D.value[N]),s.append("achive_mark[]",U.value[N]),s.append("comment[]",C.value[N]),T.value[N]&&T.value[N].forEach(ne=>{console.log("File Value",ne),p.value.push(ne)})}),p.value.forEach(j=>{console.log("File Value",j),s.append("files[]",j)}),_.value.forEach(j=>{s.append("files_id[]",j)}),s.append("self_remarks",g.value);const{data:V,error:M}=await O(`${de.public.apiUrl}/kpi/update`,{method:"POST",headers:{Authorization:`Bearer ${f.value}`},body:s},"$3n6oGZyvcV");if(((X=V.value)==null?void 0:X.code)===200){A.value=!1,L.value=!1,S.value="",D.value=[],U.value=[],C.value=[],T.value=[],_.value=[],g.value="",p.value=[],F.value=null,c.value=[],ae.add({severity:"success",summary:"Success",detail:"Submission successful!",group:"br",life:3e3});return}else return A.value=!1,ae.add({severity:"error",summary:"Failed",detail:"Failed to submit",group:"br",life:3e3})};return ee(),(f,s)=>{var ne,re,v,d,I,E;const V=Se,M=be,X=Ve,j=Le,N=Ne("tooltip");return $(),R("div",Ye,[e("div",Ze,[e("div",He,[e("div",Je,[e("div",Xe,[el,e("p",ll,H((re=(ne=l(te))==null?void 0:ne.data)==null?void 0:re.name),1)]),e("div",tl,[al,t(V,{class:"w-full",modelValue:l(S),"onUpdate:modelValue":s[0]||(s[0]=w=>J(S)?S.value=w:null),options:Y.quater,optionLabel:"name",placeholder:"Select Quarter"},null,8,["modelValue","options"])]),e("div",ol,[t(M,{class:"col-12 md:col-2 w-full",type:"submit",label:"Load",onClick:q,style:{height:"max-content",display:"flex","align-self":"end"},loading:l(W)},null,8,["loading"])])])]),l(F)?($(),R("p",sl,[nl,pe(H(B((I=(d=(v=l(F))==null?void 0:v.data[0])==null?void 0:d.sub_section_data[0])==null?void 0:I.deadline)),1)])):K("",!0),l(L)?($(),R("form",{key:1,class:"card relative",onSubmit:me(le,["prevent"])},[($(!0),R(_e,null,$e(l(c),(w,b)=>($(),R("div",{key:b},[e("div",il,[e("div",dl,[rl,we(($(),R("p",cl,[pe(H(w.section_name),1)])),[[N,{value:w.section_name},void 0,{top:!0}]])]),e("div",ul,[ml,we(($(),R("p",pl,[pe(H(w.subSection_name),1)])),[[N,{value:w.subSection_name},void 0,{top:!0}]])]),e("div",_l,[fl,t(V,{modelValue:l(S),"onUpdate:modelValue":s[1]||(s[1]=o=>J(S)?S.value=o:null),disabled:"",options:Y.quater,optionLabel:"name",placeholder:"Select Quarter",class:"w-full"},null,8,["modelValue","options"])]),e("div",vl,[e("label",bl," Achieved Mark (Target: "+H((w==null?void 0:w.target_mark)||0)+H((w==null?void 0:w.mark_type)==1?"%":0)+") ",1),t(X,{modelValue:l(U)[b],"onUpdate:modelValue":o=>l(U)[b]=o,placeholder:"Input Mark",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",hl,[gl,we(t(j,{modelValue:l(C)[b],"onUpdate:modelValue":o=>l(C)[b]=o,id:"description",rows:"3",cols:"20",placeholder:"Write comment",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),[[N,{value:w.comment},void 0,{top:!0}]])]),e("div",yl,[kl,e("div",wl,[l(T)[b]&&l(T)[b].length?($(),R("div",$l,[($(!0),R(_e,null,$e(l(T)[b],(o,a)=>($(),R("div",{key:a,class:"text-sm file-name font-semibold tracking-wide leading-3 bg-gray-300 px-3 py-2 flex align-items-center rounded relative"},[e("div",null,[Sl,pe(),e("span",null,H(o.name),1)]),e("div",{onClick:y=>u(w,b,a),class:"close-comment"},Ul,8,Vl)]))),128))])):K("",!0),e("div",null,[e("input",{type:"file",class:"hidden",id:`submittedFiles${b}`,onChange:o=>i(w,b,o)},null,40,Dl),t(M,{icon:"pi pi-cloud-upload",disabled:l(T)[b]&&l(T)[b].length>0,label:"Upload",onClick:o=>r(b),"aria-label":"Filter"},null,8,["disabled","onClick"])])])])])]))),128)),e("div",Cl,[Fl,we(t(j,{modelValue:l(g),"onUpdate:modelValue":s[2]||(s[2]=w=>J(g)?g.value=w:null),id:"description",rows:"5",cols:"20",placeholder:"Write your self remarks",class:"w-full"},null,8,["modelValue"]),[[N,{value:l(g)},void 0,{top:!0}]])]),e("div",Tl,[t(M,{disabled:(E=l(F))==null?void 0:E.isDeadlineMiss,label:"Submit",class:"bg-green-500 border-none",type:"submit",loading:l(A)},null,8,["disabled","loading"])])],32)):K("",!0)])])}}},El=De(Ml,[["__scopeId","data-v-b97fd3db"]]),Il={class:"card"},ql={class:"flex gap-2 flex-wrap"},Al={class:"user-selection w-full md:w-14rem w-full"},Ll=e("label",{class:"font-bold block mb-2"},"Team Member:",-1),Bl={class:"flex justify-content-center"},Ql={class:"user-selection w-full md:w-14rem w-full"},Kl=e("label",{class:"font-bold block mb-2"},"Quarter:",-1),Pl={class:"flex justify-content-center"},Ol={key:0,class:"card"},Nl={class:"flex flex-wrap align-items-top justify-content-between gap-2 mb-5"},Rl={class:""},Wl={class:"font-bold"},jl=e("td",null,"Name",-1),zl={class:"pl-2"},Gl={class:"font-bold"},Yl=e("td",null,"Designation",-1),Zl={class:"pl-2"},Hl={class:"font-bold"},Jl=e("td",null,"Line Manager",-1),Xl={class:"pl-2"},et={class:"font-bold"},lt=e("td",null,"Achievement",-1),tt={class:"pl-2"},at={class:"font-bold"},ot=e("td",null,"Weightage Score",-1),st={class:"pl-2"},nt={class:""},it=e("p",{class:"text-center"},"No Data found...",-1),dt={class:"flex flex-wrap align-items-center justify-content-between gap-2 py-2"},rt={class:"text-xl text-900 font-bold"},ct=["href"],ut={class:"my-5 flex gap-2 text-lg"},mt=e("p",{class:"font-bold"},"Self Remark:",-1),pt={class:""},_t={class:"col-12"},ft=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Line Manager Feedback:",-1),vt={class:"col-12"},bt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Training Needs Assessment:",-1),ht={class:"w-full flex justify-center"},gt={__name:"Report",props:["quater"],setup(Y){const ee=ge(),te=he(),ae=n(!1),de=n(!1),W=n(!1),A=n(""),F=n(""),L=n(!1),S=n([]),c=n(""),D=n(""),U=n(null),C=()=>{console.log("Modal"),L.value=!0};(async()=>{var B,le,f;const i=P("token"),{data:r,pending:u,error:q}=await Ke("getMembers",()=>$fetch(`${ee.public.apiUrl}/teams/members?report=1`,{headers:{Authorization:`Bearer ${i.value}`}}));console.log("memmbess",(B=r.value)==null?void 0:B.team_members),(le=r.value)!=null&&le.team_members&&(S.value=(f=r.value)==null?void 0:f.team_members.map(s=>({id:s.id,name:s.name})),console.log("employee",A.value))})();const _=async()=>{if(A.value==""||F.value=="")return te.add({severity:"warn",summary:"Warning",detail:"Please Select Employee and Quarter",group:"br",life:3e3});const i=P("token"),{data:r,error:u}=await O(`${ee.public.apiUrl}/kpi/show/${A.value.id}?quater_id=${F.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${i.value}`}},"$PG910Me6qO");return r.value.code==200?(U.value=r.value,console.log("Report Value",r.value),ae.value=!1):(ae.value=!1,te.add({severity:"error",summary:"Failed",detail:"Failed to show report",group:"br",life:3e3}))},g=async()=>{const i=P("token");de.value=!0;const{data:r,error:u}=await O(`${ee.public.apiUrl}/kpi/report-download/${A.value.id}?quater_id=${F.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${i.value}`}},"$8KxzC2nWbm");if(r.value.code==200){const q=document.createElement("a");q.href=r.value.download_path,q.target="_blank",q.click(),de.value=!1;return}else return de.value=!1,te.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},p=async()=>{W.value=!0;const i=P("token"),r=new FormData;r.append("user_id",A.value.id),r.append("quater_id",F.value.id),r.append("line_manager_feedback",c.value),r.append("line_manager_assesment",D.value);const{data:u,error:q}=await O(`${ee.public.apiUrl}/kpi/line-manager-feedback`,{method:"POST",headers:{Authorization:`Bearer ${i.value}`},body:r},"$CYBu34Xv3m");return u.value?(W.value=!1,L.value=!1,_(),D.value="",c.value="",te.add({severity:"success",summary:"Success",detail:"Feedback submitted successfully",group:"br",life:3e3})):(W.value=!1,te.add({severity:"error",summary:"Failed",detail:"Failed to submit feedback",group:"br",life:3e3}))};return(i,r)=>{var j,N,ne,re,v,d,I,E,w,b;const u=Ie,q=Se,B=be,le=Re,f=Te,s=We,V=je,M=Me,X=Le;return $(),R(_e,null,[e("div",Il,[t(u,{position:"bottom-right",group:"br"}),t(le,{class:"border-0 px-0"},{start:h(()=>[e("div",ql,[e("div",Al,[Ll,e("div",Bl,[t(q,{modelValue:l(A),"onUpdate:modelValue":r[0]||(r[0]=o=>J(A)?A.value=o:null),options:l(S),optionLabel:"name",placeholder:"Select Employee",class:"w-full md:w-14rem"},null,8,["modelValue","options"])])]),e("div",Ql,[Kl,e("div",Pl,[t(q,{modelValue:l(F),"onUpdate:modelValue":r[1]||(r[1]=o=>J(F)?F.value=o:null),options:Y.quater,optionLabel:"name",placeholder:"Select Quarter",class:"w-full md:w-14rem"},null,8,["modelValue","options"])])])])]),end:h(()=>[t(B,{onClick:_,class:"w-full",label:"Generate",loading:l(ae)},null,8,["loading"])]),_:1})]),l(U)?($(),R("div",Ol,[e("div",null,[e("div",Nl,[e("div",Rl,[e("table",null,[e("tr",Wl,[jl,e("td",zl,": "+H((j=l(U))==null?void 0:j.user_name),1)]),e("tr",Gl,[Yl,e("td",Zl,": "+H((N=l(U))==null?void 0:N.designation),1)]),e("tr",Hl,[Jl,e("td",Xl,": "+H((ne=l(U))==null?void 0:ne.line_maneger_name),1)]),e("tr",et,[lt,e("td",tt,": "+H((re=l(U))==null?void 0:re.overAllKpi),1)]),e("tr",at,[ot,e("td",st,": "+H((v=l(U))==null?void 0:v.overAllKpi.slice(0,-1)),1)])])]),e("div",nt,[(d=l(U))!=null&&d.can_set_feedback?($(),Z(B,{key:0,class:"w-fit h-fit mx-1 bg-green-500",style:{border:"1px solid #22c55e"},label:"Feedback",onClick:C})):K("",!0),t(B,{onClick:g,class:"w-fit h-fit mx-1",label:"Download",loading:l(de)},null,8,["loading"])])]),($(!0),R(_e,null,$e((I=l(U))==null?void 0:I.data,(o,a)=>($(),Z(M,{value:o.sub_section_data,key:a,showGridlines:"",tableStyle:"min-width: 50rem",class:"my-4"},{empty:h(()=>[it]),header:h(()=>[e("div",dt,[e("span",rt,H(o.section.name),1)])]),default:h(()=>[t(f,{field:"",header:"Sub Section",style:{width:"30%"}},{body:h(y=>{var Q,k;return[e("div",null,H((k=(Q=y==null?void 0:y.data)==null?void 0:Q.sub_section)==null?void 0:k.title),1)]}),_:1}),t(f,{field:"target_mark",header:"Key result Target",style:{width:"8%"}}),t(f,{field:"achive_mark",header:"Key result Achivement",style:{width:"8%"}}),t(f,{field:"achive_mark_parcentage",header:"Achievement Percentage",style:{width:"8%"}}),t(f,{field:"weightage",header:"Weightage",style:{width:"8%"}}),t(f,{field:"weightage_score",header:"Weightage Score",style:{width:"8%"}}),t(f,{field:"comment",header:"Comment"}),t(f,{field:"",header:"File",style:{width:"8%"}},{body:h(y=>{var Q,k;return[((Q=y==null?void 0:y.data)==null?void 0:Q.file_link)!==""?($(),R("a",{key:0,href:(k=y==null?void 0:y.data)==null?void 0:k.file_link,target:"_blank",class:"text-blue-500"}," Attachment ",8,ct)):K("",!0)]}),_:1}),t(V,{type:"footer"},{default:h(()=>[t(s,null,{default:h(()=>{var y,Q,k;return[t(f,{footer:"Summary:",colspan:3,footerStyle:"text-align:left"}),t(f,{footer:(y=o==null?void 0:o.section_summary)==null?void 0:y.achivementpercentage_sum},null,8,["footer"]),t(f,{footer:(Q=o==null?void 0:o.section_summary)==null?void 0:Q.section_weightage},null,8,["footer"]),t(f,{footer:(k=o==null?void 0:o.section_summary)==null?void 0:k.weighted_score_sum},null,8,["footer"]),t(f,{footer:""}),t(f,{footer:""})]}),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128)),t(M,{value:[(E=l(U))==null?void 0:E.line_maneger],showGridlines:""},{default:h(()=>[t(f,{field:"line_manager_feedback",header:"Line Manager Feedback on Improvement Areas"}),t(f,{field:"line_manager_assesment",header:"Training Needs Assessment"})]),_:1},8,["value"]),e("div",ut,[mt,e("p",pt,H((b=(w=l(U))==null?void 0:w.line_maneger)==null?void 0:b.self_remarks),1)])]),t(l(xe),{visible:l(L),"onUpdate:visible":r[4]||(r[4]=o=>J(L)?L.value=o:null),modal:"",header:"Feedback",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:h(()=>[e("form",{onSubmit:me(p,["prevent"])},[e("div",_t,[ft,t(X,{modelValue:l(c),"onUpdate:modelValue":r[2]||(r[2]=o=>J(c)?c.value=o:null),rows:"3",cols:"20",placeholder:"Write comment",class:"w-full",required:""},null,8,["modelValue"])]),e("div",vt,[bt,t(X,{modelValue:l(D),"onUpdate:modelValue":r[3]||(r[3]=o=>J(D)?D.value=o:null),rows:"3",cols:"20",placeholder:"Write comment",class:"w-full",required:""},null,8,["modelValue"])]),e("div",ht,[t(B,{class:"w-fit h-fit mx-auto",type:"submit",label:"Submit",loading:l(W)},null,8,["loading"])])],32)]),_:1},8,["visible"])])):K("",!0)],64)}}},yt={class:"grid"},kt={class:"col-12"},wt={class:"flex justify-content-end my-4"},$t={class:"card"},St=e("p",{class:"text-center"},"No Data found...",-1),Vt={class:"card"},xt={class:"kpi-form grid"},Ut={class:"col-12"},Dt={class:"user-selection w-full"},Ct=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Title:",-1),Ft={class:"col-12"},Tt={class:"user-selection w-full"},Mt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),Et={class:"col-12"},It={class:"user-selection w-full"},qt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Status:",-1),At={class:"col-12 mx-auto flex justify-content-center"},Lt={class:"card"},Bt={class:"kpi-form grid"},Qt={class:"col-12"},Kt={class:"user-selection w-full"},Pt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Title:",-1),Ot={class:"col-12"},Nt={class:"user-selection w-full"},Rt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),Wt={class:"col-12"},jt={class:"user-selection w-full"},zt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Status:",-1),Gt={class:"col-12 mx-auto flex justify-content-center"},Yt={class:"grid"},Zt={class:"col-12"},Ht={class:"flex justify-content-end my-4"},Jt={class:"card"},Xt=e("p",{class:"text-center"},"No Data found...",-1),ea={class:"card"},la={class:"kpi-form grid"},ta={class:"col-12"},aa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Select Section:",-1),oa={class:"col-12"},sa={class:"user-selection w-full"},na=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Title:",-1),ia={class:"col-12"},da={class:"user-selection w-full"},ra=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),ca={class:"col-12"},ua={class:"user-selection w-full"},ma=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Mark Type:",-1),pa={class:"col-12"},_a={class:"user-selection w-full"},fa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Target Mark:",-1),va={class:"col-12"},ba={class:"user-selection w-full"},ha=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Comment:",-1),ga={class:"col-12"},ya={class:"user-selection w-full"},ka=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Status:",-1),wa={class:"col-12 mx-auto flex justify-content-center"},$a={class:"card"},Sa={class:"kpi-form grid"},Va={class:"col-12"},xa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Select Section:",-1),Ua={class:"col-12"},Da={class:"user-selection w-full"},Ca=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Title:",-1),Fa={class:"col-12"},Ta={class:"user-selection w-full"},Ma=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),Ea={class:"col-12"},Ia={class:"user-selection w-full"},qa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Mark Type:",-1),Aa={class:"col-12"},La={class:"user-selection w-full"},Ba=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Target Mark:",-1),Qa={class:"col-12"},Ka={class:"user-selection w-full"},Pa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Comment:",-1),Oa={class:"col-12"},Na={class:"user-selection w-full"},Ra=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Status:",-1),Wa={class:"col-12 mx-auto flex justify-content-center"},ja={__name:"Section",setup(Y){const ee=n(oe("read_section")),te=n(oe("create_section")),ae=n(oe("update_section")),de=n(oe("delete_section")),W=n(oe("read_sub_section")),A=n(oe("create_sub_section")),F=n(oe("update_sub_section")),L=n(oe("delete_sub_section")),S=ge(),c=he(),D=n([]),U=n([]),C=n(!1),T=n(!1),_=n(!1),g=n(!1),p=n({}),i=n({}),r=n({}),u=n({}),q=n(!1),B=n(!1),le=n(!1),f=n(!1),s=n(!1),V=async()=>{var Q;const o=P("token"),{data:a,pending:y}=await O(`${S.public.apiUrl}/kpi/section`,{method:"GET",headers:{Authorization:`Bearer ${o.value}`}},"$QLfPrBj95L");a&&(console.log("Section data: ",a.value.data),D.value=(Q=a.value)==null?void 0:Q.data.map((k,z)=>({...k,index:z+1})))},M=async()=>{var Q;const o=P("token"),{data:a,pending:y}=await O(`${S.public.apiUrl}/kpi/sub-section`,{method:"GET",headers:{Authorization:`Bearer ${o.value}`}},"$WaU7WXQtZH");a&&(console.log("Section data: ",a.value.data),U.value=(Q=a.value)==null?void 0:Q.data.map((k,z)=>({...k,index:z+1})))},X=n([{name:"Active",label:1},{name:"Inactive",label:0}]),j=n([{name:"Percentage (%)",label:1},{name:"Number (01)",label:0}]),N=async()=>{var z;q.value=!0,console.log(Object.keys(p.value));const o=new FormData;if(o.append("name",p.value.name),o.append("status",(z=p.value.status)==null?void 0:z.label),o.append("section_weightage",p.value.section_weightage),!p.value.name||!p.value.status)return q.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const a=P("token"),{data:y,pending:Q,error:k}=await O(`${S.public.apiUrl}/kpi/section-create`,{method:"POST",headers:{Authorization:`Bearer ${a.value}`},body:o},"$CJGlGi6sZy");y.value?(V(),C.value=!1,p.value={},q.value=!1,c.add({severity:"success",summary:"Updated",detail:"Section Created Successfully",group:"br",life:3e3})):(q.value=!1,c.add({severity:"error",summary:"Failed",detail:"Failed to create section!",group:"br",life:3e3}))},ne=async()=>{var k,z;B.value=!0,console.log(Object.keys(i.value));const o=new FormData;if(o.append("section_id",(k=i.value.section)==null?void 0:k.id),o.append("title",i.value.name),o.append("target_mark",i.value.targetMark),o.append("mark_type",i.value.mark_type.label),o.append("weightage",i.value.weightage),o.append("comment",i.value.comment||""),o.append("status",(z=i.value.status)==null?void 0:z.label),!i.value.section||!i.value.name||!i.value.targetMark||!i.value.status)return B.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const a=P("token"),{data:y,pending:Q}=await O(`${S.public.apiUrl}/kpi/sub-section-create`,{method:"POST",headers:{Authorization:`Bearer ${a.value}`},body:o},"$YVPI7MPSvE");y.value?(M(),T.value=!1,i.value={},B.value=!1,c.add({severity:"success",summary:"Updated",detail:"Sub Section Created Successfully",group:"br",life:3e3})):(B.value=!1,c.add({severity:"error",summary:"Failed",detail:"Failed to create sub section!",group:"br",life:3e3}))},re=async o=>{_.value=!0,r.value={...o,status:o.status===1?{name:"Active",label:1}:{name:"Inactive",label:0}},console.log("Edit Data:",r.value)},v=n(),d=async o=>{g.value=!0,v.value=D.value.map(a=>({name:a.name,id:a.id})),u.value={subSectionId:o.id,section_id:v.value.find(a=>a.id===o.section_id),title:o.title,target_mark:o.target_mark,mark_type:j.value.find(a=>a.label===o.mark_type),weightage:o.weightage,comment:o.comment,status:X.value.find(a=>a.label===o.status)}},I=async()=>{var z;if(le.value=!0,!r.value.name||!r.value.status)return le.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const o=new FormData;o.append("name",r.value.name),o.append("status",(z=r.value.status)==null?void 0:z.label),o.append("section_weightage",r.value.section_weightage);const a=P("token"),{data:y,pending:Q,error:k}=await O(`${S.public.apiUrl}/kpi/section-update/${r.value.id}`,{method:"POST",headers:{Authorization:`Bearer ${a.value}`},body:o},"$RRgAmPcwW9");y.value?(V(),_.value=!1,r.value={},le.value=!1,c.add({severity:"success",summary:"Updated",detail:"Section Updated Successfully",group:"br",life:3e3})):(le.value=!1,c.add({severity:"error",summary:k.value.data.app_message,detail:k.value.data.user_message,group:"br",life:3e3}))},E=async()=>{var z,ie;if(f.value=!0,!u.value.section_id||!u.value.title||!u.value.target_mark||!u.value.status)return f.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});console.log(u);const o=new FormData;o.append("section_id",(z=u.value.section_id)==null?void 0:z.id),o.append("title",u.value.title),o.append("weightage",u.value.weightage),o.append("target_mark",u.value.target_mark),o.append("mark_type",u.value.mark_type.label),o.append("comment",u.value.comment),o.append("status",(ie=u.value.status)==null?void 0:ie.label);const a=P("token"),{data:y,pending:Q,error:k}=await O(`${S.public.apiUrl}/kpi/sub-section-update/${u.value.subSectionId}`,{method:"POST",headers:{Authorization:`Bearer ${a.value}`},body:o},"$Bgl5cHylQ2");y.value?(M(),g.value=!1,u.value={},f.value=!1,c.add({severity:"success",summary:"Updated",detail:"Sub Section Updated Successfully",group:"br",life:3e3})):(f.value=!1,c.add({severity:"error",summary:k.value.data.app_message||"Error",detail:k.value.data.user_message||"Failed To Update",group:"br",life:3e3}))},w=async o=>{const a=P("token"),{data:y,pending:Q,error:k}=await O(`${S.public.apiUrl}/kpi/section-delete/${o}`,{method:"DELETE",headers:{Authorization:`Bearer ${a.value}`}},"$fSYmqaVVux");y.value?(V(),c.add({severity:"success",summary:"Deleted",detail:"Section Deleted Successfully",group:"br",life:3e3})):c.add({severity:"error",summary:"Failed",detail:k.value.data.user_message,group:"br",life:3e3})},b=async o=>{const a=P("token"),{data:y,pending:Q,error:k}=await O(`${S.public.apiUrl}/kpi/sub-section-delete/${o}`,{method:"DELETE",headers:{Authorization:`Bearer ${a.value}`}},"$K5gf5dTDYf");y.value?(M(),c.add({severity:"success",summary:"Deleted",detail:"Sub Section Deleted Successfully",group:"br",life:3e3})):c.add({severity:"error",summary:"Failed",detail:k.value.data.user_message,group:"br",life:3e3})};return Qe(()=>{V(),M()}),(o,a)=>{const y=be,Q=ze,k=Te,z=Me,ie=Ve,ye=Ge,x=Se,G=xe,ve=Ae,ke=Pe;return $(),Z(ke,{activeIndex:0},{default:h(()=>[l(ee)?($(),Z(ve,{key:0,header:"Sections"},{default:h(()=>[e("div",yt,[e("div",kt,[e("div",wt,[l(te)?($(),Z(y,{key:0,onClick:a[0]||(a[0]=()=>C.value=!0),label:"Section",icon:"pi pi-plus",class:""})):K("",!0)]),e("div",$t,[t(z,{class:"table-stR",value:l(D),paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:l(s)},{empty:h(()=>[St]),loading:h(()=>[t(Q,{style:{width:"50px",height:"50px"}})]),default:h(()=>[t(k,{field:"index",header:"Serial",sortable:""}),t(k,{style:{"text-wrap":"nowrap"},field:"name",header:"Section Name"}),t(k,{style:{"text-wrap":"nowrap"},field:"section_weightage",header:"Weightage"}),t(k,{field:"action",header:"Action"},{body:h(m=>[l(ae)?($(),Z(y,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:fe=>re(m.data)},null,8,["onClick"])):K("",!0),l(de)?($(),Z(y,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:fe=>w(m.data.id)},null,8,["onClick"])):K("",!0)]),_:1})]),_:1},8,["value","loading"])])])]),t(G,{visible:l(C),"onUpdate:visible":a[4]||(a[4]=m=>J(C)?C.value=m:null),modal:"",header:"Create Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:h(()=>[e("form",{class:"",action:"",onSubmit:me(N,["prevent"])},[e("div",Vt,[e("div",xt,[e("div",Ut,[e("div",Dt,[Ct,t(ie,{type:"text",modelValue:l(p).name,"onUpdate:modelValue":a[1]||(a[1]=m=>l(p).name=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Ft,[e("div",Tt,[Mt,t(ye,{modelValue:l(p).section_weightage,"onUpdate:modelValue":a[2]||(a[2]=m=>l(p).section_weightage=m),placeholder:"Weightage",inputId:"Weightage",min:0,max:60,class:"w-full"},null,8,["modelValue"])])]),e("div",Et,[e("div",It,[qt,t(x,{modelValue:l(p).status,"onUpdate:modelValue":a[3]||(a[3]=m=>l(p).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",At,[t(y,{label:"Create",severity:"info",type:"submit",loading:l(q)},null,8,["loading"])])])])],32)]),_:1},8,["visible"]),t(G,{visible:l(_),"onUpdate:visible":a[8]||(a[8]=m=>J(_)?_.value=m:null),modal:"",header:"Edit Section",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:h(()=>[e("form",{class:"",action:"",onSubmit:me(I,["prevent"])},[e("div",Lt,[e("div",Bt,[e("div",Qt,[e("div",Kt,[Pt,t(ie,{type:"text",modelValue:l(r).name,"onUpdate:modelValue":a[5]||(a[5]=m=>l(r).name=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Ot,[e("div",Nt,[Rt,t(ye,{modelValue:l(r).section_weightage,"onUpdate:modelValue":a[6]||(a[6]=m=>l(r).section_weightage=m),placeholder:"Weightage",inputId:"Weightage",min:0,max:60,class:"w-full"},null,8,["modelValue"])])]),e("div",Wt,[e("div",jt,[zt,t(x,{modelValue:l(r).status,"onUpdate:modelValue":a[7]||(a[7]=m=>l(r).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",Gt,[t(y,{label:"Update",severity:"info",type:"submit",loading:l(le)},null,8,["loading"])])])])],32)]),_:1},8,["visible"])]),_:1})):K("",!0),l(W)?($(),Z(ve,{key:1,header:"Sub Sections"},{default:h(()=>[e("div",Yt,[e("div",Zt,[e("div",Ht,[l(A)?($(),Z(y,{key:0,onClick:a[9]||(a[9]=()=>T.value=!0),label:"Sub Section",icon:"pi pi-plus",class:""})):K("",!0)]),e("div",Jt,[t(z,{class:"table-stR",value:l(U),paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:l(s)},{empty:h(()=>[Xt]),loading:h(()=>[t(Q,{style:{width:"50px",height:"50px"}})]),default:h(()=>[t(k,{field:"index",header:"Serial",sortable:""}),t(k,{style:{"text-wrap":"nowrap"},field:"title",header:"Sub Section Name"}),t(k,{style:{"text-wrap":"nowrap"},field:"target_mark",header:"Target Mark"}),t(k,{style:{"text-wrap":"nowrap"},field:"weightage",header:"Weightage"}),t(k,{style:{"text-wrap":"nowrap"},field:"section_name",header:"Section"}),t(k,{style:{"text-wrap":"nowrap"},field:"comment",header:"Comment"}),t(k,{field:"action",header:"Action"},{body:h(m=>[l(F)?($(),Z(y,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:fe=>d(m.data)},null,8,["onClick"])):K("",!0),l(L)?($(),Z(y,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:fe=>b(m.data.id)},null,8,["onClick"])):K("",!0)]),_:1})]),_:1},8,["value","loading"])])])]),t(G,{visible:l(T),"onUpdate:visible":a[17]||(a[17]=m=>J(T)?T.value=m:null),modal:"",header:"Create Sub Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:h(()=>[e("form",{class:"",action:"",onSubmit:me(ne,["prevent"])},[e("div",ea,[e("div",la,[e("div",ta,[aa,t(x,{modelValue:l(i).section,"onUpdate:modelValue":a[10]||(a[10]=m=>l(i).section=m),options:l(D),optionLabel:"name",placeholder:"Select Section",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e("div",oa,[e("div",sa,[na,t(ie,{type:"text",modelValue:l(i).name,"onUpdate:modelValue":a[11]||(a[11]=m=>l(i).name=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",ia,[e("div",da,[ra,t(ie,{type:"text",modelValue:l(i).weightage,"onUpdate:modelValue":a[12]||(a[12]=m=>l(i).weightage=m),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",ca,[e("div",ua,[ma,t(x,{modelValue:l(i).mark_type,"onUpdate:modelValue":a[13]||(a[13]=m=>l(i).mark_type=m),options:l(j),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",pa,[e("div",_a,[fa,t(ie,{type:"number",modelValue:l(i).targetMark,"onUpdate:modelValue":a[14]||(a[14]=m=>l(i).targetMark=m),placeholder:"Set Target Mark",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",va,[e("div",ba,[ha,t(ie,{type:"text",modelValue:l(i).comment,"onUpdate:modelValue":a[15]||(a[15]=m=>l(i).comment=m),placeholder:"Comment",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",ga,[e("div",ya,[ka,t(x,{modelValue:l(i).status,"onUpdate:modelValue":a[16]||(a[16]=m=>l(i).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",wa,[t(y,{label:"Create",severity:"info",type:"submit",loading:l(B)},null,8,["loading"])])])])],32)]),_:1},8,["visible"]),t(G,{visible:l(g),"onUpdate:visible":a[25]||(a[25]=m=>J(g)?g.value=m:null),modal:"",header:"Edit Sub Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:h(()=>[e("form",{class:"",action:"",onSubmit:me(E,["prevent"])},[e("div",$a,[e("div",Sa,[e("div",Va,[xa,t(x,{modelValue:l(u).section_id,"onUpdate:modelValue":a[18]||(a[18]=m=>l(u).section_id=m),options:l(v),optionLabel:"name",placeholder:"Select Section",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e("div",Ua,[e("div",Da,[Ca,t(ie,{type:"text",modelValue:l(u).title,"onUpdate:modelValue":a[19]||(a[19]=m=>l(u).title=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Fa,[e("div",Ta,[Ma,t(ie,{type:"text",modelValue:l(u).weightage,"onUpdate:modelValue":a[20]||(a[20]=m=>l(u).weightage=m),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Ea,[e("div",Ia,[qa,t(x,{modelValue:l(u).mark_type,"onUpdate:modelValue":a[21]||(a[21]=m=>l(u).mark_type=m),options:l(j),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",Aa,[e("div",La,[Ba,t(ie,{type:"number",modelValue:l(u).target_mark,"onUpdate:modelValue":a[22]||(a[22]=m=>l(u).target_mark=m),placeholder:"Set Target Mark",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Qa,[e("div",Ka,[Pa,t(ie,{type:"text",modelValue:l(u).comment,"onUpdate:modelValue":a[23]||(a[23]=m=>l(u).comment=m),placeholder:"Comment",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Oa,[e("div",Na,[Ra,t(x,{modelValue:l(u).status,"onUpdate:modelValue":a[24]||(a[24]=m=>l(u).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",Wa,[t(y,{label:"Update",severity:"info",type:"submit",loading:l(f)},null,8,["loading"])])])])],32)]),_:1},8,["visible"])]),_:1})):K("",!0)]),_:1})}}};const Ue=Y=>(Ce("data-v-fd9d5cb5"),Y=Y(),Fe(),Y),za={key:0,class:"grid"},Ga={class:"col-12"},Ya={class:"flex justify-content-end my-4"},Za={class:"card"},Ha={class:"card"},Ja={class:"kpi-form grid"},Xa={class:"col-12"},eo={class:"user-selection w-full"},lo=Ue(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter Name:",-1)),to={class:"col-12"},ao={class:"user-selection w-full"},oo=Ue(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Start Date:",-1)),so={class:"col-12"},no={class:"user-selection w-full"},io=Ue(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"End Date:",-1)),ro={class:"col-12"},co={class:"user-selection w-full"},uo=Ue(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Year:",-1)),mo={class:"text-center w-full text-red-500"},po={class:"col-12 mx-auto flex justify-content-center"},_o={__name:"Quater",setup(Y){const ee=n(oe("read_quater")),te=n(oe("create_quater")),ae=n(oe("update_quater")),de=n(oe("delete_quater")),W=ge(),A=he(),F=n([]),L=n([]),S=n(!1),c=n({name:"",start_date:"",end_date:"",year:""}),D=n(""),U=async()=>{const p=P("token"),{data:i,pending:r}=await O(`${W.public.apiUrl}/kpi-quater/list`,{method:"GET",headers:{Authorization:`Bearer ${p.value}`}},"$xAc4CusaQB");i&&(F.value=i.value.data)},C=p=>{const i=new Date(p);return`${i.getFullYear()}-${("0"+(i.getMonth()+1)).slice(-2)}-${("0"+i.getDate()).slice(-2)}`},T=async p=>{console.log(p.newData);const i=new FormData;console.log(p.newData),i.append("name",p.newData.name),typeof p.newData.year=="string"?i.append("year",`${p.newData.year}-01-01`):i.append("year",C(p.newData.year)),typeof p.newData.start_date=="string"?i.append("start_date",`2024-${p.newData.start_date}`):i.append("start_date",C(p.newData.start_date)),typeof p.newData.end_date=="string"?i.append("end_date",`2024-${p.newData.end_date}`):i.append("end_date",C(p.newData.end_date));const r=P("token"),{data:u,pending:q}=await O(`${W.public.apiUrl}/kpi-quater/update/${p.newData.id}`,{method:"POST",headers:{Authorization:`Bearer ${r.value}`},body:i},"$l1lK7dLb4F");return u?(U(),A.add({severity:"success",summary:"Updated",detail:"Successfully updated",group:"br",life:3e3})):A.add({severity:"error",summary:"Failed",detail:"Failed to update",group:"br",life:3e3})},_=async p=>{const i=P("token"),{data:r,pending:u}=await O(`${W.public.apiUrl}/kpi-quater/delete/${p.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${i.value}`}},"$EbQqn17n2R");return r?(U(),A.add({severity:"success",summary:"Deleted",detail:"Successfully deleted",group:"br",life:3e3})):A.add({severity:"error",summary:"Failed",detail:"Failed to delete",group:"br",life:3e3})},g=async()=>{console.log(Object.keys(c.value)),console.log(c.value);const p=new FormData;if(c.value.name!="")p.append("name",c.value.name);else{D.value="Please fill the required fields";return}if(c.value.start_date!="")p.append("start_date",C(c.value.start_date));else{D.value="Please fill the required fields";return}if(c.value.end_date!="")p.append("end_date",C(c.value.end_date));else{D.value="Please fill the required fields";return}if(c.value.year!="")p.append("year",C(c.value.year));else{D.value="Please fill the required fields";return}const i=P("token"),{data:r,pending:u}=await O(`${W.public.apiUrl}/kpi-quater/create`,{method:"POST",headers:{Authorization:`Bearer ${i.value}`},body:p},"$J9PxtNIiS2");return r?(U(),S.value=!1,c.value={name:"",start_date:"",end_date:"",year:""},D.value=null,A.add({severity:"success",summary:"Updated",detail:"Successfully Created",group:"br",life:3e3})):A.add({severity:"error",summary:"Failed",detail:"Failed to update",group:"br",life:3e3})};return Qe(()=>{U()}),(p,i)=>{const r=be,u=Ve,q=Te,B=qe,le=Me,f=xe;return $(),R(_e,null,[l(ee)?($(),R("div",za,[e("div",Ga,[e("div",Ya,[l(te)?($(),Z(r,{key:0,onClick:i[0]||(i[0]=()=>S.value=!0),label:"Create",icon:"pi pi-plus",class:""})):K("",!0)]),e("div",Za,[t(le,{editingRows:l(L),"onUpdate:editingRows":i[1]||(i[1]=s=>J(L)?L.value=s:null),value:l(F),editMode:"row",dataKey:"id",onRowEditSave:T,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:s})=>({style:s.d_editing&&"padding-top: 0.75rem; padding-bottom: 0.75rem"})}},dt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:s})=>({style:s.d_editing&&"padding-top: 0.75rem; padding-bottom: 0.75rem"})}}},{default:h(()=>[t(q,{field:"name",header:"Quarter",style:{width:"20%"}},{editor:h(({data:s,field:V})=>[t(u,{modelValue:s[V],"onUpdate:modelValue":M=>s[V]=M},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(q,{field:"start_date",header:"Start Date",style:{width:"20%"}},{editor:h(({data:s,field:V})=>[t(B,{modelValue:s[V],"onUpdate:modelValue":M=>s[V]=M,dateFormat:"mm-dd",fluid:"",value:s[V],manualInputs:!1},null,8,["modelValue","onUpdate:modelValue","value"])]),_:1}),t(q,{field:"end_date",header:"End Date",style:{width:"20%"}},{editor:h(({data:s,field:V})=>[t(B,{modelValue:s[V],"onUpdate:modelValue":M=>s[V]=M,dateFormat:"mm-dd",fluid:"",manualInputs:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(q,{field:"year",header:"Year",style:{width:"20%"}},{body:h(({data:s})=>[pe(H(s.year),1)]),editor:h(({data:s,field:V})=>[t(B,{modelValue:s[V],"onUpdate:modelValue":M=>s[V]=M,view:"year",dateFormat:"yy",fluid:"",manualInputs:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(ae)?($(),Z(q,{key:0,header:" ",rowEditor:!0,style:{width:"1%","margin-right":"-200px","min-width":"6rem",padding:"0 auto"},bodyStyle:"text-align:end",class:""})):K("",!0),l(ae)?K("",!0):($(),Z(q,{key:1,header:" ",style:{width:"1%","min-width":"6rem","margin-right":"-200px",padding:"0 auto"},bodyStyle:"text-align:end",class:""})),l(de)?($(),Z(q,{key:2,header:"Action",style:{width:"1%","min-width":"1rem",padding:"0"},bodyStyle:"text-align:end"},{body:h(({data:s})=>[t(r,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text",onClick:V=>_(s)},null,8,["onClick"])]),_:1})):K("",!0)]),_:1},8,["editingRows","value","pt","dt"])])])])):K("",!0),t(f,{visible:l(S),"onUpdate:visible":i[6]||(i[6]=s=>J(S)?S.value=s:null),modal:"",header:"Create Quarter",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:h(()=>[e("form",{class:"",action:"",onSubmit:me(g,["prevent"])},[e("div",Ha,[e("div",Ja,[e("div",Xa,[e("div",eo,[lo,t(u,{type:"text",modelValue:l(c).name,"onUpdate:modelValue":i[2]||(i[2]=s=>l(c).name=s),placeholder:"Name",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",to,[e("div",ao,[oo,t(B,{modelValue:l(c).start_date,"onUpdate:modelValue":i[3]||(i[3]=s=>l(c).start_date=s),dateFormat:"mm-dd",fluid:"",manualInputs:!1,class:"w-full",required:"",placeholder:"MM-DD"},null,8,["modelValue"])])]),e("div",so,[e("div",no,[io,t(B,{modelValue:l(c).end_date,"onUpdate:modelValue":i[4]||(i[4]=s=>l(c).end_date=s),dateFormat:"mm-dd",fluid:"",manualInputs:!1,class:"w-full",required:"",placeholder:"MM-DD"},null,8,["modelValue"])])]),e("div",ro,[e("div",co,[uo,t(B,{modelValue:l(c).year,"onUpdate:modelValue":i[5]||(i[5]=s=>l(c).year=s),view:"year",dateFormat:"yy",fluid:"",manualInputs:!1,class:"w-full",placeholder:"YYYY"},null,8,["modelValue"])])]),e("p",mo,H(l(D)),1),e("div",po,[t(r,{label:"Create",severity:"info",type:"submit"})])])])],32)]),_:1},8,["visible"])],64)}}},fo=De(_o,[["__scopeId","data-v-fd9d5cb5"]]);const se=Y=>(Ce("data-v-85d83f37"),Y=Y(),Fe(),Y),vo={class:"card"},bo=se(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"KPI Report")],-1)),ho={class:"card mx-auto",style:{"max-width":"50rem"}},go={class:"grid col-12 w-full"},yo={class:"col-12 md:col-4"},ko=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Team Member",-1)),wo={class:"col-12 md:col-4"},$o=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),So={class:"col-12 md:col-4"},Vo=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Deadline",-1)),xo={key:0,class:""},Uo=["onClick"],Do=se(()=>e("i",{class:"pi pi-times-circle text-xl"},null,-1)),Co=[Do],Fo={class:"w-full col-12 grid"},To={class:"col-12 md:col-6"},Mo=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},[pe("Section"),e("i",{class:"text-red-400 text-italic"},"*")],-1)),Eo={class:"col-12 md:col-6"},Io=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},[pe("Sub Section"),e("i",{class:"text-red-400 text-italic"},"*")],-1)),qo={class:"flex gap-2 w-full"},Ao={class:"col-12 md:col-6"},Lo=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),Bo={class:"col-12 md:col-6"},Qo={for:"icondisplay",class:"font-bold block mb-2"},Ko={class:"col-12"},Po=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Comment",-1)),Oo={class:"gap-2 flex justify-content-center w-full"},No={class:""},Ro={class:"kpi-form grid"},Wo={class:"col-12"},jo=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Select Section:",-1)),zo={class:"col-12"},Go={class:"user-selection w-full"},Yo=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Title:",-1)),Zo={class:"col-12"},Ho={class:"user-selection w-full"},Jo=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1)),Xo={class:"col-12"},es={class:"user-selection w-full"},ls=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Mark Type:",-1)),ts={class:"col-12"},as={class:"user-selection w-full"},os=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Key result Target:",-1)),ss={class:"col-12"},ns={class:"user-selection w-full"},is=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Comment:",-1)),ds={class:"col-12"},rs={class:"user-selection w-full"},cs=se(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Status:",-1)),us={class:"col-12 mx-auto flex justify-content-center"},ms={__name:"index",setup(Y){const ee=ge(),te=n(oe("read_kpi")),ae=n(oe("create_kpi")),de=n(oe("read_quater")),W=n(oe("read_section")),A=n([]),F=n(""),L=n([]),S=n(""),c=n(""),D=n([]);n("");const U=n([{name:"Active",label:1},{name:"Inactive",label:0}]),C=n(!1),T=n([]);n([]);const _=n({}),g=n([{section_id:null,subsection_id:null,quater_id:null,achive_mark:0,target_mark:0,comment:""}]),p=n(""),i=n(!1),r=n(!1),u=he(),q=(v,d)=>{console.log("check selected section",d),r.value=v,_.value.section=d,console.log("check subsection create",_.value.section)},B=async()=>{var w,b,o;const v=P("token"),{data:d,pending:I,error:E}=await Ke("getMembers22",()=>$fetch(`${ee.public.apiUrl}/teams/members`,{headers:{Authorization:`Bearer ${v.value}`}}));console.log("memmbess",(w=d.value)==null?void 0:w.team_members),(b=d.value)!=null&&b.team_members&&(A.value=(o=d.value)==null?void 0:o.team_members.map(a=>({id:a.id,name:a.name})),console.log("employee",F.value))},le=async()=>{var E,w,b;const v=P("token"),{data:d,error:I}=await O(`${ee.public.apiUrl}/kpi-quater/list`,{method:"GET",headers:{Authorization:`Bearer ${v.value}`}},"$LQ1vlojxsA");((w=(E=d.value)==null?void 0:E.data)==null?void 0:w.length)>0&&(L.value=(b=d.value)==null?void 0:b.data)},f=async()=>{var E,w,b;const v=P("token"),{data:d,error:I}=await O(`${ee.public.apiUrl}/kpi/section`,{method:"GET",headers:{Authorization:`Bearer ${v.value}`}},"$aOHxRgEOE3");((w=(E=d.value)==null?void 0:E.data)==null?void 0:w.length)>0&&(D.value=(b=d.value)==null?void 0:b.data)},s=async()=>{var E,w,b;const v=P("token"),{data:d,error:I}=await O(`${ee.public.apiUrl}/kpi/sub-section`,{method:"GET",headers:{Authorization:`Bearer ${v.value}`}},"$QrpcIVwZho");((w=(E=d.value)==null?void 0:E.data)==null?void 0:w.length)>0&&(T.value=(b=d.value)==null?void 0:b.data)},V=async()=>{var w,b;C.value=!0,console.log(Object.keys(_.value));const v=new FormData;if(v.append("section_id",(w=_.value.section)==null?void 0:w.id),v.append("title",_.value.name),v.append("target_mark",_.value.targetMark),v.append("mark_type",_.value.mark_type.label),v.append("weightage",_.value.weightage),v.append("comment",_.value.comment||""),v.append("status",(b=_.value.status)==null?void 0:b.label),!_.value.section||!_.value.name||!_.value.targetMark||!_.value.status)return C.value=!1,u.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const d=P("token"),{data:I,pending:E}=await O(`${ee.public.apiUrl}/kpi/sub-section-create`,{method:"POST",headers:{Authorization:`Bearer ${d.value}`},body:v},"$wlxClc7uGM");I.value?(s(),r.value=!1,_.value={},C.value=!1,u.add({severity:"success",summary:"Updated",detail:"Sub Section Created Successfully",group:"br",life:3e3})):(C.value=!1,u.add({severity:"error",summary:"Failed",detail:"Failed to create sub section!",group:"br",life:3e3}))},M=()=>{const v=g.value[g.value.length-1];if(v.section_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Section Not selected",group:"br",life:3e3});if(v.subsection_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Sub-section Not selected",group:"br",life:3e3});g.value.push({section_id:null,subsection_id:null,quater_id:null,achive_mark:0,comment:""})};Be(g,(v,d)=>{console.log(v)});const X=async()=>{const v=P("token");if(F.value=="")return u.add({severity:"error",summary:"KPI Information",detail:"Employee not selected",group:"br",life:3e3});if(c.value=="")return u.add({severity:"error",summary:"KPI Information",detail:"Quarter not selected",group:"br",life:3e3});if(S.value=="")return u.add({severity:"error",summary:"KPI Information",detail:"Deadline not selected",group:"br",life:3e3});const d=g.value[g.value.length-1];if(d.section_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Section Not selected",group:"br",life:3e3});if(d.subsection_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Sub-section Not selected",group:"br",life:3e3});const I=g.value.map(b=>({user_id:F.value.id,section_id:b.section_id.id,subsection_id:b.subsection_id.id,quater_id:c.value.id,achive_mark:b.achive_mark,comment:b.comment,deadline:N(S.value)})),{data:E,error:w}=await O(`${ee.public.apiUrl}/kpi/store`,{method:"POST",headers:{Authorization:`Bearer ${v.value}`},body:I},"$Fnl3NEI4jt");return E.value?(u.add({severity:"success",summary:"KPI Information",detail:"KPI Submission Complete",group:"br",life:3e3}),g.value=[{section_id:null,subsection_id:null,quater_id:null,achive_mark:0,target_mark:0,comment:""}],F.value="",i.value=!1):(i.value=!1,u.add({severity:"error",summary:"Failed",detail:"Failed to submit",group:"br",life:3e3}))},j=v=>{g.value.splice(v,1)},N=v=>{const d=new Date(v);return`${d.getFullYear()}-${("0"+(d.getMonth()+1)).slice(-2)}-${("0"+d.getDate()).slice(-2)}`},ne=v=>{v.index==0&&(B(),le(),f(),s())};B(),le(),f(),s();const re=new Date;return p.value=re.getFullYear(),(v,d)=>{const I=Ie,E=Se,w=qe,b=be,o=Ve,a=Ae,y=El,Q=gt,k=Pe,z=ja,ie=fo,ye=xe;return $(),R(_e,null,[e("div",vo,[t(I,{position:"bottom-right",group:"br"}),bo,t(k,{onTabChange:ne,class:"mt-3"},{default:h(()=>[l(te)?($(),Z(a,{key:0,class:"file-upload",header:"KPI"},{default:h(()=>[t(k,null,{default:h(()=>[l(ae)?($(),Z(a,{key:0,header:"Generate"},{default:h(()=>[e("div",ho,[e("form",{action:"",class:"grid",style:{gap:"10px"},onSubmit:me(X,["prevent"])},[e("div",go,[e("div",yo,[ko,t(E,{modelValue:l(F),"onUpdate:modelValue":d[0]||(d[0]=x=>J(F)?F.value=x:null),options:l(A),optionLabel:"name",placeholder:"Select User",class:"w-full"},null,8,["modelValue","options"])]),e("div",wo,[$o,t(E,{modelValue:l(c),"onUpdate:modelValue":d[1]||(d[1]=x=>J(c)?c.value=x:null),options:l(L),optionLabel:"name",placeholder:"Select Quarter",class:"w-full"},null,8,["modelValue","options"])]),e("div",So,[Vo,t(w,{modelValue:l(S),"onUpdate:modelValue":d[2]||(d[2]=x=>J(S)?S.value=x:null),dateFormat:"dd-mm-yy",placeholder:"DD-MM-YYYY"},null,8,["modelValue"])])]),l(F)!=""&&l(c)!==""?($(),R("div",xo,[($(!0),R(_e,null,$e(l(g),(x,G)=>{var ve,ke,m,fe;return $(),R("div",{key:G,class:"card relative"},[G!=0?($(),R("button",{key:0,type:"button",class:"close",onClick:ue=>j(G)},Co,8,Uo)):K("",!0),e("div",Fo,[e("div",To,[Mo,t(E,{modelValue:l(g)[G].section_id,"onUpdate:modelValue":ue=>l(g)[G].section_id=ue,options:l(D),optionLabel:"name",placeholder:"Select Section",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Eo,[Io,e("div",qo,[t(E,{modelValue:l(g)[G].subsection_id,"onUpdate:modelValue":ue=>l(g)[G].subsection_id=ue,options:(ke=(ve=l(g)[G])==null?void 0:ve.section_id)==null?void 0:ke.sub_section,optionLabel:"title",placeholder:"Select Sub Section",class:"w-full",style:{"max-width":"17rem"}},null,8,["modelValue","onUpdate:modelValue","options"]),t(b,{onClick:()=>{q(!0,l(g)[G].section_id)},icon:"pi pi-plus",severity:"success","aria-label":"Add New",class:""},null,8,["onClick"])])]),e("div",Ao,[Lo,t(E,{disabled:"",modelValue:l(c),"onUpdate:modelValue":d[3]||(d[3]=ue=>J(c)?c.value=ue:null),options:l(L),optionLabel:"name",placeholder:"Select Quarter",class:"w-full"},null,8,["modelValue","options"])]),e("div",Bo,[e("label",Qo,"Achieved Mark (Target: "+H(((m=l(g)[G].subsection_id)==null?void 0:m.target_mark)||0)+H(((fe=l(g)[G].subsection_id)==null?void 0:fe.mark_type)==1?"%":0)+")",1),t(o,{modelValue:l(g)[G].achive_mark,"onUpdate:modelValue":ue=>l(g)[G].achive_mark=ue,placeholder:"Input Mark",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Ko,[Po,t(o,{modelValue:l(g)[G].comment,"onUpdate:modelValue":ue=>l(g)[G].comment=ue,placeholder:"Write comment",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])])}),128))])):K("",!0),e("div",Oo,[t(b,{label:"New Section",class:"bg-green-500 border-none",onClick:d[4]||(d[4]=me(x=>M(v.index),["prevent"]))}),t(b,{type:"submit",label:"Submit",class:"",disabled:l(F)===""||l(c)===""||l(S)===""},null,8,["disabled"])])],32)])]),_:1})):K("",!0),t(a,{header:"Submission"},{default:h(()=>[t(y,{quater:l(L)},null,8,["quater"])]),_:1}),t(a,{header:"Report"},{default:h(()=>[t(Q,{quater:l(L)},null,8,["quater"])]),_:1})]),_:1})]),_:1})):K("",!0),l(W)?($(),Z(a,{key:1,header:"Sections"},{default:h(()=>[t(z)]),_:1})):K("",!0),l(de)?($(),Z(a,{key:2,header:"Quarter"},{default:h(()=>[t(ie)]),_:1})):K("",!0)]),_:1})]),t(ye,{visible:l(r),"onUpdate:visible":d[12]||(d[12]=x=>J(r)?r.value=x:null),modal:"",header:"Create Sub Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:h(()=>[e("form",{class:"",action:"",onSubmit:me(V,["prevent"])},[e("div",No,[e("div",Ro,[e("div",Wo,[jo,t(E,{modelValue:l(_).section,"onUpdate:modelValue":d[5]||(d[5]=x=>l(_).section=x),options:l(D),optionLabel:"name",placeholder:"Select Section",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e("div",zo,[e("div",Go,[Yo,t(o,{type:"text",modelValue:l(_).name,"onUpdate:modelValue":d[6]||(d[6]=x=>l(_).name=x),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Zo,[e("div",Ho,[Jo,t(o,{type:"text",modelValue:l(_).weightage,"onUpdate:modelValue":d[7]||(d[7]=x=>l(_).weightage=x),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Xo,[e("div",es,[ls,t(E,{modelValue:l(_).mark_type,"onUpdate:modelValue":d[8]||(d[8]=x=>l(_).mark_type=x),options:[{name:"Percentage (%)",label:1},{name:"Number (01)",label:0}],optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",ts,[e("div",as,[os,t(o,{type:"number",modelValue:l(_).targetMark,"onUpdate:modelValue":d[9]||(d[9]=x=>l(_).targetMark=x),placeholder:"Set Target Mark",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",ss,[e("div",ns,[is,t(o,{type:"text",modelValue:l(_).comment,"onUpdate:modelValue":d[10]||(d[10]=x=>l(_).comment=x),placeholder:"Comment",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",ds,[e("div",rs,[cs,t(E,{modelValue:l(_).status,"onUpdate:modelValue":d[11]||(d[11]=x=>l(_).status=x),options:l(U),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",us,[t(b,{label:"Create",severity:"info",type:"submit",loading:l(C)},null,8,["loading"])])])])],32)]),_:1},8,["visible"])],64)}}},sn=De(ms,[["__scopeId","data-v-85d83f37"]]);export{sn as default};
