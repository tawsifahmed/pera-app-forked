import je from"./toast.esm.1152c75b.js";import{_ as Le}from"./nuxt-link.245153ab.js";import Be from"./inputtext.esm.2b241ceb.js";import Me from"./floatlabel.esm.8a348ecb.js";import xe from"./button.esm.99bebf04.js";import Re from"./tabpanel.esm.b0b4dbd1.js";import qe from"./tabview.esm.db7d1e05.js";import{a2 as de,a4 as Se,$ as i,aq as Ie,o as b,c as Ce,w,l as n,i as e,I as ke,u as s,b as C,a6 as X,a7 as Ee,a8 as De,F as Oe,f as Fe,k as ee,am as ze,ca as Pe,a3 as le,cg as Ge,a5 as we,ag as He,V as We,ap as Qe,Y as Ze,ab as Ke,s as ie,e as ne,r as Ye,a as Je,t as Xe}from"./entry.47cc6144.js";import{u as re}from"./user.67d247fa.js";import $e from"./password.esm.19b306ca.js";import{u as ce}from"./auth.10ed8332.js";import et from"./dialog.esm.9aca4fc6.js";import{u as ue,a as G}from"./cookie.06a761fe.js";import{_ as tt}from"./avatar.2aac3b6d.js";import{u as Te}from"./clock.18bae4b3.js";import{u as ot}from"./layout.fc56cd87.js";import"./portal.esm.53c3bddd.js";import"./basecomponent.esm.e27d4a57.js";import"./index.esm.66a0c4ce.js";import"./baseicon.esm.909dfacd.js";import"./index.esm.148d8dcb.js";import"./index.esm.0aa8bacc.js";import"./index.esm.008fa3b1.js";import"./badge.esm.da680d61.js";import"./index.esm.b9f99795.js";import"./index.esm.2d7d2907.js";import"./index.esm.db9fb6ed.js";import"./index.esm.23f86370.js";import"./overlayeventbus.esm.cf701e86.js";const Ue=""+new URL("dummy_profile.643624ed.png",import.meta.url).href;const P=T=>(Ee("data-v-3cf31c8a"),T=T(),De(),T),at={class:"col-12 text-center mb-5"},st={class:"relative w-fit mx-auto"},lt=["src"],it={key:1,src:Ue,alt:"",style:{height:"100px",width:"100px","border-radius":"100%","object-fit":"cover"}},nt={class:"img-label"},rt=P(()=>e("label",{for:"image"},[e("i",{class:"pi pi-plus",style:{color:"red",right:"0.2rem",bottom:"0.2rem","z-index":"5","background-color":"white",padding:"8px","border-radius":"20px","box-shadow":"rgba(0, 0, 0, 0.16) 0px 1px 4px",cursor:"pointer"}})],-1)),ct=["v-model"],ut={class:"col-12 lg:col-6 mb-3"},dt=P(()=>e("label",{for:"name"},"Name",-1)),pt={class:"col-12 lg:col-6 mb-3"},mt=P(()=>e("label",{for:"phone"},"Phone",-1)),vt={class:"col-12 lg:col-6 mb-3"},_t=P(()=>e("label",{for:"email"},"Email",-1)),ft={class:"col-12 lg:col-6 mb-3"},gt=P(()=>e("label",{for:"address"},"Address",-1)),bt={class:"col-12 mb-3 flex justify-content-center"},ht=P(()=>e("br",null,null,-1)),yt=P(()=>e("br",null,null,-1)),kt={class:"col-12 mb-3"},wt=P(()=>e("label",{for:"passw"},"New Password",-1)),$t={class:"col-12"},Tt=P(()=>e("label",{for:"password2"},"Confirm Password",-1)),xt={class:"col-12 mt-3 mb-3 px-5 flex justify-content-center"},St={__name:"Profile",props:["userProfile"],setup(T){var j,L,H,W,Q;const{passwordReset:q}=ce(),{userProfile:a}=T,{updateUser:N}=re(),v=Se(),c=i(!1),O=i(a==null?void 0:a.data.id),U=i((j=a==null?void 0:a.data)==null?void 0:j.name),_=i((L=a==null?void 0:a.data)==null?void 0:L.image),h=i(null),x=i((H=a==null?void 0:a.data)==null?void 0:H.phone),E=i((W=a==null?void 0:a.data)==null?void 0:W.email),S=i((Q=a==null?void 0:a.data)==null?void 0:Q.address),r=i({password:"",confirm_password:""}),f=i(!1),o=i(!1);Ie(r.value,()=>{r.value.password!==r.value.confirm_password&&r.value.confirm_password!==""&&r.value.password!==""?(f.value=!0,o.value=!0):(f.value=!1,o.value=!1)});const g=async()=>{c.value=!0;const u=await N(O.value,U.value,x.value,E.value,S.value,h.value);(u==null?void 0:u.code)===200?v.add({severity:"success",summary:"Success",detail:"Profile Updated Successfully",group:"br",life:3e3}):v.add({severity:"error",summary:"Error",detail:"Profile Updated Failed",group:"br",life:3e3}),c.value=!1},m=u=>{h.value=u.target.files[0],_.value=URL.createObjectURL(h.value)},I=async()=>{if(c.value=!0,c.value=!0,r.value.password===""||r.value.confirm_password===""){f.value=!0,o.value=!0,v.add({severity:"error",summary:"Error",detail:"Password required",group:"br",life:3e3}),c.value=!1;return}else if(r.value.password!==r.value.confirm_password){v.add({severity:"error",summary:"Error",detail:"Passwords do not match",group:"br",life:3e3}),c.value=!1,f.value=!0,o.value=!0;return}else{const u=await q(E.value,r);console.log(u),u.code==200?(r.value.password="",r.value.confirm_password="",f.value=!1,o.value=!1,c.value=!1,v.add({severity:"success",summary:"Success",detail:u.message,group:"br",life:3e3})):(c.value=!1,v.add({severity:"error",summary:"Error",detail:u.message,group:"br",life:3e3}))}};return(u,d)=>{const y=Be,A=Me,Z=xe,B=Re,K=qe;return b(),Ce(K,null,{default:w(()=>[n(B,{header:"General Info"},{default:w(()=>[e("form",{onSubmit:ke(g,["prevent"]),class:"grid"},[e("div",at,[e("div",st,[s(_)?(b(),C("img",{key:0,src:`${s(_)}`,style:{height:"100px",width:"100px","border-radius":"100%","object-fit":"cover"}},null,8,lt)):(b(),C("img",it)),e("div",nt,[rt,e("input",{class:"hidden",type:"file","v-model":s(h),id:"image",onInput:d[0]||(d[0]=p=>m(p)),accept:".png, .jpeg, .jpg"},null,40,ct)])])]),e("div",ut,[n(A,null,{default:w(()=>[n(y,{id:"name",class:"w-full",modelValue:s(U),"onUpdate:modelValue":d[1]||(d[1]=p=>X(U)?U.value=p:null)},null,8,["modelValue"]),dt]),_:1})]),e("div",pt,[n(A,null,{default:w(()=>[n(y,{id:"phone",modelValue:s(x),"onUpdate:modelValue":d[2]||(d[2]=p=>X(x)?x.value=p:null),type:"number",class:"w-full"},null,8,["modelValue"]),mt]),_:1})]),e("div",vt,[n(A,null,{default:w(()=>[n(y,{id:"email",modelValue:s(E),"onUpdate:modelValue":d[3]||(d[3]=p=>X(E)?E.value=p:null),type:"email",class:"w-full",disabled:""},null,8,["modelValue"]),_t]),_:1})]),e("div",ft,[n(A,null,{default:w(()=>[n(y,{id:"address",modelValue:s(S),"onUpdate:modelValue":d[4]||(d[4]=p=>X(S)?S.value=p:null),class:"w-full"},null,8,["modelValue"]),gt]),_:1})]),e("div",bt,[n(Z,{class:"px-4",type:"submit",label:"Save",loading:s(c)},null,8,["loading"])])],32)]),_:1}),n(B,{header:"Password"},{default:w(()=>[ht,yt,e("form",{onSubmit:ke(I,["prevent"]),class:"grid form-width mx-auto"},[e("div",kt,[n(A,null,{default:w(()=>[n(s($e),{id:"passw",modelValue:s(r).password,"onUpdate:modelValue":d[5]||(d[5]=p=>s(r).password=p),placeholder:"Enter new password",feedback:!1,invalid:s(f),toggleMask:"",class:"w-full",inputClass:"w-full",inputStyle:{padding:"0.78rem"}},null,8,["modelValue","invalid"]),wt]),_:1})]),e("div",$t,[n(A,null,{default:w(()=>[n(s($e),{id:"password2",modelValue:s(r).confirm_password,"onUpdate:modelValue":d[6]||(d[6]=p=>s(r).confirm_password=p),placeholder:"Confirm new password",feedback:!1,invalid:s(o),toggleMask:"",class:"w-full",inputClass:"w-full",inputStyle:{padding:"0.78rem"}},null,8,["modelValue","invalid"]),Tt]),_:1})]),e("div",xt,[n(Z,{class:"px-4",type:"submit",label:"Save",loading:s(c)},null,8,["loading"])])],32)]),_:1})]),_:1})}}},It=de(St,[["__scopeId","data-v-3cf31c8a"]]);const Ct={class:"bg-white card1"},Et=["onClick","innerHTML"],Dt={key:1,class:"bg-white text-center text-lg"},Pt={class:"flex justify-content-between align-items-center mt-1"},Ut={class:"flex gap-2 justify-content-center"},Vt={__name:"Notification",emits:["closeNotification"],setup(T,{emit:q}){const a=Pe(),N=ue("token"),v=i([]),c=i(1),O=i(1),U=q,_=Se(),h=async o=>{var g;try{const{data:m,pending:I,error:j}=await G(`${a.public.apiUrl}/notification/update/${o.id}`,{method:"POST",headers:{Authorization:`Bearer ${N.value}`},body:{is_read:1}},"$7t93BZ4WTD"),L=localStorage.getItem("userCompany");((g=o.payload)==null?void 0:g.type)==="task_details"&&(await ze({path:`/companies/${L}/spaces/${o==null?void 0:o.space_id}/projects/${o==null?void 0:o.project_id}`,query:{task_key:o==null?void 0:o.task_id}}),U("closeNotification",!1)),await x()}catch(m){console.log(m)}},x=async()=>{try{const{data:o,pending:g,error:m}=await G(`${a.public.apiUrl}/notification/list?limit=5&page=${c.value}`,{method:"GET",headers:{Authorization:`Bearer ${N.value}`}},"$k6rqquZm3L");o.value&&(v.value=o.value.data,O.value=Math.ceil(o.value.total/5))}catch(o){console.log(o)}};(async()=>{await x()})();const S=i(!1),r=async()=>{S.value=!0;try{const{data:o,pending:g,error:m}=await G(`${a.public.apiUrl}/notification/read-all`,{method:"GET",headers:{Authorization:`Bearer ${N.value}`}},"$tGKn2qfAO6");o.value&&(await x(),_.add({severity:"success",summary:"Successful",detail:"All notifications marked as read",group:"br",life:3e3}),S.value=!1)}catch(o){console.log(o),S.value=!1,_.add({severity:"error",summary:"Error",detail:"Something went wrong!",group:"br",life:3e3})}},f=async o=>{o==="prev"&&c.value>1?c.value-=1:c.value+=1,await x()};return(o,g)=>{const m=xe;return b(),C("div",Ct,[s(v).length>0?(b(!0),C(Oe,{key:0},Fe(s(v),I=>(b(),C("div",{key:I,class:""},[e("div",{onClick:j=>h(I),innerHTML:I.title,class:ee(`title ${I.is_read===0?"unread":""}`)},null,10,Et)]))),128)):(b(),C("div",Dt," No notifications! ")),e("div",Pt,[n(m,{class:"invisible",label:"Read All"}),e("div",Ut,[n(m,{onClick:g[0]||(g[0]=I=>f("prev")),disabled:s(c)===1,icon:"pi pi-chevron-left",outlined:"","aria-label":"Filter"},null,8,["disabled"]),n(m,{onClick:g[1]||(g[1]=I=>f("")),disabled:s(O)===s(c)||!s(v).length>0,icon:"pi pi-chevron-right",outlined:"","aria-label":"Filter"},null,8,["disabled"])]),n(m,{class:"bg-white hover:bg-gray-200 text-indigo-500 hover:text-indigo-600",label:"Read All",onClick:r,loading:s(S)},null,8,["loading"])])])}}},Nt=de(Vt,[["__scopeId","data-v-1f32d7a9"]]);const $=T=>(Ee("data-v-5d4501ed"),T=T(),De(),T),At={class:"layout-topbar"},jt=$(()=>e("img",{src:tt,alt:"logo"},null,-1)),Lt=$(()=>e("i",{class:"pi pi-bars"},null,-1)),Bt=[Lt],Mt={class:"p-link layout-topbar-menu-button layout-topbar-button"},Rt=$(()=>e("i",{class:"pi pi-bell"},null,-1)),qt=[Rt],Ot=$(()=>e("i",{class:"pi pi-ellipsis-v"},null,-1)),Ft=[Ot],zt={key:0,class:"flex align-items-center gap-2"},Gt={class:"userImage"},Ht=["src"],Wt={key:1,src:Ue,alt:"",style:{height:"50px",width:"50px","border-radius":"50%","object-fit":"cover"}},Qt=$(()=>e("span",{class:"ml-4"},"Profile",-1)),Zt={class:"relative"},Kt={key:0,class:"ping-container"},Yt=$(()=>e("span",{class:"ping-outer"},null,-1)),Jt=$(()=>e("span",{class:"ping-inner"},null,-1)),Xt=[Yt,Jt],eo=$(()=>e("i",{class:"pi pi-bell"},null,-1)),to=$(()=>e("span",{class:"ml-4"},"Notification",-1)),oo=[eo,to],ao={key:1,class:"notification"},so={class:"clock-wrapper relative ml-2"},lo=$(()=>e("i",{class:ee("pi pi-stop text-white"),style:{"font-size":"11px","font-weight":"700"}},null,-1)),io=[lo],no={class:"text-sm absolute text-black time-int",id:"timer-interval"},ro=$(()=>e("i",{class:"pi pi-sign-out"},null,-1)),co=$(()=>e("span",null,"Sign Out",-1)),uo=[ro,co],po={__name:"AppTopbar",setup(T){var me,ve;const{getStoreTimer:q}=Te(),{timerData:a,isTImerStopped:N}=le(Te()),{getUserData:v}=re(),{userProfile:c}=le(re()),{layoutConfig:O,onMenuToggle:U}=ot(),_=i(null),h=i(!1),x=Ge(),E=Pe();i("name"),i(null);const{logUserOut:S}=ce();le(ce());const r=i(!1),f=i(!1),o=i(!1),g=()=>{S(),location.reload(),x.push("/login")};we(()=>{j()}),He(()=>{L()});const m=()=>{h.value=!h.value},I=We(()=>({"layout-topbar-menu-mobile-active":h.value})),j=()=>{_.value||(_.value=l=>{H(l)&&(h.value=!1)},document.addEventListener("click",_.value))},L=()=>{_.value&&(document.removeEventListener("click",_),_.value=null)},H=l=>{if(!h.value)return;const t=document.querySelector(".layout-topbar-menu"),k=document.querySelector(".layout-topbar-menu-button");return!(t.isSameNode(l.target)||t.contains(l.target)||k.isSameNode(l.target)||k.contains(l.target))},W=()=>{o.value&&(o.value=!1,y.value=!1)},Q=l=>{o.value=l},u={beforeMount(l,t){l.clickOutsideEvent=k=>{l==k.target||l.contains(k.target)||t.value(k)},document==null||document.body.addEventListener("click",l.clickOutsideEvent)},unmounted(l){var t;(t=document==null?void 0:document.body)==null||t.removeEventListener("click",l.clickOutsideEvent)}};we(()=>{const l=document.querySelector(".relative");u==null||u.beforeMount(l,{value:W})}),Qe(()=>{const l=document.querySelector(".relative");u==null||u.unmounted(l)}),v();const d=()=>{r.value=!r.value};Ze();const y=i(!1);(async()=>{const l=ue("token");try{const{data:t,pending:k,error:R}=await G(`${E.public.apiUrl}/notification/list?limit=5&page=1`,{method:"GET",headers:{Authorization:`Bearer ${l.value}`}},"$QWEnQlnRVH");t.value&&(console.log("notification data =>",t.value),t.value.data.find(Y=>Y.is_read===0)?y.value=!0:y.value=!1,console.log("notification data =>",y.value))}catch(t){console.log(t)}})();const Z=()=>{o.value=!o.value,y.value&&(y.value=!1)};i(!1);const B=i(),K=i(),p=i(),V=i(),pe=localStorage.getItem("storeTaskCompanyID");localStorage.getItem("storeTaskSpaceID"),localStorage.getItem("storeTaskProjectID"),localStorage.getItem("storeTaskID"),console.log("timerTaskId",V.value);const Ve=i(),te=i();(async()=>{const l=ue("token");try{const{data:t,pending:k,error:R}=await G(`${E.public.apiUrl}/tasks/timer-history`,{method:"GET",headers:{Authorization:`Bearer ${l.value}`}},"$h9G4Eef10F");t.value&&(console.log("active timer data =>",t.value),Ve.value=t.value.data.is_timer_start,t.value.data.is_timer_start==="true"&&(B.value=t.value.data.company_id,K.value=t.value.data.space_id,p.value=t.value.data.project_id,V.value=t.value.data.task_id,te.value=t.value.data.start_time),console.log("fetchedTimerData",t.value.data),console.log("timerTaskId",V.value))}catch(t){console.log(t)}})();const Ne=i();a.value&&(console.log("from Pinia"),Ne.value=(me=a.value)==null?void 0:me.task_id),console.log("timerDatPPPa",(ve=a.value)==null?void 0:ve.task_id),pe&&(B.value=pe),Ie(a,(l,t)=>{console.log("timerDataWW",t),t&&(V.value=t.task_id)});let M=null;function oe(l){const t=document.getElementById("timer-interval");if(l==="stop"){console.log("timerSTime",l),M&&(clearInterval(M),M=null);return}else{let R=function(){const F=new Date-k,ae=Math.floor(F/(1e3*60*60)),z=Math.floor(F%(1e3*60*60)/(1e3*60)),J=Math.floor(F%(1e3*60)/1e3);return`${String(ae).padStart(2,"0")}:${String(z).padStart(2,"0")}:${String(J).padStart(2,"0")}`};const k=new Date(l);return t&&(t.style.visibility="hidden"),setTimeout(()=>{t&&(t.style.visibility="visible")},500),M&&clearInterval(M),M=setInterval(()=>{t&&(t.textContent=R())},1e3),R()}}return q(),Ke(async()=>{N.value===!0&&(V.value=null,oe("stop"),console.log("timerTaskIdFOLO",V.value)),a.value||V.value?(f.value=!0,console.log("timerData")):f.value=!1}),(l,t)=>{var J,se,_e,fe,ge,be,he;const k=je,R=Ye("router-link"),Y=Le,F=It,ae=et,z=Je("tooltip");return b(),C("div",At,[n(k,{position:"bottom-right",group:"br"}),n(R,{to:"/",class:"layout-topbar-logo"},{default:w(()=>[jt]),_:1}),e("button",{class:"p-link layout-menu-button layout-topbar-button",onClick:t[0]||(t[0]=D=>s(U)())},Bt),e("div",Mt,[e("button",{class:"nav-btn",onClick:t[1]||(t[1]=D=>m())},qt),e("button",{class:"nav-btn",onClick:t[2]||(t[2]=D=>m())},Ft)]),e("div",{class:ee(["layout-topbar-menu",I.value])},[e("button",{onClick:d,class:"p-link layout-topbar-button"},[(se=(J=s(c))==null?void 0:J.data)!=null&&se.image?ie((b(),C("div",zt,[e("div",Gt,[e("img",{src:`${(fe=(_e=s(c))==null?void 0:_e.data)==null?void 0:fe.image}`,class:"",style:{height:"100%",width:"100%","object-fit":"cover"}},null,8,Ht)])])),[[z,{value:"Profile"},void 0,{bottom:!0}]]):ie((b(),C("img",Wt,null,512)),[[z,{value:"Profile"},void 0,{bottom:!0}]]),Qt]),e("div",Zt,[y.value?(b(),C("div",Kt,Xt)):ne("",!0),e("button",{onClick:Z,class:"p-link layout-topbar-button notify-btn"},oo),o.value?(b(),C("div",ao,[n(Nt,{onCloseNotification:t[3]||(t[3]=D=>Q(D))})])):ne("",!0)]),f.value?ie((b(),Ce(Y,{key:0,to:{path:`/companies/${B.value}/spaces/${s(a)?(ge=s(a))==null?void 0:ge.space_id:K.value}/projects/${s(a)?(be=s(a))==null?void 0:be.project_id:p.value}`,query:{task_key:s(a)?(he=s(a))==null?void 0:he.task_id:V.value}},class:"flex absolute gap-2 align-items-center task-timer-wrapper mr-2"},{default:w(()=>{var D,ye;return[e("div",so,[e("div",{class:ee("clock-btn bg-pink-300"),onClick:t[4]||(t[4]=(...Ae)=>l.handleClickClock&&l.handleClickClock(...Ae))},io),e("div",no,Xe((D=s(a))!=null&&D.timerStartTime?oe((ye=s(a))==null?void 0:ye.timerStartTime):te.value?oe(te.value):" "),1)])]}),_:1},8,["to"])),[[z,{value:"Active Task"},void 0,{left:!0}]]):ne("",!0),e("button",{onClick:g,class:"p-link layout-topbar-button"},uo)],2),n(ae,{visible:r.value,"onUpdate:visible":t[5]||(t[5]=D=>r.value=D),modal:"",header:"Profile",style:{width:"65rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:w(()=>[n(F,{userProfile:s(c)},null,8,["userProfile"])]),_:1},8,["visible"])])}}},Fo=de(po,[["__scopeId","data-v-5d4501ed"]]);export{Fo as default};
