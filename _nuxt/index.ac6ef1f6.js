import{_ as ke}from"./nuxt-link.0476b490.js";import Ce from"./dropdown.esm.1d2f50e1.js";import je from"./calendar.esm.c507651f.js";import Te from"./button.esm.9bcce6f7.js";import Se from"./chart.esm.c6e80aac.js";import{_ as De}from"./CreateCompany.1b48a305.js";import{a2 as $e,a3 as U,$ as l,a5 as Le,aq as J,b as d,i as e,l as _,w as f,c as h,u,e as F,F as Ve,f as Ie,a as Me,o as i,t as g,s as Pe,k as Fe,K as Ne,a7 as Re,a8 as Ae,ca as Ee,am as Ue}from"./entry.6a4a7b34.js";import{u as Be,a as ze}from"./cookie.237ed71d.js";import{u as Oe}from"./layout.0025faa6.js";import{a as j}from"./usePermission.51bfa36c.js";import{u as K}from"./auth.1d693724.js";import{u as X}from"./company.fcb0b5dc.js";import{u as Q}from"./workCompany.70f60cd0.js";import"./baseicon.esm.29ae9fdb.js";import"./basecomponent.esm.b327fa8b.js";import"./index.esm.9a7d68f5.js";import"./index.esm.7ed96112.js";import"./index.esm.a9652cb0.js";import"./index.esm.766dca2c.js";import"./index.esm.9b06af06.js";import"./overlayeventbus.esm.02de36af.js";import"./portal.esm.ee5d6640.js";import"./virtualscroller.esm.f5aee3dc.js";import"./index.esm.7e790fc7.js";import"./index.esm.28221bc1.js";import"./index.esm.11d5bd9f.js";import"./badge.esm.319d03ef.js";import"./inputtext.esm.3e2a7394.js";import"./dialog.esm.25488016.js";const a=T=>(Re("data-v-cd76e50e"),T=T(),Ae(),T),He={class:"grid"},Ye={class:"col-12 lg:col-6 xl:col-3"},qe={class:"card mb-0"},Ge=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Company",-1)),Je={class:"text-900 font-medium text-xl"},Ke=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-microsoft text-blue-500 text-xl"})],-1)),Xe={class:"col-12 lg:col-6 xl:col-3"},Qe={class:"card mb-0"},We=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Employees",-1)),Ze={class:"text-900 font-medium text-xl",style:{visibility:"visible"}},et=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-purple-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user text-purple-500 text-xl"})],-1)),tt=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Employees"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),st=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-purple-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user text-purple-500 text-xl"})],-1)),lt={class:"col-12 lg:col-6 xl:col-3"},ot={class:"card mb-0"},at=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Roles",-1)),nt={class:"text-900 font-medium text-xl"},it=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-red-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user-edit text-red-500 text-xl"})],-1)),ct=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Roles"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),rt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-red-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user-edit text-red-500 text-xl"})],-1)),dt={class:"col-12 lg:col-6 xl:col-3"},ut={class:"card mb-0"},mt=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Tags",-1)),pt={class:"text-900 font-medium text-xl"},vt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-green-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-tags text-green-500 text-xl"})],-1)),_t=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Tags"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),ft=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-green-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-tags text-green-500 text-xl"})],-1)),ht={key:0,class:"col-12 xl:col-6"},gt={class:"card h-full"},xt={class:"flex gap-2 align-items-center flex-wrap",style:{padding:"10px"}},yt=a(()=>e("h5",{class:"mb-2"},"Tasks",-1)),bt={class:"flex gap-2 flex-wrap justify-content-end filter-container"},wt={class:"mb-2 relative w-full md:w-12rem"},kt={class:"task-container"},Ct={key:0,class:"flex justify-content-center align-items-center",style:{height:"22rem"}},jt=a(()=>e("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2.25rem"}},null,-1)),Tt=[jt],St={key:1},Dt=["onClick"],$t={class:"title-group"},Lt={class:"title line-clamp-1",style:{"font-weight":"600"}},Vt=a(()=>e("div",{style:{"background-color":"#00000040",height:"5px",width:"5px","border-radius":"15px"}},null,-1)),It={style:{"font-size":"12px"}},Mt={key:2},Pt=a(()=>e("p",{class:"text-black text-lg text-center"},"No Tasks found!",-1)),Ft=[Pt],Nt={class:"w-full flex justify-content-center"},Rt={class:"col-12 xl:col-6"},At={class:"card"},Et=a(()=>e("h5",null,"Overview",-1)),Ut={key:1},Bt={__name:"index",setup(T){Q();const{totalCompanies:B,totalProjects:W}=U(Q()),Z=Ee(),{getChartData:ee,getTaskAssignModalData:te,getRoles:se,getTagsAssignModalData:le}=X(),{chartProjectInfo:oe,chartTaskInfo:ae,chartClosedTaskInfo:ne,users:ie,rolesLists:z,tags:O}=U(X());K(),U(K());const ce=l(j("read_user")),re=l(j("read_role")),de=l(j("read_tags")),ue=l(j("read_task"));l(j("create_company"));const{isDarkTheme:me}=Oe();l(null);const pe=l({labels:oe,datasets:[{label:"Total Tasks",data:ae,fill:!1,backgroundColor:"#6366f1",borderColor:"#6366f1",tension:.4},{label:"Closed Tasks",data:ne,fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4}]}),x=l([]);l([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const N=l(null),S=l(!1),D=l(null),ve=()=>{var o;D.value=JSON.parse(localStorage.getItem("userCompany")),console.log("hasUserCompany =>",D.value),D.value===null||((o=D.value)==null?void 0:o.length)==0?S.value=!0:S.value=!1,console.log("visibleCreateCompany =>",S.value)};Le(()=>{se(),te(),le(),ee(),ve()});const _e=()=>{N.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"},title:{display:!0,text:"Projects"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"},title:{display:!0,text:"Numbers  of  Tasks"}}}}},fe=()=>{N.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}},r=l(),H=l(),Y=l(),v=l(),$=l(!1),R=l(!1);J(r,o=>{var t,n;H.value=[{name:"All",id:""},...((n=(t=r.value)==null?void 0:t.statuses)==null?void 0:n.map(c=>({name:c.name,id:c.id})))||[]]});const w=l(),L=l(),V=l(),I=l(),q=l(1);let m=l(1);const y=async()=>{L.value=r.value?r.value.id:"",V.value=w.value?w.value.id:"",I.value=v.value,E?m.value++:m.value=1,q.value=m.value,M.value=0,A(L.value,V.value,I.value,q.value),E=!1},he=o=>{$.value=!0;const t=new Date(o);v.value=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),y()},ge=()=>{$.value=!1,v.value="",I.value="",y()},xe=()=>{if(r.value||Y.value||v.value||m.value>1)r.value="",Y.value="",v.value="",L.value="",V.value="",w.value="",$.value=!1,y();else return},ye=async o=>{const t=localStorage.getItem("userCompany");console.log("Task click: ",o),await Ue({path:`/companies/${t}/spaces/${o==null?void 0:o.space_id}/projects/${o==null?void 0:o.project_id}`,query:{task_key:o.id}})},be=o=>{const t=o,n=new Date(t),c=n.getFullYear(),P=String(n.getMonth()+1).padStart(2,"0");return`${String(n.getDate()).padStart(2,"0")}-${P}-${c}`},M=l(0),k=l(!1),we=async()=>{k.value=!0,m.value++,await A(L.value,V.value,I.value,m.value)},A=async(o="",t="",n="",c=1)=>{var b;R.value=!0,console.log("status",t);try{const C=Be("token"),{data:p,pending:G,error:s}=await ze(`${Z.public.apiUrl}/tasks/list?due_date=${n}&status=${t}&project_id=${o}&limit=15&page=${c}`,{method:"GET",headers:{Authorization:`Bearer ${C.value}`}},"$PslAyef5YX");p.value&&p.value.data&&((b=p.value.counts)!=null&&b.total_tasks)?(M.value=Math.ceil(p.value.counts.total_tasks/15),x.value=c===1?p.value.data:[...x.value,...p.value.data],k.value=!1):(x.value=[],k.value=!1),console.log("Task list: ",x.value)}catch(C){console.log(C),k.value=!1}finally{R.value=!1}};let E=!1;return window.addEventListener("scroll",()=>{const{scrollTop:o,scrollHeight:t,clientHeight:n}=document.documentElement;o+n>=t-50&&m.value<M&&(E=!0,y())}),A(),J(me,o=>{o?fe():_e()},{immediate:!0}),(o,t)=>{const n=ke,c=Ce,P=je,b=Te,C=Se,p=De,G=Me("tooltip");return i(),d("div",He,[e("div",Ye,[e("div",qe,[_(n,{to:"/companies",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[Ge,e("div",Je,g(u(B)?u(B):"0"),1)]),Ke]),_:1})])]),e("div",Xe,[e("div",Qe,[ce.value?(i(),h(n,{key:0,to:"/employees",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[We,e("div",Ze,g(u(ie).length),1)]),et]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:f(()=>[tt,st]),_:1}))])]),e("div",lt,[e("div",ot,[re.value?(i(),h(n,{key:0,to:"/roles",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[at,e("div",nt,g(u(z)?u(z).length:"0"),1)]),it]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:f(()=>[ct,rt]),_:1}))])]),e("div",dt,[e("div",ut,[de.value?(i(),h(n,{key:0,to:"/tags",class:"flex justify-content-between mb-3"},{default:f(()=>[e("div",null,[mt,e("div",pt,g(u(O)?u(O).length:"0"),1)]),vt]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:f(()=>[_t,ft]),_:1}))])]),ue.value?(i(),d("div",ht,[e("div",gt,[e("div",xt,[yt,e("div",bt,[_(c,{onChange:t[0]||(t[0]=s=>y()),modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),options:u(W),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options"]),_(c,{onChange:t[2]||(t[2]=s=>y()),modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=s=>w.value=s),options:H.value,disabled:!r.value,optionLabel:"name",placeholder:"Select Status",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options","disabled"]),e("div",wt,[_(P,{onDateSelect:t[4]||(t[4]=s=>he(s)),modelValue:v.value,"onUpdate:modelValue":t[5]||(t[5]=s=>v.value=s),placeholder:"Select Date",class:"w-full md:w-12rem"},null,8,["modelValue"]),$.value?(i(),d("p",{key:0,onClick:ge,class:"pi pi-times end-cross absolute cursor-pointer"})):F("",!0)]),_(b,{onClick:xe,label:"Reset",class:"mb-2",severity:"secondary"})])]),e("div",kt,[R.value?(i(),d("div",Ct,Tt)):x.value.length>0?(i(),d("div",St,[(i(!0),d(Ve,null,Ie(x.value,s=>(i(),d("div",{key:s.id,onClick:()=>ye(s),class:"task-card"},[e("div",$t,[Pe(e("div",{class:Fe("status"),style:Ne(`background-color: ${s==null?void 0:s.status_color};`)},null,4),[[G,{value:`Status: ${s.status_name}`},void 0,{left:!0}]]),e("p",Lt,g(s==null?void 0:s.name),1),Vt,e("p",null,g(s==null?void 0:s.project_name),1)]),e("div",null,[e("p",It,"Due: "+g(s.due_date?be(s==null?void 0:s.due_date):"Not Set"),1)])],8,Dt))),128))])):(i(),d("div",Mt,Ft)),e("div",Nt,[u(m)<M.value?(i(),h(b,{key:0,onClick:we,loading:k.value,label:"Load More",severity:"secondary"},null,8,["loading"])):F("",!0)])])])])):F("",!0),e("div",Rt,[e("div",At,[Et,_(C,{type:"line",data:pe.value,options:N.value},null,8,["data","options"])])]),S.value?(i(),d("div",Ut,[_(p)])):F("",!0)])}}},hs=$e(Bt,[["__scopeId","data-v-cd76e50e"]]);export{hs as default};
