import fe from"./toast.esm.ee02b1a3.js";import{_ as ge}from"./nuxt-link.11a55c3a.js";import{_ as he}from"./CreateSpecificProject.5eaa0791.js";import xe from"./inputicon.esm.7794967a.js";import de from"./inputtext.esm.979e8ed5.js";import ye from"./iconfield.esm.56213654.js";import ue from"./button.esm.0c0e41ab.js";import be from"./textarea.esm.155a978c.js";import ke from"./inputgroupaddon.esm.860e4098.js";import Se from"./inputgroup.esm.c341cf47.js";import we from"./dropdown.esm.c7add2ac.js";import{d as $e}from"./vuedraggable.umd.8766261f.js";import{a3 as pe,a4 as me,$ as l,V as oe,aq as ne,a5 as je,a as _e,o as m,b as $,u as e,i as o,q as P,t as R,l as s,a6 as x,w as u,s as O,e as y,K as Ce,a9 as Pe,aa as Ve,ab as Ee,c as L,P as Ne}from"./entry.2b6fb92b.js";import{u as G}from"./company.2c91a5dd.js";import re from"./colorpicker.esm.1facae59.js";import"./inputswitch.esm.a9d7c9dc.js";import ce from"./dialog.esm.29f0385b.js";import{a as se}from"./usePermission.5c6c5014.js";import J from"./column.esm.c9e966dc.js";import Te from"./datatable.esm.46ed38fd.js";import"./portal.esm.339b6610.js";import"./basecomponent.esm.1dc5bcc6.js";import"./index.esm.22f6d65d.js";import"./baseicon.esm.1c2288ea.js";import"./index.esm.d116c377.js";import"./index.esm.9cec1693.js";import"./index.esm.caeab568.js";import"./cookie.42781a0d.js";import"./workCompany.21ad5351.js";import"./badge.esm.8a0616f1.js";import"./index.esm.334ffc76.js";import"./index.esm.d5cde48d.js";import"./index.esm.06a63c30.js";import"./overlayeventbus.esm.00afcc56.js";import"./virtualscroller.esm.439cf5ad.js";import"./paginator.esm.a6e6667d.js";import"./index.esm.337d6a58.js";import"./inputnumber.esm.18caa7a8.js";import"./index.esm.1dd864b0.js";import"./index.esm.83617828.js";import"./index.esm.88f44f92.js";import"./index.esm.b743062e.js";import"./index.esm.320769a0.js";import"./checkbox.esm.222af4f6.js";import"./radiobutton.esm.1daed2ce.js";import"./index.esm.7e4c8217.js";import"./index.esm.34f6efd9.js";const De={class:"position-relative d-flex flex-column justify-content-between w-100 modal-container"},Ue={key:0},Ie={class:"field"},Le={for:"name"},Oe={class:"field flex flex-column"},Me=o("label",{for:"name"},[P("Project Name"),o("i",{class:"text-red-400 text-italic"},"*")],-1),Be={class:"field flex flex-column"},Fe=o("label",{for:"name"},"Project Description",-1),Ke={class:"mb-4"},qe=o("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[P("Setup Task Status"),o("i",{class:"text-red-400 text-italic"},"*")],-1),Ae={class:"container"},Je=o("p",{class:"pi pi-plus cursor-pointer"},null,-1),Re={key:0,class:"text-red-600 text-small"},Ge={class:"row mt-2"},He={class:"col-12 d-flex flex-column p-0"},We=["onMouseenter"],ze={style:{"margin-right":"-3px"},width:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",class:"cu-status-manager-status-list-item__drag-handler-icon"},Xe=o("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},[o("circle",{cx:"5",cy:"5",r:"1"}),o("circle",{cx:"5",cy:"12",r:"1"}),o("circle",{cx:"5",cy:"19",r:"1"}),o("circle",{cx:"12",cy:"5",r:"1"}),o("circle",{cx:"12",cy:"12",r:"1"}),o("circle",{cx:"12",cy:"19",r:"1"})],-1),Ye=[Xe],Qe={class:"flex align-items-center",style:{width:"88%"}},Ze=["onClick"],et=o("p",{class:"pi pi-times"},null,-1),tt=[et],ot={class:"mb-3"},st=o("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[P("Set Task Close Status"),o("i",{class:"text-red-400 text-italic"},"*")],-1),lt={class:"container"},at={class:"field"},it={key:0,class:"text-red-600 text-small"},nt={key:0,class:"text-center",style:{color:"red"}},rt={class:"float-right"},ct={__name:"EditProject",props:["refProjectId","singleSpace"],emits:["closeEditProject"],setup(H,{emit:W}){const{editProject:z}=G(),{isProjectEdited:v}=pe(G()),M=me(),{refProjectId:n,singleSpace:le}=H,U=W,B=l(!0),f=l(!1),F=l(!0),I=l(!1),j=l(null),b=l(!0),X=oe(()=>({animation:250,group:"tasks",disabled:!b.value,ghostClass:"ghost"})),k=oe(()=>({backgroundColor:"#fff",boxShadow:"0px 2px 2px #e2e2e2",cursor:"grab",margin:"8px 0px"})),Y=oe(()=>({backgroundColor:"#f9f9f9",boxShadow:"0px 4px 4px #e2e2e3",cursor:"grab",margin:"8px 0px"})),g=l(""),S=l(n==null?void 0:n.statuses.map((a,t)=>({...a,serial_no:t+1}))),r=l([]);r.value=JSON.parse(JSON.stringify(S.value));const V=l("6466f1"),K=l(null),_=l(!1),d=l(n==null?void 0:n.name),E=l(n==null?void 0:n.description),N=()=>{var a;if(g.value?_.value=!1:_.value=!0,((a=g==null?void 0:g.value)==null?void 0:a.length)>0){const t={name:g.value,color_code:`#${V.value}`,is_closed_status:0,serial_no:r.value.length+1};r.value.push(t),g.value=""}else _.value=!0;r.value.length>0&&(K.value=!0)},Q=a=>{var t,p;r.value.splice(a,1),((t=h.value)==null?void 0:t.is_closed_status)===((p=r.value[a])==null?void 0:p.is_closed_status)&&(h.value=null),r.value.length==0&&(K.value=!1)},h=l(null);h.value=r.value.find(a=>a.is_closed_status===1),ne(h,a=>{a&&r.value.forEach(t=>{t.is_closed_status=t.name===a.name?1:0})}),ne(r,a=>{a.forEach((t,p)=>{t.serial_no=p+1})});const Z=a=>a.map(t=>({taskStatusName:t.name,taskStatusColor:t.color_code.startsWith("#")?t.color_code:`#${t.color_code}`,is_closed_status:t.is_closed_status,serial_no:t.serial_no})),C=l(!1),w=async()=>{if(C.value=!0,d.value===null||r.value.length<=0||!h.value)f.value=!0,C.value=!1;else{f.value=!1,r.value.forEach(i=>{const T=["color_code","name","is_closed_status","serial_no"];Object.keys(i).forEach(q=>{T.includes(q)||delete i[q]})});const a=JSON.parse(JSON.stringify(r.value)),t=Z(a);console.log("shallow List",a),console.log("transformedTaskStatusList",t);const p={id:n==null?void 0:n.id,name:d.value,description:E.value,space_id:n==null?void 0:n.space_id,statuses:t};await z(p),v.value===!0?(U("closeEditProject",!1),C.value=!1,M.add({severity:"success",summary:"Project creation",detail:"Project updated successfully!",group:"br",life:3e3})):(C.value=!1,M.add({severity:"error",summary:"Project creation",detail:"Failed to update project!",group:"br",life:3e3}))}},ee=()=>{U("closeEditProject",!1)};return je(()=>{S.value=n==null?void 0:n.statuses}),(a,t)=>{var ie;const p=de,i=be,T=ke,q=Se,ve=we,ae=ue,A=_e("tooltip");return m(),$("div",De,[e(B)?(m(),$("div",Ue,[o("div",Ie,[o("label",Le,[P("Project: "),o("strong",null,R((ie=H.refProjectId)==null?void 0:ie.name),1)])]),o("div",Oe,[Me,s(p,{id:"name",modelValue:e(d),"onUpdate:modelValue":t[0]||(t[0]=c=>x(d)?d.value=c:null),required:"true"},null,8,["modelValue"])]),o("div",Be,[Fe,s(i,{id:"description",class:"border-gray-300",modelValue:e(E),"onUpdate:modelValue":t[1]||(t[1]=c=>x(E)?E.value=c:null),rows:"3",cols:"20"},null,8,["modelValue"])]),o("div",Ke,[qe,o("div",Ae,[s(q,null,{default:u(()=>[s(T,null,{default:u(()=>[O(s(e(re),{class:"color-pick",style:{width:"1.5rem"},modelValue:e(V),"onUpdate:modelValue":t[2]||(t[2]=c=>x(V)?V.value=c:null),inputId:"cp-hex",format:"hex"},null,8,["modelValue"]),[[A,{value:"Pick Color"},void 0,{left:!0}]])]),_:1}),O(s(p,{class:"form-control",modelValue:e(g),"onUpdate:modelValue":t[3]||(t[3]=c=>x(g)?g.value=c:null),placeholder:"e.g., TO-DO, DOING"},null,8,["modelValue"]),[[A,{value:"Type Status Name"},void 0,{top:!0}]]),s(T,{onClick:N,class:"btn btn-outline-secondary cursor-pointer"},{default:u(()=>[Je]),_:1})]),_:1}),e(_)?(m(),$("p",Re," Please type status name! ")):y("",!0),o("div",Ge,[o("div",He,[s(e($e),{modelValue:e(r),"onUpdate:modelValue":t[5]||(t[5]=c=>x(r)?r.value=c:null),options:e(X),disabled:!e(F),class:"list-group","ghost-class":"ghost",move:a.checkMove,onStart:t[6]||(t[6]=c=>I.value=!0),onEnd:t[7]||(t[7]=c=>I.value=!1)},{item:u(({element:c,index:te})=>[(m(),$("div",{class:"flex delete-task justify-content-between",style:Ce(e(j)===te?e(Y):e(k)),onMouseenter:D=>j.value=te,onMouseleave:t[4]||(t[4]=D=>j.value=null),key:c.id},[(m(),$("svg",ze,Ye)),o("div",Qe,[O(s(e(re),{class:"color-pick mr-2 status-colors border-none",modelValue:c.color_code,"onUpdate:modelValue":D=>c.color_code=D,inputId:"cp-hex",format:"hex"},null,8,["modelValue","onUpdate:modelValue"]),[[A,{value:"Change Color"},void 0,{left:!0}]]),O(s(p,{class:"text-uppercase text-muteds w-full",modelValue:c.name,"onUpdate:modelValue":D=>c.name=D,required:"true"},null,8,["modelValue","onUpdate:modelValue"]),[[A,{value:"Change Status Name"},void 0,{right:!0}]])]),o("div",{onClick:D=>Q(te),class:"cursor-pointer cross-icon ms-1 flex justify-content-center align-items-center"},tt,8,Ze)],44,We))]),_:1},8,["modelValue","options","disabled","move"])])])])]),o("div",ot,[st,o("div",lt,[o("div",at,[s(ve,{modelValue:e(h),"onUpdate:modelValue":t[8]||(t[8]=c=>x(h)?h.value=c:null),options:e(r),optionLabel:"name",placeholder:"Select Status",class:"w-full"},null,8,["modelValue","options"])]),a.closeStatusError?(m(),$("p",it," Please set close status! ")):y("",!0)])]),e(f)?(m(),$("p",nt," Please add/fill/check up all the fields")):y("",!0)])):y("",!0),o("div",rt,[s(ae,{label:"Cancel",icon:"pi pi-times",text:"",onClick:ee}),s(ae,{loading:e(C),label:"Save",icon:"pi pi-check",text:"",onClick:w},null,8,["loading"])])])}}};const dt={class:"card"},ut={class:"d-flex create-space-btn-wrapper mb-3"},pt={class:"breadCrumWrap"},mt=o("p",{class:"pi pi-angle-right"},null,-1),_t=o("p",{class:"pi pi-angle-right responsive-text"},null,-1),vt=o("p",{class:"pi pi-angle-right responsive-text"},null,-1),ft={class:"text cursor-pointer responsive-text"},gt={class:"create-btn-wrapper"},ht={class:"flex justify-content-end mb-2"},xt=o("i",{class:"pi pi-search"},null,-1),yt=o("p",{class:"py-2 text-center"},"No Data found...",-1),bt={class:"cursor-pointer proj-name hover:text-primary font-semibold"},kt=o("p",null,"Are you sure you want to delete?",-1),go={__name:"index",setup(H){const{getSingleSpace:W,deleteProject:z}=G(),{singleSpace:v,singleSpaceProjects:M,isProjectDeleted:n}=pe(G()),le=l(se("create_project")),U=l(se("update_project")),B=l(se("delete_project")),f=l(),F=l(!0),I=me(),{spaces:j}=Pe().params;if(l(!1),v.value===void 0)throw Ve({statusCode:404,message:"Space not found",fatal:!0});const b=l(null),X=_=>{b.value=_,console.log("refCompanyId",b.value),k.value=!0},k=l(!1),Y=async()=>{console.log("refCompanyIdFin",b.value),await z(b.value,j),n.value===!0?(I.add({severity:"success",summary:"Successful",detail:"Space Deleted Successfully",group:"br",life:3e3}),k.value=!1,console.log("space deleted")):(I.add({severity:"error",summary:"Error",detail:"Unable to delete space",group:"br",life:3e3}),console.log("space not deleted"))};Ee(()=>{W(j),F.value=!1}),(()=>{f.value={global:{value:null,matchMode:Ne.CONTAINS}}})();const S=l(!1),r=_=>{S.value=!0,b.value=_},V=_=>{S.value=_},K=l(!0);return(_,d)=>{var t,p;const E=fe,N=ge,Q=he,h=xe,Z=de,C=ye,w=ue,ee=ct,a=_e("tooltip");return m(),$("div",dt,[s(E,{position:"bottom-right",group:"br"}),o("div",ut,[o("div",pt,[s(N,{to:"/",class:"text pi pi-home responsive-text"}),mt,s(N,{to:"/companies",class:"text"},{default:u(()=>[P("Companies")]),_:1}),_t,s(N,{class:"text responsive-text",to:`/companies/${(t=e(v))==null?void 0:t.company_id}`},{default:u(()=>{var i;return[P(" Company - "+R((i=e(v))==null?void 0:i.company_name),1)]}),_:1},8,["to"]),vt,o("p",ft,"Space - "+R((p=e(v))==null?void 0:p.name),1)]),o("div",gt,[e(le)?O((m(),L(Q,{key:0,singleSpace:e(v),spaces:e(j),isPage:e(K)},null,8,["singleSpace","spaces","isPage"])),[[a,{value:"Create Project"},void 0,{left:!0}]]):y("",!0)])]),o("div",ht,[s(C,{iconPosition:"right"},{default:u(()=>[s(h,null,{default:u(()=>[xt]),_:1}),s(Z,{modelValue:e(f).global.value,"onUpdate:modelValue":d[0]||(d[0]=i=>e(f).global.value=i),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),s(e(Te),{filters:e(f),"onUpdate:filters":d[1]||(d[1]=i=>x(f)?f.value=i:null),class:"table-dsp",value:e(M),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:10,dataKey:"id",filterDisplay:"menu",loading:e(F)},{empty:u(()=>[yt]),loading:u(()=>[P(" Loading data. Please wait. ")]),default:u(()=>[s(e(J),{field:"index",header:"Serial",sortable:""}),s(e(J),{field:"name",header:"Project Name"},{body:u(i=>[s(N,{to:`/companies/${e(v).company_id}/spaces/${e(v).id}/projects/${i.data.id}`},{default:u(()=>[o("p",bt,R(i.data.name),1)]),_:2},1032,["to"])]),_:1}),s(e(J),{field:"space_name",header:"Under the Space of"}),s(e(J),{header:"Action"},{body:u(i=>[e(U)?(m(),L(w,{key:0,icon:"pi pi-pencil",text:"",class:"",severity:"success",rounded:"",onClick:T=>r(i.data)},null,8,["onClick"])):y("",!0),e(B)?(m(),L(w,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:T=>X(i.data.id)},null,8,["onClick"])):y("",!0),e(U)?y("",!0):(m(),L(w,{key:2,icon:"pi pi-pencil",text:"",class:"",severity:"success",style:{visibility:"hidden"}})),e(B)?y("",!0):(m(),L(w,{key:3,icon:"pi pi-trash",text:"",class:"",severity:"warning",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(ce),{visible:e(k),"onUpdate:visible":d[3]||(d[3]=i=>x(k)?k.value=i:null),header:" ",style:{width:"25rem"}},{default:u(()=>[kt,s(w,{label:"No",icon:"pi pi-times",text:"",onClick:d[2]||(d[2]=i=>k.value=!1)}),s(w,{label:"Yes",icon:"pi pi-check",text:"",onClick:Y})]),_:1},8,["visible"]),s(e(ce),{visible:e(S),"onUpdate:visible":d[5]||(d[5]=i=>x(S)?S.value=i:null),modal:"",header:"Edit Project",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(ee,{refProjectId:e(b),singleSpace:e(v),onCloseEditProject:d[4]||(d[4]=i=>V(i))},null,8,["refProjectId","singleSpace"])]),_:1},8,["visible"])])}}};export{go as default};
