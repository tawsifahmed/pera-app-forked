import ae from"./toast.esm.8e0c7f26.js";import H from"./button.esm.e846d103.js";import ie from"./inputicon.esm.0da03ef4.js";import q from"./inputtext.esm.2f4ebd3b.js";import re from"./iconfield.esm.af7b77fd.js";import ne from"./toolbar.esm.54b5bb07.js";import de from"./progressspinner.esm.da7a175e.js";import Q from"./multiselect.esm.d9a634cf.js";import{a4 as j,$ as t,a5 as K,a6 as W,o as f,b as L,i as l,l as s,u as e,a7 as N,e as T,q as O,ca as X,a2 as ce,a8 as pe,a9 as me,w as u,P as ue,c as D,F as _e,f as ve,t as fe}from"./entry.f1083d62.js";import{u as Z}from"./fetch.10fa1737.js";import{u as A,a as G}from"./cookie.9dea65c9.js";import I from"./column.esm.347a1d2a.js";import ye from"./datatable.esm.549750af.js";import{a as z}from"./usePermission.0e59467d.js";import J from"./dialog.esm.47d02448.js";import"./portal.esm.a12ffff4.js";import"./basecomponent.esm.dd1da9c1.js";import"./index.esm.0a9206fc.js";import"./baseicon.esm.9dc16ba1.js";import"./index.esm.1d6733e5.js";import"./index.esm.1c5b7344.js";import"./index.esm.6a9442c3.js";import"./badge.esm.06f68ce4.js";import"./index.esm.0cabc4e6.js";import"./checkbox.esm.f06bbf32.js";import"./index.esm.25dde301.js";import"./index.esm.dadcf415.js";import"./overlayeventbus.esm.0f70953e.js";import"./virtualscroller.esm.8b3bbffe.js";import"./paginator.esm.48f6f07f.js";import"./index.esm.59d7ab85.js";import"./dropdown.esm.4e9c9472.js";import"./inputnumber.esm.bd15fd88.js";import"./index.esm.db20bc22.js";import"./index.esm.262c264f.js";import"./index.esm.f2124f4a.js";import"./index.esm.18ac01f2.js";import"./index.esm.26a78852.js";import"./radiobutton.esm.6dce7c4d.js";import"./index.esm.8aab8f7c.js";import"./index.esm.d83addac.js";const be={class:"field"},he=l("label",{for:"company"},[O("Role Name"),l("i",{class:"text-red-400 text-italic"},"*")],-1),xe={class:"field permission_selection"},$e=l("label",null,[O("Permissions"),l("i",{class:"text-red-400 text-italic"},"*")],-1),ge={key:0,style:{color:"red"}},Re={class:"create-btn-wrapper mb-0"},ke={__name:"CreateRole",props:{param:{type:Object,required:!0}},emits:["closeCreateModal"],setup(h,{emit:E}){const M=X(),x=h,$=j(),i=t(""),_=t(x.param.permissionsList),c=t([]),r=t(!1),y=t(!0),v=E,C=async()=>{var m;if(i.value===""){r.value=!0;return}else if(r.value=!1,!r.value){const a=A("token"),{data:p,pending:g}=await Z(`${M.public.apiUrl}/roles/create`,{method:"POST",headers:{Authorization:`Bearer ${a.value}`},body:{name:i.value,permissions:c.value.map(R=>R.id)}},"$lLTkTCcXoV");((m=p.value)==null?void 0:m.code)===201?(i.value=null,y.value=!1,v("closeCreateModal",!1),$.add({severity:"success",summary:"Success",detail:"Role Created successfully!",group:"br",life:3e3})):$.add({severity:"error",summary:"Error",detail:"Role Creation Failed!",group:"br",life:3e3})}};return K(()=>{const m=document.getElementById("createRoleName");W(()=>{m&&m.focus()})}),(m,a)=>{const p=q,g=Q,R=H;return f(),L("div",null,[l("div",be,[he,s(p,{id:"createRoleName",modelValue:e(i),"onUpdate:modelValue":a[0]||(a[0]=b=>N(i)?i.value=b:null),class:"w-full",placeholder:"Enter role name"},null,8,["modelValue"])]),l("div",xe,[$e,s(g,{display:"chip",modelValue:e(c),"onUpdate:modelValue":a[1]||(a[1]=b=>N(c)?c.value=b:null),options:e(_),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(r)?(f(),L("p",ge,"Please enter role name")):T("",!0),l("div",Re,[s(R,{label:"Save",icon:"pi pi-check",text:"",onClick:C})])])}}};const ee=h=>(pe("data-v-ae8a0175"),h=h(),me(),h),we={class:"field"},Ce=ee(()=>l("label",{for:"company"},[O("Role Name"),l("i",{class:"text-red-400 text-italic"},"*")],-1)),Se={class:"field permission_selection"},Pe=ee(()=>l("label",null,[O("Permissions"),l("i",{class:"text-red-400 text-italic"},"*")],-1)),Ve={key:0,style:{color:"red"}},Le={class:"create-btn-wrappe"},Ne={__name:"EditRole",props:{param:{type:Object,required:!0}},emits:["closeEditModal"],setup(h,{emit:E}){const M=X(),x=h,$=j(),i=t(x.param.id),_=t(x.param.name),c=t(x.param.permissionsList),r=t(x.param.slctdPermissions),y=t(!1),v=t(!0),C=E,m=async()=>{var a;if(_.value===""){y.value=!0;return}else if(y.value=!1,!y.value){const p=A("token"),{data:g,pending:R}=await Z(`${M.public.apiUrl}/roles/update/${i.value}`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:{name:_.value,permissions:r.value.map(b=>b.id)}},"$AftFLbfnYe");((a=g.value)==null?void 0:a.code)===200?(v.value=!1,C("closeEditModal",!1),$.add({severity:"success",summary:"Success",detail:"Role updated successfully!",group:"br",life:3e3})):$.add({severity:"error",summary:"Error",detail:"Failed to update role!",group:"br",life:3e3})}};return K(async()=>{const a=document.getElementById("editTeamName");W(()=>{a&&a.focus()})}),(a,p)=>{const g=q,R=Q,b=H;return f(),L("div",null,[l("div",we,[Ce,s(g,{id:"editTeamName",modelValue:e(_),"onUpdate:modelValue":p[0]||(p[0]=k=>N(_)?_.value=k:null),class:"w-full",placeholder:"Edit role name"},null,8,["modelValue"])]),l("div",Se,[Pe,s(R,{display:"chip",modelValue:e(r),"onUpdate:modelValue":p[1]||(p[1]=k=>N(r)?r.value=k:null),options:e(c),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(y)?(f(),L("p",Ve,"Please enter tag name")):T("",!0),l("div",Le,[s(b,{label:"Update",icon:"pi pi-check",text:"",onClick:m})])])}}},Ee=ce(Ne,[["__scopeId","data-v-ae8a0175"]]);const Te={key:0,class:"card"},Me=l("div",{class:"d-flex mr-2"},[l("h5",{class:"mb-1"},"User Role")],-1),Ue=l("i",{class:"pi pi-search"},null,-1),Be=l("p",{class:"text-center"},"No Data found...",-1),Fe={style:{display:"flex","flex-wrap":"wrap",gap:"5px"}},wt={__name:"index",setup(h){const E=X(),M=t(z("read_role")),x=t(z("create_role")),$=t(z("update_role")),i=t(),_=t(!0);j();const c=t(!1),r=t(!1),y=t([]),v=t([]),C=t([]),m=t(""),a=t(""),p=d=>{c.value=!1,k()},g=d=>{r.value=!1,k()},R=()=>{c.value=!0,k()},b=d=>{var o;r.value=!0,m.value=d.id,a.value=d.name,v.value=v.value,C.value=[],((o=d==null?void 0:d.permissions)==null?void 0:o.length)>0&&d.permissions.map(U=>{v.value.map(w=>{U.id===w.id&&C.value.push(w)})})},k=async()=>{var S,P,V;const d=A("token"),{data:o,pending:U,error:w}=await G("roleList",()=>$fetch(`${E.public.apiUrl}/roles/list`,{headers:{Authorization:`Bearer ${d.value}`}}));((P=(S=o.value)==null?void 0:S.data)==null?void 0:P.length)>0&&(y.value=(V=o.value)==null?void 0:V.data.map((B,F)=>({...B,index:F+1})))},te=async()=>{var S,P,V;const d=A("token"),{data:o,pending:U,error:w}=await G("permissionList",()=>$fetch(`${E.public.apiUrl}/permissions/list`,{headers:{Authorization:`Bearer ${d.value}`}}));((P=(S=o.value)==null?void 0:S.data)==null?void 0:P.length)>0&&(v.value=(V=o.value)==null?void 0:V.data.map((B,F)=>({...B,index:F+1})))},oe=()=>{i.value={global:{value:null,matchMode:ue.CONTAINS}}};return K(()=>{k(),te(),_.value=!1}),oe(),(d,o)=>{const U=ae,w=H,S=ie,P=q,V=re,B=ne,F=de,se=ke,le=Ee;return e(M)?(f(),L("div",Te,[s(U,{position:"bottom-right",group:"br"}),Me,s(B,{class:"border-0 px-0"},{start:u(()=>[e(x)?(f(),D(w,{key:0,icon:"pi pi-plus",label:"Create",onClick:R,class:"mr-2",severity:"secondary"})):T("",!0)]),end:u(()=>[s(V,{iconPosition:"right",raised:""},{default:u(()=>[s(S,null,{default:u(()=>[Ue]),_:1}),s(P,{modelValue:e(i).global.value,"onUpdate:modelValue":o[0]||(o[0]=n=>e(i).global.value=n),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),_:1}),s(e(ye),{filters:e(i),"onUpdate:filters":o[1]||(o[1]=n=>N(i)?i.value=n:null),class:"table-stR",value:e(y),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:e(_)},{empty:u(()=>[Be]),loading:u(()=>[s(F,{style:{width:"50px",height:"50px"}})]),default:u(()=>[s(e(I),{field:"index",header:"Serial",sortable:""}),s(e(I),{style:{"text-wrap":"nowrap"},field:"name",header:"Role Name"}),s(e(I),{field:"permissions",header:"Permission"},{body:u(n=>[l("div",Fe,[(f(!0),L(_e,null,ve(n.data.permissions,Y=>(f(),L("div",{class:"border rounded",key:d.permission,style:{border:"1px solid rgba(167, 167, 167, 0.486)","border-radius":"5px",padding:"2px 5px"}},[l("p",null,fe(Y.name),1)]))),128))])]),_:1}),s(e(I),{field:"action",header:"Action"},{body:u(n=>[e($)?(f(),D(w,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:Y=>b(n.data)},null,8,["onClick"])):T("",!0),e($)?T("",!0):(f(),D(w,{key:1,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(J),{visible:e(c),"onUpdate:visible":o[3]||(o[3]=n=>N(c)?c.value=n:null),modal:"",header:"Create Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(se,{param:{permissionsList:e(v)},onCloseCreateModal:o[2]||(o[2]=n=>p(n))},null,8,["param"])]),_:1},8,["visible"]),s(e(J),{visible:e(r),"onUpdate:visible":o[5]||(o[5]=n=>N(r)?r.value=n:null),modal:"",header:"Edit Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(le,{param:{id:e(m),name:e(a),permissionsList:e(v),slctdPermissions:e(C)},onCloseEditModal:o[4]||(o[4]=n=>g(n))},null,8,["param"])]),_:1},8,["visible"])])):T("",!0)}}};export{wt as default};
