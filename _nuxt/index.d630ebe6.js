import Y from"./toast.esm.ef8cdcd7.js";import J from"./multiselect.esm.aa936d27.js";import K from"./calendar.esm.b28ea8e1.js";import Q from"./button.esm.a55c2431.js";import X from"./toolbar.esm.473997f4.js";import Z from"./column.esm.6208f1b7.js";import ee from"./datatable.esm.3837e306.js";import te from"./tabpanel.esm.abefec25.js";import ae from"./tabview.esm.354b8422.js";import{ao as oe,a2 as le,$ as b,a3 as se,a4 as ne,al as ie,V as re,b as G,l as e,w as v,o as I,i as t,u as n,a5 as F,c as R,e as B,q as de,t as ce,ap as ue,aq as pe,a6 as me}from"./entry.570ab878.js";import{u as W}from"./fetch.11b9759f.js";import{u as O}from"./cookie.3ed14f9e.js";import{u as fe}from"./workCompany.886927d5.js";import"./radiobutton.esm.b232767f.js";import"./portal.esm.1e4af6e4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./baseicon.esm.c7f0dea4.js";import"./index.esm.2547ec1e.js";import"./index.esm.c6f3b761.js";import"./index.esm.417f68ee.js";import"./checkbox.esm.1ad534d4.js";import"./index.esm.d468d720.js";import"./index.esm.2cce7489.js";import"./index.esm.b72e702d.js";import"./overlayeventbus.esm.c91907e9.js";import"./virtualscroller.esm.84c3372a.js";import"./index.esm.7c91399e.js";import"./index.esm.b806f7cb.js";import"./index.esm.e138fc7f.js";import"./badge.esm.54d3e6c5.js";import"./paginator.esm.23dce669.js";import"./index.esm.c592065e.js";import"./dropdown.esm.4fa36b0b.js";import"./inputnumber.esm.9d737ca0.js";import"./index.esm.bb3da758.js";import"./index.esm.e450f24c.js";import"./inputtext.esm.5cd40da3.js";import"./index.esm.f3846021.js";import"./index.esm.feb1baca.js";import"./index.esm.a8b59750.js";import"./index.esm.ecdc2543.js";const r=C=>(ue("data-v-434cfc36"),C=C(),pe(),C),_e={class:"card"},ve=r(()=>t("div",{class:"d-flex mr-2"},[t("h5",{class:"mb-1"},"Project Reports")],-1)),he={class:"card"},be={class:"flex gap-2 flex-wrap align-items-center"},ge={class:"user-selection w-full md:w-14rem w-full"},ye=r(()=>t("label",{class:"font-bold block mb-2"},"Spaces:",-1)),we={class:"flex justify-content-center"},De={class:"user-selection w-full md:w-14rem w-full"},Se=r(()=>t("label",{class:"font-bold block mb-2"},"Projects:",-1)),$e={class:"flex justify-content-center"},je={class:"flex-auto"},xe=r(()=>t("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),ke={class:"flex-auto"},Ne=r(()=>t("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),Te={key:0,class:"card"},Ie={class:"flex align-items-center justify-content-between gap-2 mb-5"},Ce=r(()=>t("h5",{class:"m-0",style:{visibility:"hidden"}},"Overview",-1)),Pe={class:"card"},Ve=r(()=>t("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[t("h5",{class:"m-0"},"Overview")],-1)),Me=r(()=>t("p",{class:"text-center"},"No Data found...",-1)),Fe=r(()=>t("br",null,null,-1)),Be={class:"card"},Re=r(()=>t("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[t("h5",{class:"m-0"},"Project Wise Count")],-1)),Ue=r(()=>t("p",{class:"text-center"},"No Data found...",-1)),Ee=r(()=>t("br",null,null,-1)),Ge={class:"card"},We=r(()=>t("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[t("h5",{class:"m-0"},"Sprint")],-1)),Oe=r(()=>t("p",{class:"text-center"},"No Data found...",-1)),ze={__name:"index",setup(C){const{totalProjectsforReport:w,totalSpaces:z}=le(fe()),U=me(),p=b(""),m=b(""),d=b(),D=b([]),h=b(),$=b(null),j=b(null),x=b(null),S=b(!1),k=b(!1),P=se();ne(()=>{(!d.value||d.value.length===0)&&(w.value&&w.value.length>0?D.value=[...w.value]:D.value=[])}),ie(d,c=>{if(c&&c.length>0){const o=c.flatMap(i=>i.projects);D.value=o}else w.value&&w.value.length>0?D.value=[...w.value]:D.value=[]});const V=c=>{const o=c,i=new Date(o),l=i.getFullYear(),s=String(i.getMonth()+1).padStart(2,"0"),u=String(i.getDate()).padStart(2,"0");return`${l}-${s}-${u}`},A=async()=>{var a,g,f,M,_,E;if(p.value&&!m.value||!p.value&&m.value)return S.value=!1,P.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const c=O("token");S.value=!0;const o=V(p.value),i=V(m.value);let l;d.value&&d.value.length>0&&(l=(a=d.value)==null?void 0:a.map(y=>y.id),console.log("Space ID",l));let s;h.value&&h.value.length>0&&(s=(g=h.value)==null?void 0:g.map(y=>y.id),console.log("Project ID",s));const{data:u,error:N}=await W(`${U.public.apiUrl}/project-report/view?space_ids=${l||""}&project_ids=${s||""}&start_date=${p.value?o:""}&end_date=${m.value?i:""}`,{method:"GET",headers:{Authorization:`Bearer ${c.value}`}},"$tkCbN62YMP");return((f=u.value)==null?void 0:f.code)==200?($.value=(M=u.value.data)==null?void 0:M.overView.map((y,T)=>({...y,index:T+1})),j.value=(_=u.value.data)==null?void 0:_.projectWiseCount.map((y,T)=>({...y,index:T+1})),x.value=(E=u.value.data)==null?void 0:E.sprintTask.map((y,T)=>({...y,index:T+1})),S.value=!1):(S.value=!1,P.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},L=async()=>{var a,g;const c=O("token");if(k.value=!0,p.value&&!m.value||!p.value&&m.value)return S.value=!1,P.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const o=V(p.value),i=V(m.value);let l;d.value&&d.value.length>0&&(l=(a=d.value)==null?void 0:a.map(f=>f.id),console.log("Space ID",l));let s;h.value&&h.value.length>0&&(s=(g=h.value)==null?void 0:g.map(f=>f.id),console.log("Project ID",s));const{data:u,error:N}=await W(`${U.public.apiUrl}/project-report/download?space_ids=${l||""}&project_ids=${s||""}&start_date=${p.value?o:""}&end_date=${m.value?i:""}`,{method:"GET",headers:{Authorization:`Bearer ${c.value}`}},"$tccjGN5izh");if(N.value)return console.log(N),k.value=!1;if(u.value.code==200){const f=document.createElement("a");return f.href=u.value.download_path,f.target="_blank",f.click(),k.value=!1}else return k.value=!1,P.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},q=re(()=>c=>{let o=c;const i=Math.floor(o/3600),l=Math.floor(o%3600/60),s=o%60;return i>0?o=`${i} hr ${l} min ${s} sec`:l>0?o=`${l} min ${s} sec`:o=`${s} sec`,o}),H=()=>{p.value="",m.value="",d.value=[],h.value=[],$.value=null,j.value=null,x.value=null};return(c,o)=>{const i=Y,l=J,s=K,u=Q,N=X,a=Z,g=ee,f=te,M=ae;return I(),G("div",_e,[e(i,{position:"bottom-right",group:"br"}),ve,e(M,{onTabChange:c.onTabChange,class:"mt-3"},{default:v(()=>[e(f,{class:"file-upload",header:"Project Report"},{default:v(()=>[t("div",he,[e(i,{position:"bottom-right",group:"br"}),e(N,{class:"border-0 px-0 align-items-end"},{start:v(()=>[t("div",be,[t("div",ge,[ye,t("div",we,[e(l,{display:"chip",modelValue:n(d),"onUpdate:modelValue":o[0]||(o[0]=_=>F(d)?d.value=_:null),options:n(z),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Spaces",class:"w-full"},null,8,["modelValue","options"])])]),t("div",De,[Se,t("div",$e,[e(l,{display:"chip",modelValue:n(h),"onUpdate:modelValue":o[1]||(o[1]=_=>F(h)?h.value=_:null),options:n(D),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Projects",class:"w-full"},null,8,["modelValue","options"])])]),t("div",je,[xe,e(s,{modelValue:n(p),"onUpdate:modelValue":o[2]||(o[2]=_=>F(p)?p.value=_:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),t("div",ke,[Ne,e(s,{modelValue:n(m),"onUpdate:modelValue":o[3]||(o[3]=_=>F(m)?m.value=_:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:v(()=>[e(u,{onClick:H,label:"Reset",class:"mr-2"}),e(u,{onClick:A,class:"",label:"Generate",loading:n(S)},null,8,["loading"])]),_:1})]),n($)||n(j)||n(x)?(I(),G("div",Te,[t("div",Ie,[Ce,e(u,{onClick:L,class:"w-fit",label:"Download",loading:n(k)},null,8,["loading"])]),t("div",Pe,[Ve,n($)?(I(),R(g,{key:0,value:n($),tableStyle:"min-width: 50rem"},{empty:v(()=>[Me]),default:v(()=>[e(a,{field:"index",header:"Serial",sortable:""}),e(a,{field:"unit_name",header:"Unit Name"}),e(a,{field:"total_iteration",header:"Total Number of Iteration"}),e(a,{field:"total_missed_deadline",header:"No. of Missed Deadlines"}),e(a,{field:"missed_deadline_percentage",header:"% of Missed Deadlines"})]),_:1},8,["value"])):B("",!0)]),Fe,t("div",Be,[Re,n(j)?(I(),R(g,{key:0,value:n(j),tableStyle:"min-width: 50rem"},{empty:v(()=>[Ue]),default:v(()=>[e(a,{field:"index",header:"Serial",sortable:""}),e(a,{field:"project_name",header:"Project Name"}),e(a,{field:"unit_name",header:"Unit Name"}),e(a,{field:"total_iteration",header:"No. of Iteration"}),e(a,{field:"total_missed_deadline",header:"No.of Missed Deadlines"})]),_:1},8,["value"])):B("",!0)]),Ee,t("div",Ge,[We,n(x)?(I(),R(g,{key:0,value:n(x),tableStyle:"min-width: 50rem"},{empty:v(()=>[Oe]),default:v(()=>[e(a,{field:"index",header:"Serial",sortable:""}),e(a,{field:"task_name",style:{width:"40%"},header:"Task Name"}),e(a,{field:"project_name",header:"Project Name"}),e(a,{field:"status",header:"Status"}),e(a,{field:"due_date",header:"Due Date"}),e(a,{field:"end_date",header:"End Date"}),e(a,{field:"",header:"Duration"},{body:v(_=>[de(ce(n(q)(_.data.duration)),1)]),_:1}),e(a,{field:"unit_name",header:"Unit Name"}),e(a,{field:"missed_deadline",header:"Missed Deadlines"})]),_:1},8,["value"])):B("",!0)])])):B("",!0)]),_:1})]),_:1},8,["onTabChange"])])}}},Pt=oe(ze,[["__scopeId","data-v-434cfc36"]]);export{Pt as default};
