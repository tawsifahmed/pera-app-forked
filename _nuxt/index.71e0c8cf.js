import E from"./toast.esm.c29266ca.js";import N from"./multiselect.esm.89669ccb.js";import R from"./calendar.esm.f94a2fbb.js";import U from"./button.esm.3176abd6.js";import A from"./toolbar.esm.4d8fb4de.js";import O from"./column.esm.9e7e3fa6.js";import Y from"./datatable.esm.7ce57948.js";import{a2 as z,a5 as G,$ as h,a6 as W,a7 as H,b as F,i as s,l as a,w as S,u as f,e as L,F as q,o as I,a9 as x,a3 as J,a4 as K,ca as Q}from"./entry.cbc4cad8.js";import{u as P}from"./fetch.92bc8ca7.js";import{u as V}from"./cookie.650bfd0d.js";import{u as X}from"./workCompany.1b7d25f0.js";import"./radiobutton.esm.567e210f.js";import"./portal.esm.d33d469a.js";import"./basecomponent.esm.6fe80a6b.js";import"./index.esm.40366b4d.js";import"./baseicon.esm.abfcf349.js";import"./index.esm.c92528da.js";import"./index.esm.693955ee.js";import"./index.esm.654b8d3d.js";import"./checkbox.esm.3bb6ea33.js";import"./index.esm.3aee824d.js";import"./index.esm.1e659663.js";import"./index.esm.17a7140c.js";import"./overlayeventbus.esm.3bb8389f.js";import"./virtualscroller.esm.09f1d1b9.js";import"./index.esm.825e4b6a.js";import"./index.esm.c9125384.js";import"./index.esm.273ae94a.js";import"./badge.esm.58e1fc0b.js";import"./paginator.esm.849cd2cd.js";import"./index.esm.e2b409df.js";import"./dropdown.esm.78020c76.js";import"./inputnumber.esm.c12d6f45.js";import"./index.esm.3b91898a.js";import"./index.esm.ff143372.js";import"./inputtext.esm.a3cafc3d.js";import"./index.esm.86c4af79.js";import"./index.esm.9c90e4b7.js";import"./index.esm.7485515f.js";import"./index.esm.2ef3fb31.js";const g=D=>(J("data-v-3d1f1b58"),D=D(),K(),D),Z={class:"card"},ee=g(()=>s("div",{class:"d-flex mr-2"},[s("h5",{class:"mb-1"},"Task Reports")],-1)),te={class:"flex gap-2 flex-wrap"},ae={class:"user-selection w-full md:w-14rem w-full"},oe=g(()=>s("label",{class:"font-bold block mb-2"},"Project:",-1)),le={class:"flex justify-content-center"},se={class:"flex-auto"},re=g(()=>s("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),ne={class:"flex-auto"},ie=g(()=>s("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),de={key:0,class:"card"},ce={class:"flex align-items-center justify-content-between gap-2 mb-5"},ue=g(()=>s("h5",{class:"m-0"},"Preview",-1)),pe=g(()=>s("p",{class:"text-center"},"No Data found...",-1)),me={__name:"index",setup(D){const{totalProjects:B}=G(X()),j=Q(),r=h(""),n=h(""),c=h(),w=h(null),v=h(!1),b=h(!1),y=W(),k=m=>{const t=m,o=new Date(t),i=o.getFullYear(),u=String(o.getMonth()+1).padStart(2,"0"),p=String(o.getDate()).padStart(2,"0");return`${i}-${u}-${p}`},C=async()=>{var _,e;if(r.value&&!n.value||!r.value&&n.value)return v.value=!1,y.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const m=V("token");v.value=!0;const t=k(r.value),o=k(n.value),i=new FormData;if(c.value&&c.value.length>0){const d=(_=c.value)==null?void 0:_.map(l=>l.id);console.log("Project ID",d),d.length>0&&d.forEach(l=>{i.append("project_id[]",l)})}r.value&&n.value&&(i.append("start_due_date",t),i.append("end_due_date",o));const{data:u,error:p}=await P(`${j.public.apiUrl}/tasks/project-wise-task-report-view`,{method:"POST",headers:{Authorization:`Bearer ${m.value}`},body:i},"$y5Dl6B2mhy");return((e=u.value)==null?void 0:e.code)==200?(w.value=u.value.data.map((d,l)=>({...d,index:l+1})),v.value=!1):(v.value=!1,y.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},T=async()=>{var _;const m=V("token");if(b.value=!0,r.value&&!n.value||!r.value&&n.value)return v.value=!1,y.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const t=k(r.value),o=k(n.value),i=new FormData;if(c.value&&c.value.length>0){const e=(_=c.value)==null?void 0:_.map(d=>d.id);console.log("Project ID",e),e.length>0&&e.forEach(d=>{i.append("project_id[]",d)})}r.value&&n.value&&(i.append("start_due_date",t),i.append("end_due_date",o));const{data:u,error:p}=await P(`${j.public.apiUrl}/tasks/project-wise-task-report-download`,{method:"POST",headers:{Authorization:`Bearer ${m.value}`},body:i},"$h7a31M7TcS");if(p.value)return console.log(p),b.value=!1;if(u.value.code==200){const e=document.createElement("a");return e.href=u.value.download_path,e.target="_blank",e.click(),b.value=!1}else return b.value=!1,y.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},$=(m,t)=>{const o=new Date(t);m=="startDate"?r.value=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate():n.value=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate()};H(()=>{});const M=()=>{r.value="",n.value="",c.value=[],w.value=null};return(m,t)=>{const o=E,i=N,u=R,p=U,_=A,e=O,d=Y;return I(),F(q,null,[s("div",Z,[a(o,{position:"bottom-right",group:"br"}),ee,a(_,{class:"border-0 px-0"},{start:S(()=>[s("div",te,[s("div",ae,[oe,s("div",le,[a(i,{display:"chip",modelValue:f(c),"onUpdate:modelValue":t[0]||(t[0]=l=>x(c)?c.value=l:null),options:f(B),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full"},null,8,["modelValue","options"])])]),s("div",se,[re,a(u,{modelValue:f(r),"onUpdate:modelValue":t[1]||(t[1]=l=>x(r)?r.value=l:null),onDateSelect:t[2]||(t[2]=l=>$("startDate",l)),clearButton:"true",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),s("div",ne,[ie,a(u,{modelValue:f(n),"onUpdate:modelValue":t[3]||(t[3]=l=>x(n)?n.value=l:null),onDateSelect:t[4]||(t[4]=l=>$("endtDate",l)),clearButton:"",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:S(()=>[a(p,{onClick:M,icon:"pi pi-undo",rounded:"",raised:"",class:"mr-2"}),a(p,{onClick:C,class:"",label:"Generate",loading:f(v)},null,8,["loading"])]),_:1})]),f(w)?(I(),F("div",de,[s("div",null,[s("div",ce,[ue,a(p,{onClick:T,class:"w-fit",label:"Download",loading:f(b)},null,8,["loading"])]),a(d,{value:f(w),tableStyle:"min-width: 50rem"},{empty:S(()=>[pe]),default:S(()=>[a(e,{field:"index",header:"Serial",sortable:""}),a(e,{field:"task_name",style:{width:"40%"},header:"Task Name"}),a(e,{field:"project_name",header:"Project Name"}),a(e,{field:"task_status",header:"Status"}),a(e,{field:"task_due_date",header:"Due Date"}),a(e,{field:"task_date_done",header:"Date Done"}),a(e,{field:"duration",header:"Duration"}),a(e,{field:"unit",header:"Unit"}),a(e,{field:"overdue",header:"Missed Deadlines"})]),_:1},8,["value"])])])):L("",!0)],64)}}},et=z(me,[["__scopeId","data-v-3d1f1b58"]]);export{et as default};
