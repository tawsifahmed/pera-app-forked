import M from"./toast.esm.8e0c7f26.js";import E from"./multiselect.esm.d9a634cf.js";import N from"./calendar.esm.617e2cc2.js";import U from"./button.esm.e846d103.js";import R from"./toolbar.esm.54b5bb07.js";import A from"./column.esm.347a1d2a.js";import O from"./datatable.esm.549750af.js";import{a2 as Y,a3 as z,$ as h,a4 as G,a5 as W,b as F,i as s,l as a,w as k,u as f,e as H,F as L,o as I,a7 as x,a8 as q,a9 as J,ca as K}from"./entry.f1083d62.js";import{u as P}from"./fetch.10fa1737.js";import{u as V}from"./cookie.9dea65c9.js";import{u as Q}from"./workCompany.9fc24a14.js";import"./radiobutton.esm.6dce7c4d.js";import"./portal.esm.a12ffff4.js";import"./basecomponent.esm.dd1da9c1.js";import"./index.esm.0a9206fc.js";import"./baseicon.esm.9dc16ba1.js";import"./index.esm.1d6733e5.js";import"./index.esm.1c5b7344.js";import"./index.esm.6a9442c3.js";import"./checkbox.esm.f06bbf32.js";import"./index.esm.25dde301.js";import"./index.esm.dadcf415.js";import"./index.esm.0cabc4e6.js";import"./overlayeventbus.esm.0f70953e.js";import"./virtualscroller.esm.8b3bbffe.js";import"./index.esm.1493f6f1.js";import"./index.esm.18ac01f2.js";import"./index.esm.e1839713.js";import"./badge.esm.06f68ce4.js";import"./paginator.esm.48f6f07f.js";import"./index.esm.59d7ab85.js";import"./dropdown.esm.4e9c9472.js";import"./inputnumber.esm.bd15fd88.js";import"./index.esm.db20bc22.js";import"./index.esm.262c264f.js";import"./inputtext.esm.2f4ebd3b.js";import"./index.esm.f2124f4a.js";import"./index.esm.26a78852.js";import"./index.esm.8aab8f7c.js";import"./index.esm.d83addac.js";const b=D=>(q("data-v-7b8d62db"),D=D(),J(),D),X={class:"card"},Z=b(()=>s("div",{class:"d-flex mr-2"},[s("h5",{class:"mb-1"},"Task Reports")],-1)),ee={class:"flex gap-2 flex-wrap"},te={class:"user-selection w-full md:w-14rem w-full"},ae=b(()=>s("label",{class:"font-bold block mb-2"},"Project:",-1)),oe={class:"flex justify-content-center"},le={class:"flex-auto"},se=b(()=>s("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),re={class:"flex-auto"},ne=b(()=>s("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),ie={key:0,class:"card"},de={class:"flex align-items-center justify-content-between gap-2 mb-5"},ce=b(()=>s("h5",{class:"m-0"},"Preview",-1)),ue=b(()=>s("p",{class:"text-center"},"No Data found...",-1)),pe={__name:"index",setup(D){const{totalProjects:B}=z(Q()),j=K(),n=h(""),i=h(""),u=h(),S=h(null),v=h(!1),g=h(!1),w=G(),y=p=>{const t=p,o=new Date(t),r=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),m=String(o.getDate()).padStart(2,"0");return`${r}-${c}-${m}`},T=async()=>{var _,e;if(n.value&&!i.value||!n.value&&i.value)return v.value=!1,w.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const p=V("token");v.value=!0;const t=y(n.value),o=y(i.value),r=new FormData;if(u.value&&u.value.length>0){const d=(_=u.value)==null?void 0:_.map(l=>l.id);console.log("Project ID",d),d.length>0&&d.forEach(l=>{r.append("project_id[]",l)})}n.value&&i.value&&(r.append("start_due_date",t),r.append("end_due_date",o));const{data:c,error:m}=await P(`${j.public.apiUrl}/tasks/project-wise-task-report-view`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:r},"$y5Dl6B2mhy");return((e=c.value)==null?void 0:e.code)==200?(S.value=c.value.data.map((d,l)=>({...d,index:l+1})),v.value=!1):(v.value=!1,w.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},C=async()=>{var _;const p=V("token");if(g.value=!0,n.value&&!i.value||!n.value&&i.value)return v.value=!1,w.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const t=y(n.value),o=y(i.value),r=new FormData;if(u.value&&u.value.length>0){const e=(_=u.value)==null?void 0:_.map(d=>d.id);console.log("Project ID",e),e.length>0&&e.forEach(d=>{r.append("project_id[]",d)})}n.value&&i.value&&(r.append("start_due_date",t),r.append("end_due_date",o));const{data:c,error:m}=await P(`${j.public.apiUrl}/tasks/project-wise-task-report-download`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:r},"$h7a31M7TcS");if(m.value)return console.log(m),g.value=!1;if(c.value.code==200){const e=document.createElement("a");return e.href=c.value.download_path,e.target="_blank",e.click(),g.value=!1}else return g.value=!1,w.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},$=(p,t)=>{const o=new Date(t);p=="startDate"?n.value=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate():i.value=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate()};return W(()=>{}),(p,t)=>{const o=M,r=E,c=N,m=U,_=R,e=A,d=O;return I(),F(L,null,[s("div",X,[a(o,{position:"bottom-right",group:"br"}),Z,a(_,{class:"border-0 px-0"},{start:k(()=>[s("div",ee,[s("div",te,[ae,s("div",oe,[a(r,{display:"chip",modelValue:f(u),"onUpdate:modelValue":t[0]||(t[0]=l=>x(u)?u.value=l:null),options:f(B),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full"},null,8,["modelValue","options"])])]),s("div",le,[se,a(c,{modelValue:f(n),"onUpdate:modelValue":t[1]||(t[1]=l=>x(n)?n.value=l:null),onDateSelect:t[2]||(t[2]=l=>$("startDate",l)),clearButton:"true",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),s("div",re,[ne,a(c,{modelValue:f(i),"onUpdate:modelValue":t[3]||(t[3]=l=>x(i)?i.value=l:null),onDateSelect:t[4]||(t[4]=l=>$("endtDate",l)),clearButton:"",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:k(()=>[a(m,{onClick:T,class:"w-full",label:"Generate",loading:f(v)},null,8,["loading"])]),_:1})]),f(S)?(I(),F("div",ie,[s("div",null,[s("div",de,[ce,a(m,{onClick:C,class:"w-fit",label:"Download",loading:f(g)},null,8,["loading"])]),a(d,{value:f(S),tableStyle:"min-width: 50rem"},{empty:k(()=>[ue]),default:k(()=>[a(e,{field:"index",header:"Serial",sortable:""}),a(e,{field:"task_name",style:{width:"40%"},header:"Task Name"}),a(e,{field:"project_name",header:"Project Name"}),a(e,{field:"task_status",header:"Status"}),a(e,{field:"task_due_date",header:"Due Date"}),a(e,{field:"task_date_done",header:"Date Done"}),a(e,{field:"duration",header:"Duration"}),a(e,{field:"unit",header:"Unit"}),a(e,{field:"overdue",header:"Missed Deadlines"})]),_:1},8,["value"])])])):H("",!0)],64)}}},Ze=Y(pe,[["__scopeId","data-v-7b8d62db"]]);export{Ze as default};
