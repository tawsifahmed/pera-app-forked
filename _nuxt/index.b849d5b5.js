import ke from"./dropdown.esm.94ac987f.js";import Pe from"./calendar.esm.cf269401.js";import $e from"./button.esm.32bef0f9.js";import{a as Te}from"./CreateCompany.5bc020f3.js";import{a2 as Ve,a3 as F,$ as l,a5 as H,ar as Y,b as u,i as o,l as n,u as m,e as j,F as je,f as Ie,c as Le,a as Ae,o as r,s as Me,k as Fe,K as Ue,t as U,a8 as Be,a9 as Ne,ca as Oe,an as Re}from"./entry.3bbd680d.js";import{u as ze}from"./fetch.114836d2.js";import{u as Ee}from"./cookie.46510969.js";import{u as He}from"./layout.99178b2c.js";import{a as w}from"./usePermission.4052dabe.js";import{u as W}from"./auth.c6a5e7db.js";import{u as q}from"./company.3b49c059.js";import{u as G}from"./workCompany.8b0d286c.js";import J from"./chart.esm.fbe73a95.js";import"./baseicon.esm.07236b28.js";import"./basecomponent.esm.22a83963.js";import"./index.esm.4bb3c5dc.js";import"./index.esm.9d078b4b.js";import"./index.esm.08a9cf78.js";import"./index.esm.c51a4b34.js";import"./index.esm.e875bfac.js";import"./overlayeventbus.esm.fae87c9d.js";import"./portal.esm.b00f5f1c.js";import"./virtualscroller.esm.bd9c8660.js";import"./index.esm.4ca9447a.js";import"./index.esm.39cf72b3.js";import"./index.esm.8043c609.js";import"./badge.esm.ab9659d4.js";import"./inputtext.esm.49d8341d.js";import"./dialog.esm.8bebc37a.js";const g=S=>(Be("data-v-7f019dbf"),S=S(),Ne(),S),Ye={class:"grid"},We={key:0,class:"col-12 xl:col-6"},qe={class:"card h-full"},Ge={class:"flex gap-2 align-items-center flex-wrap",style:{"padding-bottom":"10px"}},Je=g(()=>o("h5",{class:"mb-2"},"Tasks",-1)),Ke={class:"flex gap-2 flex-wrap justify-content-end filter-container"},Xe={class:"mb-2 relative w-full md:w-12rem"},Qe={class:"task-container"},Ze={key:0,class:"flex justify-content-center align-items-center",style:{height:"22rem"}},et=g(()=>o("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2.25rem"}},null,-1)),tt=[et],at={key:1},lt=["onClick"],ot={class:"title-group"},st={class:"title line-clamp-1",style:{"font-weight":"600"}},nt=g(()=>o("div",{style:{"background-color":"#00000040",height:"5px",width:"5px","border-radius":"15px"}},null,-1)),rt={style:{"font-size":"12px"}},it={key:2},ct=g(()=>o("p",{class:"text-black text-lg text-center"},"No Tasks found!",-1)),dt=[ct],ut={class:"w-full flex justify-content-center"},pt={class:"col-12 xl:col-6"},mt={class:"card h-full"},vt=g(()=>o("h5",null,"Tasks Statistics",-1)),ft={class:"w-full flex justify-content-center"},gt={class:"col-12 h-full"},_t={class:"card dashChart"},ht={class:"flex justify-content-between align-items-start dash-inf"},yt={class:"flex align-items-center gap-3 dash-inf-left"},bt=g(()=>o("h5",{class:"mb-0"},"Projects Overview",-1)),Ct={class:"flex gap-2 flex-wrap dash-inf-right"},wt={class:"chartWrapper"},St={class:"chartAreaWrapper"},xt={key:1},Dt={__name:"index",setup(S){G();const{totalCompanies:kt,totalProjects:K}=F(G()),X=Oe(),{getChartData:Q,getTaskAssignModalData:Z,getRoles:ee,getTagsAssignModalData:te}=q(),{chartProjectInfo:ae,inProgressCnt:le,chartClosedTaskInfo:oe,totalDashboardProjects:se,completedTasksChartData:ne,inProgressTasksChartData:re,unAssignedTasksChartData:ie,users:Pt,rolesLists:$t,tags:Tt}=F(q());W(),F(W()),l(w("read_user")),l(w("read_role")),l(w("read_tags"));const ce=l(w("read_task"));l(w("create_company"));const{isDarkTheme:de}=He();l(null);const ue=l({labels:ae,datasets:[{label:"In Progress",data:le,fill:!1,backgroundColor:"#6366f1",borderColor:"#6366f1",tension:.4},{label:"Completed",data:oe,fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4}]});H(()=>{B.value=fe(),N.value=ge()});const B=l(),N=l();let pe=localStorage.getItem("completedTasksChartData"),me=localStorage.getItem("inProgressTasksChartData"),ve=localStorage.getItem("unAssignedTasksChartData");const fe=()=>{const t=getComputedStyle(document.body);return{labels:["Completed","In Progress","Unassigned"],datasets:[{data:[pe,me,ve],backgroundColor:[t.getPropertyValue("--cyan-500"),t.getPropertyValue("--orange-500"),t.getPropertyValue("--gray-500")],hoverBackgroundColor:[t.getPropertyValue("--cyan-400"),t.getPropertyValue("--orange-400"),t.getPropertyValue("--gray-400")]}]}},ge=()=>({plugins:{legend:{labels:{usePointStyle:!0,color:getComputedStyle(document.documentElement).getPropertyValue("--text-color")}}}}),_=l([]);l([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const I=l(null),x=l(!1),D=l(null),_e=()=>{var t;D.value=JSON.parse(localStorage.getItem("userCompany")),console.log("hasUserCompany =>",D.value),D.value===null||((t=D.value)==null?void 0:t.length)==0?x.value=!0:x.value=!1,console.log("visibleCreateCompany =>",x.value)},he=()=>{I.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},ye=()=>{I.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}},i=l(),O=l(),R=l(),v=l(),k=l(!1),L=l(!1);Y(i,t=>{var a,s;O.value=[{name:"All",id:""},...((s=(a=i.value)==null?void 0:a.statuses)==null?void 0:s.map(c=>({name:c.name,id:c.id})))||[]]});const h=l(),P=l(),$=l(),T=l(),z=l(1);let p=l(1);const f=async()=>{P.value=i.value?i.value.id:"",$.value=h.value?h.value.id:"",T.value=v.value,M?p.value++:p.value=1,z.value=p.value,V.value=0,A(P.value,$.value,T.value,z.value),M=!1},be=t=>{k.value=!0;const a=new Date(t);v.value=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),f()},Ce=()=>{k.value=!1,v.value="",T.value="",f()},we=()=>{if(i.value||R.value||v.value||p.value>1)i.value="",R.value="",v.value="",P.value="",$.value="",h.value="",k.value=!1,f();else return},Se=async t=>{const a=localStorage.getItem("userCompany");console.log("Task click: ",t),await Re({path:`/companies/${a}/spaces/${t==null?void 0:t.space_id}/projects/${t==null?void 0:t.project_id}`,query:{task_key:t.id}})},xe=t=>{const a=t,s=new Date(a),c=s.getFullYear(),d=String(s.getMonth()+1).padStart(2,"0");return`${String(s.getDate()).padStart(2,"0")}-${d}-${c}`},V=l(0),E=l(!1),y=l(!1),De=async t=>{t==="hide-loader"&&(E.value=!0),y.value=!0,p.value++,await A(P.value,$.value,T.value,p.value)},A=async(t="",a="",s="",c=1)=>{var b;E.value||(L.value=!0),console.log("status",a);try{const C=Ee("token"),{data:e,pending:Vt,error:jt}=await ze(`${X.public.apiUrl}/tasks/list?due_date=${s}&status=${a}&project_id=${t}&limit=15&page=${c}`,{method:"GET",headers:{Authorization:`Bearer ${C.value}`}},"$PslAyef5YX");e.value&&e.value.data&&((b=e.value.counts)!=null&&b.total_tasks)?(V.value=Math.ceil(e.value.counts.total_tasks/15),_.value=c===1?e.value.data:[..._.value,...e.value.data],y.value=!1):(_.value=[],y.value=!1)}catch(C){console.log(C),y.value=!1}finally{L.value=!1}};let M=!1;return window.addEventListener("scroll",()=>{const{scrollTop:t,scrollHeight:a,clientHeight:s}=document.documentElement;t+s>=a-50&&p.value<V&&(M=!0,f())}),A(),H(()=>{ee(),Z(),te(),Q(),_e()}),Y(de,t=>{t?ye():he()},{immediate:!0}),(t,a)=>{const s=ke,c=Pe,d=$e,b=Te,C=Ae("tooltip");return r(),u("div",Ye,[ce.value?(r(),u("div",We,[o("div",qe,[o("div",Ge,[Je,o("div",Ke,[n(s,{onChange:a[0]||(a[0]=e=>f()),modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),options:m(K),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options"]),n(s,{onChange:a[2]||(a[2]=e=>f()),modelValue:h.value,"onUpdate:modelValue":a[3]||(a[3]=e=>h.value=e),options:O.value,disabled:!i.value,optionLabel:"name",placeholder:"Select Status",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options","disabled"]),o("div",Xe,[n(c,{onDateSelect:a[4]||(a[4]=e=>be(e)),modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=e=>v.value=e),placeholder:"Select Date",class:"w-full md:w-12rem"},null,8,["modelValue"]),k.value?(r(),u("p",{key:0,onClick:Ce,class:"pi pi-times end-cross absolute cursor-pointer"})):j("",!0)]),n(d,{onClick:we,label:"Reset",class:"mb-2",severity:"secondary"})])]),o("div",Qe,[L.value?(r(),u("div",Ze,tt)):_.value.length>0?(r(),u("div",at,[(r(!0),u(je,null,Ie(_.value,e=>(r(),u("div",{key:e.id,onClick:()=>Se(e),class:"task-card"},[o("div",ot,[Me(o("div",{class:Fe("status"),style:Ue(`background-color: ${e==null?void 0:e.status_color};`)},null,4),[[C,{value:`Status: ${e.status_name}`},void 0,{left:!0}]]),o("p",st,U(e==null?void 0:e.name),1),nt,o("p",null,U(e==null?void 0:e.project_name),1)]),o("div",null,[o("p",rt,"Due: "+U(e.due_date?xe(e==null?void 0:e.due_date):"Not Set"),1)])],8,lt))),128))])):(r(),u("div",it,dt)),o("div",ut,[m(p)<V.value?(r(),Le(d,{key:0,onClick:a[6]||(a[6]=e=>De("hide-loader")),loading:y.value,label:"Load More",severity:"secondary"},null,8,["loading"])):j("",!0)])])])])):j("",!0),o("div",pt,[o("div",mt,[vt,o("div",ft,[n(m(J),{type:"pie",data:B.value,options:N.value,class:"w-full md:w-30rem"},null,8,["data","options"])])])]),o("div",gt,[o("div",_t,[o("div",ht,[o("div",yt,[bt,n(d,{class:"nwrp",label:`Total Projects: ${m(se)}`,severity:"secondary"},null,8,["label"])]),o("div",Ct,[n(d,{class:"nwrp",label:`In Progress: ${m(re)}`,severity:"info",outlined:""},null,8,["label"]),n(d,{class:"nwrp",label:`Unassigned: ${m(ie)}`,severity:"help",outlined:""},null,8,["label"]),n(d,{class:"nwrp",label:`Completed: ${m(ne)}`,severity:"contrast",outlined:""},null,8,["label"])])]),o("div",wt,[o("div",St,[n(m(J),{type:"bar",data:ue.value,options:I.value},null,8,["data","options"])])])])]),x.value?(r(),u("div",xt,[n(b)])):j("",!0)])}}},ra=Ve(Dt,[["__scopeId","data-v-7f019dbf"]]);export{ra as default};
