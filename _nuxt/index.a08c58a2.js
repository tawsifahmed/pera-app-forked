import G from"./toast.esm.b17bbc51.js";import H from"./multiselect.esm.f28c9f3c.js";import q from"./calendar.esm.93994793.js";import J from"./button.esm.88347c6f.js";import Z from"./toolbar.esm.73b64771.js";import K from"./column.esm.8a6ee162.js";import Q from"./datatable.esm.f74cef75.js";import{a2 as X,a3 as ee,$ as f,a4 as te,a5 as ae,b as y,i as a,l as s,w as V,u,e as A,F as U,o as D,a7 as F,f as M,t as N,q as oe,a8 as le,a9 as se,ca as ne}from"./entry.3e031b31.js";import{u as T,a as re}from"./cookie.3a12c915.js";import{u as O}from"./fetch.61c1c88e.js";import{u as ie}from"./workCompany.26742698.js";import de from"./radiobutton.esm.2c677a93.js";import"./portal.esm.448751c9.js";import"./basecomponent.esm.f10d2202.js";import"./index.esm.3bbfbffd.js";import"./baseicon.esm.ab14f454.js";import"./index.esm.491b053f.js";import"./index.esm.96be34b5.js";import"./index.esm.906520e3.js";import"./checkbox.esm.3d476e26.js";import"./index.esm.2869aa49.js";import"./index.esm.5dc4fd42.js";import"./index.esm.e4de41df.js";import"./overlayeventbus.esm.6bdd91ba.js";import"./virtualscroller.esm.36665890.js";import"./index.esm.b9209505.js";import"./index.esm.fda85297.js";import"./index.esm.282cf79d.js";import"./badge.esm.d2071273.js";import"./paginator.esm.b5f94b10.js";import"./index.esm.b1e73331.js";import"./dropdown.esm.4e38f6fc.js";import"./inputnumber.esm.9e5cecde.js";import"./index.esm.1ade529d.js";import"./index.esm.f7fd1575.js";import"./inputtext.esm.54067f1b.js";import"./index.esm.e37a6ddf.js";import"./index.esm.c53ff983.js";import"./index.esm.6604c4b8.js";import"./index.esm.112fa617.js";const h=I=>(le("data-v-5858af89"),I=I(),se(),I),ue={class:"card"},ce=h(()=>a("div",{class:"d-flex mr-2"},[a("h5",{class:"mb-1"},"User Reports")],-1)),pe={class:"flex gap-2 flex-wrap"},me={class:"user-selection w-full md:w-14rem w-full"},fe=h(()=>a("label",{class:"font-bold block mb-2"},"User:",-1)),_e={class:"flex justify-content-center"},ve={class:"user-selection w-full md:w-14rem w-full"},he=h(()=>a("label",{class:"font-bold block mb-2"},"Project:",-1)),ge={class:"flex justify-content-center"},be={class:"flex-auto"},ye=h(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),De={class:"flex-auto"},ke=h(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),we={class:"flex-auto ml-2"},xe=h(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"Date Type: ",-1)),Se={class:"flex flex-wrap gap-2 mt-3 mb-2 text-sm"},$e=["for"],Ve={key:0,class:"card"},Fe={class:"flex align-items-center justify-content-between gap-2 mb-5"},Ie=h(()=>a("h5",{class:"m-0"},"Preview",-1)),Ce=h(()=>a("p",{class:"text-center"},"No Data found...",-1)),je={key:0,class:"font-bold"},Pe={__name:"index",setup(I){const{totalProjects:R}=ee(ie()),j=ne(),c=f(""),S=f("Create"),z=f([{name:"Create",key:"A"},{name:"Due Date",key:"B"}]),p=f(""),g=f(""),_=f(),B=f([]),P=f(null),k=f(!1),w=f(!1),x=te(),C=m=>{const t=m,l=new Date(t),o=l.getFullYear(),i=String(l.getMonth()+1).padStart(2,"0"),d=String(l.getDate()).padStart(2,"0");return`${o}-${i}-${d}`},L=async()=>{var n,b,e;if(g.value=="")return x.add({severity:"warn",summary:"Warning",detail:"Please Select User First",group:"br",life:3e3});if(c.value&&!p.value||!c.value&&p.value)return k.value=!1,x.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const m=T("token");k.value=!0;const t=C(c.value),l=C(p.value),o=new FormData,i=(n=g.value)==null?void 0:n.map(r=>r.id);if(console.log("User ID",i),i.forEach(r=>{o.append("user_id[]",r)}),_.value&&_.value.length>0){const r=(b=_.value)==null?void 0:b.map($=>$.id);console.log("Project ID",r),r.length>0&&r.forEach($=>{o.append("project_id[]",$)})}c.value&&p.value&&(S.value=="Create"?(o.append("start_date",t),o.append("end_date",l)):(o.append("start_due_date",t),o.append("end_due_date",l)));const{data:d,error:v}=await O(`${j.public.apiUrl}/tasks/task-report-view`,{method:"POST",headers:{Authorization:`Bearer ${m.value}`},body:o},"$3y9pxb6gbv");return((e=d.value)==null?void 0:e.code)==200?(P.value=d.value.data,k.value=!1):(k.value=!1,x.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},W=async()=>{var n,b;const m=T("token");if(w.value=!0,g.value=="")return w.value=!1,x.add({severity:"error",summary:"Failed",detail:"Please Select Employee",group:"br",life:3e3});if(c.value&&!p.value||!c.value&&p.value)return k.value=!1,x.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const t=C(c.value),l=C(p.value),o=new FormData,i=(n=g.value)==null?void 0:n.map(e=>e.id);if(console.log("User ID",i),i.forEach(e=>{o.append("user_id[]",e)}),_.value&&_.value.length>0){const e=(b=_.value)==null?void 0:b.map(r=>r.id);console.log("Project ID",e),e.length>0&&e.forEach(r=>{o.append("project_id[]",r)})}c.value&&p.value&&(S.value=="Create"?(o.append("start_date",t),o.append("end_date",l)):(o.append("start_due_date",t),o.append("end_due_date",l)));const{data:d,error:v}=await O(`${j.public.apiUrl}/tasks/task-report-download`,{method:"POST",headers:{Authorization:`Bearer ${m.value}`},body:o},"$JMgttPZ06P");if(v.value)return console.log(v),w.value=!1;if(d.value.code==200){const e=document.createElement("a");return e.href=d.value.download_path,e.target="_blank",e.click(),w.value=!1}else return w.value=!1,x.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},E=(m,t)=>{const l=new Date(t);m=="startDate"?c.value=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate():p.value=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()},Y=async()=>{var i,d,v;const m=T("token"),{data:t,pending:l,error:o}=await re("taskAssignModalData",()=>$fetch(`${j.public.apiUrl}/users/list`,{headers:{Authorization:`Bearer ${m.value}`}}));((d=(i=t.value)==null?void 0:i.data)==null?void 0:d.length)>0&&(B.value=(v=t.value)==null?void 0:v.data)};return ae(()=>{Y()}),(m,t)=>{const l=G,o=H,i=q,d=J,v=Z,n=K,b=Q;return D(),y(U,null,[a("div",ue,[s(l,{position:"bottom-right",group:"br"}),ce,s(v,{class:"border-0 px-0"},{start:V(()=>[a("div",pe,[a("div",me,[fe,a("div",_e,[s(o,{display:"chip",modelValue:u(g),"onUpdate:modelValue":t[0]||(t[0]=e=>F(g)?g.value=e:null),options:u(B),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select User",class:"w-full"},null,8,["modelValue","options"])])]),a("div",ve,[he,a("div",ge,[s(o,{display:"chip",modelValue:u(_),"onUpdate:modelValue":t[1]||(t[1]=e=>F(_)?_.value=e:null),options:u(R),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full"},null,8,["modelValue","options"])])]),a("div",be,[ye,s(i,{modelValue:u(c),"onUpdate:modelValue":t[2]||(t[2]=e=>F(c)?c.value=e:null),onDateSelect:t[3]||(t[3]=e=>E("startDate",e)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),a("div",De,[ke,s(i,{modelValue:u(p),"onUpdate:modelValue":t[4]||(t[4]=e=>F(p)?p.value=e:null),onDateSelect:t[5]||(t[5]=e=>E("endtDate",e)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),a("div",we,[xe,a("div",Se,[(D(!0),y(U,null,M(u(z),e=>(D(),y("div",{key:e.key,class:"flex align-items-center"},[s(u(de),{modelValue:u(S),"onUpdate:modelValue":t[6]||(t[6]=r=>F(S)?S.value=r:null),inputId:e.key,name:"dynamic",value:e.name},null,8,["modelValue","inputId","value"]),a("label",{for:e.key,class:"ml-2"},N(e.name),9,$e)]))),128))])])])]),end:V(()=>[s(d,{onClick:L,class:"w-full",label:"Generate",loading:u(k)},null,8,["loading"])]),_:1})]),u(P)?(D(),y("div",Ve,[a("div",null,[a("div",Fe,[Ie,s(d,{onClick:W,class:"w-fit",label:"Download",loading:u(w)},null,8,["loading"])]),s(b,{value:u(P),tableStyle:"min-width: 50rem"},{empty:V(()=>[Ce]),default:V(()=>[s(n,{field:"task_name",header:"Task"}),s(n,{field:"project_name",header:"Project"}),s(n,{field:"assignee_name",header:"Assignee"},{body:V(e=>[(D(!0),y(U,null,M(e.data.assignee_name,(r,$)=>(D(),y("div",null,[oe(N(r.name),1),$<e.data.assignee_name.length-1?(D(),y("span",je,", ")):A("",!0)]))),256))]),_:1}),s(n,{field:"task_status",header:"Status"}),s(n,{field:"task_due_date",header:"Due Date"}),s(n,{field:"task_date_done",header:"Completed Date"}),s(n,{field:"formatted_time_tracked",header:"Time Track"}),s(n,{field:"overdue",header:"Over Due"}),s(n,{field:"bounce",header:"Bounce"})]),_:1},8,["value"])])])):A("",!0)],64)}}},bt=X(Pe,[["__scopeId","data-v-5858af89"]]);export{bt as default};
