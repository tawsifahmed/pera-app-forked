import Me from"./toast.esm.a949a884.js";import{_ as Re}from"./nuxt-link.056bab72.js";import qe from"./inputtext.esm.df1ed0e5.js";import Oe from"./floatlabel.esm.cbe3397c.js";import Ce from"./button.esm.02c969f5.js";import Fe from"./tabpanel.esm.ed24b913.js";import ze from"./tabview.esm.ffec7ef4.js";import{a2 as de,a4 as De,$ as i,aq as Ee,o as b,c as Pe,w,l as n,i as e,I as Te,u as s,b as C,a6 as X,a7 as Ue,a8 as Ve,F as Ge,f as He,k as ee,am as We,ca as Ne,a3 as le,cg as Qe,a5 as xe,ag as Ze,V as Ke,ap as Ye,Y as Je,ab as Xe,s as ie,e as ne,r as et,a as tt,t as ot}from"./entry.f0c5cf2a.js";import{u as re}from"./user.3d505962.js";import Se from"./password.esm.86232912.js";import{u as ce}from"./auth.307f60ff.js";import at from"./dialog.esm.b5cdb412.js";import{u as ue,a as H}from"./cookie.151b076d.js";import{_ as st}from"./avatar.5fe8c628.js";import{u as Ie}from"./clock.d208ae6a.js";import{u as lt}from"./layout.b453a5e2.js";import"./portal.esm.b5621338.js";import"./basecomponent.esm.ed9a8dc9.js";import"./index.esm.f961079b.js";import"./baseicon.esm.a7d442d2.js";import"./index.esm.0dd784d2.js";import"./index.esm.492ad606.js";import"./index.esm.09b018b7.js";import"./badge.esm.6b4b3237.js";import"./index.esm.535c9e07.js";import"./index.esm.540e4544.js";import"./index.esm.e1281ff7.js";import"./index.esm.d09698f4.js";import"./overlayeventbus.esm.f6271641.js";const je=""+new URL("dummy_profile.643624ed.png",import.meta.url).href;const U=T=>(Ue("data-v-3cf31c8a"),T=T(),Ve(),T),it={class:"col-12 text-center mb-5"},nt={class:"relative w-fit mx-auto"},rt=["src"],ct={key:1,src:je,alt:"",style:{height:"100px",width:"100px","border-radius":"100%","object-fit":"cover"}},ut={class:"img-label"},dt=U(()=>e("label",{for:"image"},[e("i",{class:"pi pi-plus",style:{color:"red",right:"0.2rem",bottom:"0.2rem","z-index":"5","background-color":"white",padding:"8px","border-radius":"20px","box-shadow":"rgba(0, 0, 0, 0.16) 0px 1px 4px",cursor:"pointer"}})],-1)),pt=["v-model"],mt={class:"col-12 lg:col-6 mb-3"},vt=U(()=>e("label",{for:"name"},"Name",-1)),ft={class:"col-12 lg:col-6 mb-3"},_t=U(()=>e("label",{for:"phone"},"Phone",-1)),gt={class:"col-12 lg:col-6 mb-3"},bt=U(()=>e("label",{for:"email"},"Email",-1)),ht={class:"col-12 lg:col-6 mb-3"},yt=U(()=>e("label",{for:"address"},"Address",-1)),kt={class:"col-12 mb-3 flex justify-content-center"},wt=U(()=>e("br",null,null,-1)),$t=U(()=>e("br",null,null,-1)),Tt={class:"col-12 mb-3"},xt=U(()=>e("label",{for:"passw"},"New Password",-1)),St={class:"col-12"},It=U(()=>e("label",{for:"password2"},"Confirm Password",-1)),Ct={class:"col-12 mt-3 mb-3 px-5 flex justify-content-center"},Dt={__name:"Profile",props:["userProfile"],setup(T){var A,L,W,Q,Z;const{passwordReset:q}=ce(),{userProfile:a}=T,{updateUser:N}=re(),v=De(),c=i(!1),O=i(a==null?void 0:a.data.id),V=i((A=a==null?void 0:a.data)==null?void 0:A.name),f=i((L=a==null?void 0:a.data)==null?void 0:L.image),h=i(null),x=i((W=a==null?void 0:a.data)==null?void 0:W.phone),D=i((Q=a==null?void 0:a.data)==null?void 0:Q.email),S=i((Z=a==null?void 0:a.data)==null?void 0:Z.address),r=i({password:"",confirm_password:""}),_=i(!1),o=i(!1);Ee(r.value,()=>{r.value.password!==r.value.confirm_password&&r.value.confirm_password!==""&&r.value.password!==""?(_.value=!0,o.value=!0):(_.value=!1,o.value=!1)});const g=async()=>{c.value=!0;const u=await N(O.value,V.value,x.value,D.value,S.value,h.value);(u==null?void 0:u.code)===200?v.add({severity:"success",summary:"Success",detail:"Profile Updated Successfully",group:"br",life:3e3}):v.add({severity:"error",summary:"Error",detail:"Profile Updated Failed",group:"br",life:3e3}),c.value=!1},m=u=>{h.value=u.target.files[0],f.value=URL.createObjectURL(h.value)},I=async()=>{if(c.value=!0,c.value=!0,r.value.password===""||r.value.confirm_password===""){_.value=!0,o.value=!0,v.add({severity:"error",summary:"Error",detail:"Password required",group:"br",life:3e3}),c.value=!1;return}else if(r.value.password!==r.value.confirm_password){v.add({severity:"error",summary:"Error",detail:"Passwords do not match",group:"br",life:3e3}),c.value=!1,_.value=!0,o.value=!0;return}else{const u=await q(D.value,r);console.log(u),u.code==200?(r.value.password="",r.value.confirm_password="",_.value=!1,o.value=!1,c.value=!1,v.add({severity:"success",summary:"Success",detail:u.message,group:"br",life:3e3})):(c.value=!1,v.add({severity:"error",summary:"Error",detail:u.message,group:"br",life:3e3}))}};return(u,p)=>{const y=qe,j=Oe,K=Ce,B=Fe,F=ze;return b(),Pe(F,null,{default:w(()=>[n(B,{header:"General Info"},{default:w(()=>[e("form",{onSubmit:Te(g,["prevent"]),class:"grid"},[e("div",it,[e("div",nt,[s(f)?(b(),C("img",{key:0,src:`${s(f)}`,style:{height:"100px",width:"100px","border-radius":"100%","object-fit":"cover"}},null,8,rt)):(b(),C("img",ct)),e("div",ut,[dt,e("input",{class:"hidden",type:"file","v-model":s(h),id:"image",onInput:p[0]||(p[0]=d=>m(d)),accept:".png, .jpeg, .jpg"},null,40,pt)])])]),e("div",mt,[n(j,null,{default:w(()=>[n(y,{id:"name",class:"w-full",modelValue:s(V),"onUpdate:modelValue":p[1]||(p[1]=d=>X(V)?V.value=d:null)},null,8,["modelValue"]),vt]),_:1})]),e("div",ft,[n(j,null,{default:w(()=>[n(y,{id:"phone",modelValue:s(x),"onUpdate:modelValue":p[2]||(p[2]=d=>X(x)?x.value=d:null),type:"number",class:"w-full"},null,8,["modelValue"]),_t]),_:1})]),e("div",gt,[n(j,null,{default:w(()=>[n(y,{id:"email",modelValue:s(D),"onUpdate:modelValue":p[3]||(p[3]=d=>X(D)?D.value=d:null),type:"email",class:"w-full",disabled:""},null,8,["modelValue"]),bt]),_:1})]),e("div",ht,[n(j,null,{default:w(()=>[n(y,{id:"address",modelValue:s(S),"onUpdate:modelValue":p[4]||(p[4]=d=>X(S)?S.value=d:null),class:"w-full"},null,8,["modelValue"]),yt]),_:1})]),e("div",kt,[n(K,{class:"px-4",type:"submit",label:"Save",loading:s(c)},null,8,["loading"])])],32)]),_:1}),n(B,{header:"Password"},{default:w(()=>[wt,$t,e("form",{onSubmit:Te(I,["prevent"]),class:"grid form-width mx-auto"},[e("div",Tt,[n(j,null,{default:w(()=>[n(s(Se),{id:"passw",modelValue:s(r).password,"onUpdate:modelValue":p[5]||(p[5]=d=>s(r).password=d),placeholder:"Enter new password",feedback:!1,invalid:s(_),toggleMask:"",class:"w-full",inputClass:"w-full",inputStyle:{padding:"0.78rem"}},null,8,["modelValue","invalid"]),xt]),_:1})]),e("div",St,[n(j,null,{default:w(()=>[n(s(Se),{id:"password2",modelValue:s(r).confirm_password,"onUpdate:modelValue":p[6]||(p[6]=d=>s(r).confirm_password=d),placeholder:"Confirm new password",feedback:!1,invalid:s(o),toggleMask:"",class:"w-full",inputClass:"w-full",inputStyle:{padding:"0.78rem"}},null,8,["modelValue","invalid"]),It]),_:1})]),e("div",Ct,[n(K,{class:"px-4",type:"submit",label:"Save",loading:s(c)},null,8,["loading"])])],32)]),_:1})]),_:1})}}},Et=de(Dt,[["__scopeId","data-v-3cf31c8a"]]);const Pt={class:"bg-white card1"},Ut=["onClick","innerHTML"],Vt={key:1,class:"bg-white text-center text-lg"},Nt={class:"flex justify-content-between align-items-center mt-1"},jt={class:"flex gap-2 justify-content-center"},At={__name:"Notification",emits:["closeNotification"],setup(T,{emit:q}){const a=Ne(),N=ue("token"),v=i([]),c=i(1),O=i(1),V=q,f=De(),h=async o=>{var g;try{const{data:m,pending:I,error:A}=await H(`${a.public.apiUrl}/notification/update/${o.id}`,{method:"POST",headers:{Authorization:`Bearer ${N.value}`},body:{is_read:1}},"$7t93BZ4WTD"),L=localStorage.getItem("userCompany");((g=o.payload)==null?void 0:g.type)==="task_details"&&(await We({path:`/companies/${L}/spaces/${o==null?void 0:o.space_id}/projects/${o==null?void 0:o.project_id}`,query:{task_key:o==null?void 0:o.task_id}}),V("closeNotification",!1)),await x()}catch(m){console.log(m)}},x=async()=>{try{const{data:o,pending:g,error:m}=await H(`${a.public.apiUrl}/notification/list?limit=5&page=${c.value}`,{method:"GET",headers:{Authorization:`Bearer ${N.value}`}},"$k6rqquZm3L");o.value&&(v.value=o.value.data,O.value=Math.ceil(o.value.total/5))}catch(o){console.log(o)}};(async()=>{await x()})();const S=i(!1),r=async()=>{S.value=!0;try{const{data:o,pending:g,error:m}=await H(`${a.public.apiUrl}/notification/read-all`,{method:"GET",headers:{Authorization:`Bearer ${N.value}`}},"$tGKn2qfAO6");o.value&&(await x(),f.add({severity:"success",summary:"Successful",detail:"All notifications marked as read",group:"br",life:3e3}),S.value=!1)}catch(o){console.log(o),S.value=!1,f.add({severity:"error",summary:"Error",detail:"Something went wrong!",group:"br",life:3e3})}},_=async o=>{o==="prev"&&c.value>1?c.value-=1:c.value+=1,await x()};return(o,g)=>{const m=Ce;return b(),C("div",Pt,[s(v).length>0?(b(!0),C(Ge,{key:0},He(s(v),I=>(b(),C("div",{key:I,class:""},[e("div",{onClick:A=>h(I),innerHTML:I.title,class:ee(`title ${I.is_read===0?"unread":""}`)},null,10,Ut)]))),128)):(b(),C("div",Vt," No notifications! ")),e("div",Nt,[n(m,{class:"invisible",label:"Read All"}),e("div",jt,[n(m,{onClick:g[0]||(g[0]=I=>_("prev")),disabled:s(c)===1,icon:"pi pi-chevron-left",outlined:"","aria-label":"Filter"},null,8,["disabled"]),n(m,{onClick:g[1]||(g[1]=I=>_("")),disabled:s(O)===s(c)||!s(v).length>0,icon:"pi pi-chevron-right",outlined:"","aria-label":"Filter"},null,8,["disabled"])]),n(m,{class:"bg-white hover:bg-gray-200 text-indigo-500 hover:text-indigo-600",label:"Read All",onClick:r,loading:s(S)},null,8,["loading"])])])}}},Lt=de(At,[["__scopeId","data-v-1f32d7a9"]]);const $=T=>(Ue("data-v-771f8b8b"),T=T(),Ve(),T),Bt={class:"layout-topbar"},Mt=$(()=>e("img",{src:st,alt:"logo"},null,-1)),Rt=$(()=>e("i",{class:"pi pi-bars"},null,-1)),qt=[Rt],Ot={class:"p-link layout-topbar-menu-button layout-topbar-button"},Ft=$(()=>e("i",{class:"pi pi-bell"},null,-1)),zt=[Ft],Gt=$(()=>e("i",{class:"pi pi-ellipsis-v"},null,-1)),Ht=[Gt],Wt={key:0,class:"flex align-items-center gap-2"},Qt={class:"userImage"},Zt=["src"],Kt={key:1,src:je,alt:"",style:{height:"50px",width:"50px","border-radius":"50%","object-fit":"cover"}},Yt=$(()=>e("span",{class:"ml-4"},"Profile",-1)),Jt={class:"relative"},Xt={key:0,class:"ping-container"},eo=$(()=>e("span",{class:"ping-outer"},null,-1)),to=$(()=>e("span",{class:"ping-inner"},null,-1)),oo=[eo,to],ao=$(()=>e("i",{class:"pi pi-bell"},null,-1)),so=$(()=>e("span",{class:"ml-4"},"Notification",-1)),lo=[ao,so],io={key:1,class:"notification"},no={class:"clock-wrapper relative ml-2"},ro=$(()=>e("i",{class:ee("pi pi-stop text-white"),style:{"font-size":"11px","font-weight":"700"}},null,-1)),co=[ro],uo={class:"text-sm absolute text-black time-int",id:"timer-interval"},po=$(()=>e("i",{class:"pi pi-sign-out"},null,-1)),mo=$(()=>e("span",null,"Sign Out",-1)),vo=[po,mo],fo={__name:"AppTopbar",setup(T){var _e,ge;const{getStoreTimer:q}=Ie(),{timerData:a,isTImerStopped:N}=le(Ie()),{getUserData:v}=re(),{userProfile:c}=le(re()),{layoutConfig:O,onMenuToggle:V}=lt(),f=i(null),h=i(!1),x=Qe(),D=Ne();i("name"),i(null);const{logUserOut:S}=ce();le(ce());const r=i(!1),_=i(!1),o=i(!1),g=()=>{S(),location.reload(),x.push("/login")};xe(()=>{A()}),Ze(()=>{L()});const m=()=>{h.value=!h.value},I=Ke(()=>({"layout-topbar-menu-mobile-active":h.value})),A=()=>{f.value||(f.value=l=>{W(l)&&(h.value=!1)},document.addEventListener("click",f.value))},L=()=>{f.value&&(document.removeEventListener("click",f),f.value=null)},W=l=>{if(!h.value)return;const t=document.querySelector(".layout-topbar-menu"),k=document.querySelector(".layout-topbar-menu-button");return!(t.isSameNode(l.target)||t.contains(l.target)||k.isSameNode(l.target)||k.contains(l.target))},Q=()=>{o.value&&(o.value=!1,y.value=!1)},Z=l=>{o.value=l},u={beforeMount(l,t){l.clickOutsideEvent=k=>{l==k.target||l.contains(k.target)||t.value(k)},document==null||document.body.addEventListener("click",l.clickOutsideEvent)},unmounted(l){var t;(t=document==null?void 0:document.body)==null||t.removeEventListener("click",l.clickOutsideEvent)}};xe(()=>{const l=document.querySelector(".relative");u==null||u.beforeMount(l,{value:Q})}),Ye(()=>{const l=document.querySelector(".relative");u==null||u.unmounted(l)}),v();const p=()=>{r.value=!r.value};Je();const y=i(!1);(async()=>{const l=ue("token");try{const{data:t,pending:k,error:R}=await H(`${D.public.apiUrl}/notification/list?limit=5&page=1`,{method:"GET",headers:{Authorization:`Bearer ${l.value}`}},"$QWEnQlnRVH");t.value&&(console.log("notification data =>",t.value),t.value.data.find(Y=>Y.is_read===0)?y.value=!0:y.value=!1,console.log("notification data =>",y.value))}catch(t){console.log(t)}})();const K=()=>{o.value=!o.value,y.value&&(y.value=!1)};i(!1);const B=i(),F=i(),d=i(),E=i(),pe=localStorage.getItem("storeTaskCompanyID"),me=localStorage.getItem("storeTaskSpaceID"),ve=localStorage.getItem("storeTaskProjectID"),fe=localStorage.getItem("storeTaskID");console.log("timerTaskId",E.value);const Ae=i(),te=i();(async()=>{const l=ue("token");try{const{data:t,pending:k,error:R}=await H(`${D.public.apiUrl}/tasks/timer-history`,{method:"GET",headers:{Authorization:`Bearer ${l.value}`}},"$h9G4Eef10F");t.value&&(console.log("active timer data =>",t.value),Ae.value=t.value.data.is_timer_start,t.value.data.is_timer_start==="true"&&(B.value=t.value.data.company_id,F.value=t.value.data.space_id,d.value=t.value.data.project_id,E.value=t.value.data.task_id,te.value=t.value.data.start_time),console.log("fetchedTimerData",t.value.data),console.log("timerTaskId",E.value))}catch(t){console.log(t)}})();const Le=i();a.value&&(console.log("from Pinia"),Le.value=(_e=a.value)==null?void 0:_e.task_id),console.log("timerDatPPPa",(ge=a.value)==null?void 0:ge.task_id),fe&&(console.log("from Store"),E.value=fe),pe&&(B.value=pe),me&&(F.value=me),ve&&(d.value=ve),Ee(a,(l,t)=>{console.log("timerDataWW",t),t&&(E.value=t.task_id)});let M=null;function oe(l){const t=document.getElementById("timer-interval");if(l==="stop"){console.log("timerSTime",l),M&&(clearInterval(M),M=null);return}else{let R=function(){const z=new Date-k,ae=Math.floor(z/(1e3*60*60)),G=Math.floor(z%(1e3*60*60)/(1e3*60)),J=Math.floor(z%(1e3*60)/1e3);return`${String(ae).padStart(2,"0")}:${String(G).padStart(2,"0")}:${String(J).padStart(2,"0")}`};const k=new Date(l);return t&&(t.style.visibility="hidden"),setTimeout(()=>{t&&(t.style.visibility="visible")},1e3),M&&clearInterval(M),M=setInterval(()=>{t&&(t.textContent=R())},1e3),R()}}return q(),Xe(async()=>{N.value===!0&&(E.value=null,oe("stop"),console.log("timerTaskIdFOLO",E.value)),a.value||E.value?(_.value=!0,console.log("timerData")):_.value=!1}),(l,t)=>{var J,se,be,he,ye,ke,we;const k=Me,R=et("router-link"),Y=Re,z=Et,ae=at,G=tt("tooltip");return b(),C("div",Bt,[n(k,{position:"bottom-right",group:"br"}),n(R,{to:"/",class:"layout-topbar-logo"},{default:w(()=>[Mt]),_:1}),e("button",{class:"p-link layout-menu-button layout-topbar-button",onClick:t[0]||(t[0]=P=>s(V)())},qt),e("div",Ot,[e("button",{class:"nav-btn",onClick:t[1]||(t[1]=P=>m())},zt),e("button",{class:"nav-btn",onClick:t[2]||(t[2]=P=>m())},Ht)]),e("div",{class:ee(["layout-topbar-menu",I.value])},[e("button",{onClick:p,class:"p-link layout-topbar-button"},[(se=(J=s(c))==null?void 0:J.data)!=null&&se.image?ie((b(),C("div",Wt,[e("div",Qt,[e("img",{src:`${(he=(be=s(c))==null?void 0:be.data)==null?void 0:he.image}`,class:"",style:{height:"100%",width:"100%","object-fit":"cover"}},null,8,Zt)])])),[[G,{value:"Profile"},void 0,{bottom:!0}]]):ie((b(),C("img",Kt,null,512)),[[G,{value:"Profile"},void 0,{bottom:!0}]]),Yt]),e("div",Jt,[y.value?(b(),C("div",Xt,oo)):ne("",!0),e("button",{class:"p-link layout-topbar-button notify-btn",onClick:K},lo),o.value?(b(),C("div",io,[n(Lt,{onCloseNotification:t[3]||(t[3]=P=>Z(P))})])):ne("",!0)]),_.value?ie((b(),Pe(Y,{key:0,to:{path:`/companies/${B.value}/spaces/${s(a)?(ye=s(a))==null?void 0:ye.space_id:F.value}/projects/${s(a)?(ke=s(a))==null?void 0:ke.project_id:d.value}`,query:{task_key:s(a)?(we=s(a))==null?void 0:we.task_id:E.value}},class:"flex absolute gap-2 align-items-center task-timer-wrapper mr-2"},{default:w(()=>{var P,$e;return[e("div",no,[e("div",{class:ee("clock-btn bg-pink-300"),onClick:t[4]||(t[4]=(...Be)=>l.handleClickClock&&l.handleClickClock(...Be))},co),e("div",uo,ot((P=s(a))!=null&&P.timerStartTime?oe(($e=s(a))==null?void 0:$e.timerStartTime):te.value?oe(te.value):" "),1)])]}),_:1},8,["to"])),[[G,{value:"Active Task"},void 0,{left:!0}]]):ne("",!0),e("button",{onClick:g,class:"p-link layout-topbar-button"},vo)],2),n(ae,{visible:r.value,"onUpdate:visible":t[5]||(t[5]=P=>r.value=P),modal:"",header:"Profile",style:{width:"65rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:w(()=>[n(z,{userProfile:s(c)},null,8,["userProfile"])]),_:1},8,["visible"])])}}},Ho=de(fo,[["__scopeId","data-v-771f8b8b"]]);export{Ho as default};
