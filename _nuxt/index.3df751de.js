import M from"./toast.esm.f19bf4ed.js";import E from"./multiselect.esm.1030f68d.js";import N from"./calendar.esm.1c4ecf70.js";import U from"./button.esm.3a085482.js";import R from"./toolbar.esm.d64061ab.js";import A from"./column.esm.cfeeb9c2.js";import O from"./datatable.esm.0d14c58e.js";import{a2 as Y,a5 as z,$ as h,a6 as G,a7 as W,b as F,i as s,l as a,w as k,u as f,e as H,F as L,o as I,a9 as x,a3 as q,a4 as J,ca as K}from"./entry.b2a4041b.js";import{u as P}from"./fetch.23c85bb7.js";import{u as V}from"./cookie.380282ca.js";import{u as Q}from"./workCompany.1c6f0dca.js";import"./radiobutton.esm.4f60c464.js";import"./portal.esm.0de5c3f0.js";import"./basecomponent.esm.829b4526.js";import"./index.esm.7bb81bf2.js";import"./baseicon.esm.e325aaf4.js";import"./index.esm.e3c3007f.js";import"./index.esm.100899b1.js";import"./index.esm.5fb973ac.js";import"./checkbox.esm.376cb753.js";import"./index.esm.fe6ace7a.js";import"./index.esm.09e4115b.js";import"./index.esm.80d85b39.js";import"./overlayeventbus.esm.b7aad6b0.js";import"./virtualscroller.esm.997faafe.js";import"./index.esm.aa951afc.js";import"./index.esm.9f203600.js";import"./index.esm.3298dc10.js";import"./badge.esm.ffc47534.js";import"./paginator.esm.34052c81.js";import"./index.esm.ff5d8fdc.js";import"./dropdown.esm.7223ba0f.js";import"./inputnumber.esm.4d18eff9.js";import"./index.esm.4b694598.js";import"./index.esm.29cbf9a5.js";import"./inputtext.esm.c95e8212.js";import"./index.esm.8ee8945f.js";import"./index.esm.aad21f4f.js";import"./index.esm.548a8ec7.js";import"./index.esm.659a5795.js";const b=D=>(q("data-v-7b8d62db"),D=D(),J(),D),X={class:"card"},Z=b(()=>s("div",{class:"d-flex mr-2"},[s("h5",{class:"mb-1"},"Task Reports")],-1)),ee={class:"flex gap-2 flex-wrap"},te={class:"user-selection w-full md:w-14rem w-full"},ae=b(()=>s("label",{class:"font-bold block mb-2"},"Project:",-1)),oe={class:"flex justify-content-center"},le={class:"flex-auto"},se=b(()=>s("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),re={class:"flex-auto"},ne=b(()=>s("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),ie={key:0,class:"card"},de={class:"flex align-items-center justify-content-between gap-2 mb-5"},ce=b(()=>s("h5",{class:"m-0"},"Preview",-1)),ue=b(()=>s("p",{class:"text-center"},"No Data found...",-1)),pe={__name:"index",setup(D){const{totalProjects:B}=z(Q()),j=K(),n=h(""),i=h(""),u=h(),S=h(null),v=h(!1),g=h(!1),w=G(),y=p=>{const t=p,o=new Date(t),r=o.getFullYear(),c=String(o.getMonth()+1).padStart(2,"0"),m=String(o.getDate()).padStart(2,"0");return`${r}-${c}-${m}`},T=async()=>{var _,e;if(n.value&&!i.value||!n.value&&i.value)return v.value=!1,w.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const p=V("token");v.value=!0;const t=y(n.value),o=y(i.value),r=new FormData;if(u.value&&u.value.length>0){const d=(_=u.value)==null?void 0:_.map(l=>l.id);console.log("Project ID",d),d.length>0&&d.forEach(l=>{r.append("project_id[]",l)})}n.value&&i.value&&(r.append("start_due_date",t),r.append("end_due_date",o));const{data:c,error:m}=await P(`${j.public.apiUrl}/tasks/project-wise-task-report-view`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:r},"$y5Dl6B2mhy");return((e=c.value)==null?void 0:e.code)==200?(S.value=c.value.data.map((d,l)=>({...d,index:l+1})),v.value=!1):(v.value=!1,w.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},C=async()=>{var _;const p=V("token");if(g.value=!0,n.value&&!i.value||!n.value&&i.value)return v.value=!1,w.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const t=y(n.value),o=y(i.value),r=new FormData;if(u.value&&u.value.length>0){const e=(_=u.value)==null?void 0:_.map(d=>d.id);console.log("Project ID",e),e.length>0&&e.forEach(d=>{r.append("project_id[]",d)})}n.value&&i.value&&(r.append("start_due_date",t),r.append("end_due_date",o));const{data:c,error:m}=await P(`${j.public.apiUrl}/tasks/project-wise-task-report-download`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:r},"$h7a31M7TcS");if(m.value)return console.log(m),g.value=!1;if(c.value.code==200){const e=document.createElement("a");return e.href=c.value.download_path,e.target="_blank",e.click(),g.value=!1}else return g.value=!1,w.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},$=(p,t)=>{const o=new Date(t);p=="startDate"?n.value=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate():i.value=o.getFullYear()+"-"+(o.getMonth()+1)+"-"+o.getDate()};return W(()=>{}),(p,t)=>{const o=M,r=E,c=N,m=U,_=R,e=A,d=O;return I(),F(L,null,[s("div",X,[a(o,{position:"bottom-right",group:"br"}),Z,a(_,{class:"border-0 px-0"},{start:k(()=>[s("div",ee,[s("div",te,[ae,s("div",oe,[a(r,{display:"chip",modelValue:f(u),"onUpdate:modelValue":t[0]||(t[0]=l=>x(u)?u.value=l:null),options:f(B),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full"},null,8,["modelValue","options"])])]),s("div",le,[se,a(c,{modelValue:f(n),"onUpdate:modelValue":t[1]||(t[1]=l=>x(n)?n.value=l:null),onDateSelect:t[2]||(t[2]=l=>$("startDate",l)),clearButton:"true",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),s("div",re,[ne,a(c,{modelValue:f(i),"onUpdate:modelValue":t[3]||(t[3]=l=>x(i)?i.value=l:null),onDateSelect:t[4]||(t[4]=l=>$("endtDate",l)),clearButton:"",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:k(()=>[a(m,{onClick:T,class:"w-full",label:"Generate",loading:f(v)},null,8,["loading"])]),_:1})]),f(S)?(I(),F("div",ie,[s("div",null,[s("div",de,[ce,a(m,{onClick:C,class:"w-fit",label:"Download",loading:f(g)},null,8,["loading"])]),a(d,{value:f(S),tableStyle:"min-width: 50rem"},{empty:k(()=>[ue]),default:k(()=>[a(e,{field:"index",header:"Serial",sortable:""}),a(e,{field:"task_name",style:{width:"40%"},header:"Task Name"}),a(e,{field:"project_name",header:"Project Name"}),a(e,{field:"task_status",header:"Status"}),a(e,{field:"task_due_date",header:"Due Date"}),a(e,{field:"task_date_done",header:"Date Done"}),a(e,{field:"duration",header:"Duration"}),a(e,{field:"unit",header:"Unit"}),a(e,{field:"overdue",header:"Missed Deadlines"})]),_:1},8,["value"])])])):H("",!0)],64)}}},Ze=Y(pe,[["__scopeId","data-v-7b8d62db"]]);export{Ze as default};
