import O from"./toast.esm.5dc71a33.js";import W from"./multiselect.esm.1d20d229.js";import Y from"./calendar.esm.eeb5add6.js";import G from"./button.esm.abab2e56.js";import J from"./toolbar.esm.268e3631.js";import Z from"./column.esm.b53e6919.js";import q from"./datatable.esm.864d849a.js";import{a2 as H,a3 as K,$ as f,a4 as Q,a5 as X,b as I,i as a,l as s,w as V,u,e as ee,F as E,o as C,a6 as S,f as te,t as ae,a7 as oe,a8 as le,ca as se}from"./entry.f1432a2a.js";import{u as U,a as A,b as ne}from"./cookie.77e74766.js";import{u as re}from"./workCompany.d48e3480.js";import ie from"./radiobutton.esm.50e6095c.js";import"./portal.esm.5e8ef618.js";import"./basecomponent.esm.04418346.js";import"./index.esm.eb1bb595.js";import"./baseicon.esm.92de54f6.js";import"./index.esm.fbc55618.js";import"./index.esm.71c98fdf.js";import"./index.esm.4e586947.js";import"./checkbox.esm.acb3f1da.js";import"./index.esm.2d8ac583.js";import"./index.esm.174d39f4.js";import"./index.esm.89ec1556.js";import"./overlayeventbus.esm.8048f420.js";import"./virtualscroller.esm.68573553.js";import"./index.esm.3ac2ff7d.js";import"./index.esm.2a2d3670.js";import"./index.esm.8d2ea0d4.js";import"./badge.esm.1e5cad43.js";import"./paginator.esm.9c87019d.js";import"./index.esm.63a4602f.js";import"./dropdown.esm.cf69eb0f.js";import"./inputnumber.esm.f8e39e21.js";import"./index.esm.17e0bb74.js";import"./index.esm.ad2f1f7b.js";import"./inputtext.esm.4cb16f76.js";import"./index.esm.05649094.js";import"./index.esm.dc39e258.js";import"./index.esm.be68a3b0.js";import"./index.esm.6d23dde7.js";const h=x=>(oe("data-v-91aa4172"),x=x(),le(),x),de={class:"card"},ue=h(()=>a("div",{class:"d-flex mr-2"},[a("h5",{class:"mb-1"},"User Reports")],-1)),ce={class:"flex gap-2 flex-wrap"},pe={class:"user-selection w-full md:w-14rem w-full"},me=h(()=>a("label",{class:"font-bold block mb-2"},"User:",-1)),fe={class:"flex justify-content-center"},_e={class:"user-selection w-full md:w-14rem w-full"},ve=h(()=>a("label",{class:"font-bold block mb-2"},"Project:",-1)),he={class:"flex justify-content-center"},ge={class:"flex-auto"},be=h(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),ye={class:"flex-auto"},De=h(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),ke={class:"flex-auto ml-2"},we=h(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"Date Type: ",-1)),Se={class:"flex flex-wrap gap-2 mt-3 mb-2 text-sm"},xe=["for"],$e={key:0,class:"card"},Ie={class:"flex align-items-center justify-content-between gap-2 mb-5"},Ve=h(()=>a("h5",{class:"m-0"},"Preview",-1)),Ce=h(()=>a("p",{class:"text-center"},"No Data found...",-1)),Fe={__name:"index",setup(x){const{totalProjects:M}=K(re()),F=se(),c=f(""),w=f("Create"),R=f([{name:"Create",key:"A"},{name:"Due Date",key:"B"}]),p=f(""),g=f(""),_=f(),T=f([]),P=f(null),y=f(!1),D=f(!1),k=Q(),$=m=>{const t=m,l=new Date(t),o=l.getFullYear(),r=String(l.getMonth()+1).padStart(2,"0"),i=String(l.getDate()).padStart(2,"0");return`${o}-${r}-${i}`},N=async()=>{var n,b,e;if(g.value=="")return k.add({severity:"warn",summary:"Warning",detail:"Please Select User First",group:"br",life:3e3});if(c.value&&!p.value||!c.value&&p.value)return y.value=!1,k.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const m=U("token");y.value=!0;const t=$(c.value),l=$(p.value),o=new FormData,r=(n=g.value)==null?void 0:n.map(d=>d.id);if(console.log("User ID",r),r.forEach(d=>{o.append("user_id[]",d)}),_.value&&_.value.length>0){const d=(b=_.value)==null?void 0:b.map(j=>j.id);console.log("Project ID",d),d.length>0&&d.forEach(j=>{o.append("project_id[]",j)})}c.value&&p.value&&(w.value=="Create"?(o.append("start_date",t),o.append("end_date",l)):(o.append("start_due_date",t),o.append("end_due_date",l)));const{data:i,error:v}=await A(`${F.public.apiUrl}/tasks/task-report-view`,{method:"POST",headers:{Authorization:`Bearer ${m.value}`},body:o},"$3y9pxb6gbv");return((e=i.value)==null?void 0:e.code)==200?(P.value=i.value.data,y.value=!1):(y.value=!1,k.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},z=async()=>{var n,b;const m=U("token");if(D.value=!0,g.value=="")return D.value=!1,k.add({severity:"error",summary:"Failed",detail:"Please Select Employee",group:"br",life:3e3});if(c.value&&!p.value||!c.value&&p.value)return y.value=!1,k.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const t=$(c.value),l=$(p.value),o=new FormData,r=(n=g.value)==null?void 0:n.map(e=>e.id);if(console.log("User ID",r),r.forEach(e=>{o.append("user_id[]",e)}),_.value&&_.value.length>0){const e=(b=_.value)==null?void 0:b.map(d=>d.id);console.log("Project ID",e),e.length>0&&e.forEach(d=>{o.append("project_id[]",d)})}c.value&&p.value&&(w.value=="Create"?(o.append("start_date",t),o.append("end_date",l)):(o.append("start_due_date",t),o.append("end_due_date",l)));const{data:i,error:v}=await A(`${F.public.apiUrl}/tasks/task-report-download`,{method:"POST",headers:{Authorization:`Bearer ${m.value}`},body:o},"$JMgttPZ06P");if(v.value)return console.log(v),D.value=!1;if(i.value.code==200){const e=document.createElement("a");return e.href=i.value.download_path,e.target="_blank",e.click(),D.value=!1}else return D.value=!1,k.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},B=(m,t)=>{const l=new Date(t);m=="startDate"?c.value=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate():p.value=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()},L=async()=>{var r,i,v;const m=U("token"),{data:t,pending:l,error:o}=await ne("taskAssignModalData",()=>$fetch(`${F.public.apiUrl}/users/list`,{headers:{Authorization:`Bearer ${m.value}`}}));((i=(r=t.value)==null?void 0:r.data)==null?void 0:i.length)>0&&(T.value=(v=t.value)==null?void 0:v.data)};return X(()=>{L()}),(m,t)=>{const l=O,o=W,r=Y,i=G,v=J,n=Z,b=q;return C(),I(E,null,[a("div",de,[s(l,{position:"bottom-right",group:"br"}),ue,s(v,{class:"border-0 px-0"},{start:V(()=>[a("div",ce,[a("div",pe,[me,a("div",fe,[s(o,{display:"chip",modelValue:u(g),"onUpdate:modelValue":t[0]||(t[0]=e=>S(g)?g.value=e:null),options:u(T),filter:"",optionLabel:"name",placeholder:"Select User",class:"w-full"},null,8,["modelValue","options"])])]),a("div",_e,[ve,a("div",he,[s(o,{display:"chip",modelValue:u(_),"onUpdate:modelValue":t[1]||(t[1]=e=>S(_)?_.value=e:null),options:u(M),filter:"",optionLabel:"name",placeholder:"Select Project",class:"w-full"},null,8,["modelValue","options"])])]),a("div",ge,[be,s(r,{modelValue:u(c),"onUpdate:modelValue":t[2]||(t[2]=e=>S(c)?c.value=e:null),onDateSelect:t[3]||(t[3]=e=>B("startDate",e)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),a("div",ye,[De,s(r,{modelValue:u(p),"onUpdate:modelValue":t[4]||(t[4]=e=>S(p)?p.value=e:null),onDateSelect:t[5]||(t[5]=e=>B("endtDate",e)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),a("div",ke,[we,a("div",Se,[(C(!0),I(E,null,te(u(R),e=>(C(),I("div",{key:e.key,class:"flex align-items-center"},[s(u(ie),{modelValue:u(w),"onUpdate:modelValue":t[6]||(t[6]=d=>S(w)?w.value=d:null),inputId:e.key,name:"dynamic",value:e.name},null,8,["modelValue","inputId","value"]),a("label",{for:e.key,class:"ml-2"},ae(e.name),9,xe)]))),128))])])])]),end:V(()=>[s(i,{onClick:N,class:"w-full",label:"Generate",loading:u(y)},null,8,["loading"])]),_:1})]),u(P)?(C(),I("div",$e,[a("div",null,[a("div",Ie,[Ve,s(i,{onClick:z,class:"w-fit",label:"Download",loading:u(D)},null,8,["loading"])]),s(b,{value:u(P),tableStyle:"min-width: 50rem"},{empty:V(()=>[Ce]),default:V(()=>[s(n,{field:"task_name",header:"Task"}),s(n,{field:"project_name",header:"Project"}),s(n,{field:"assignee_name",header:"Assignee"}),s(n,{field:"task_status",header:"Status"}),s(n,{field:"task_due_date",header:"Due Date"}),s(n,{field:"task_date_done",header:"Completed Date"}),s(n,{field:"formatted_time_tracked",header:"Time Track"}),s(n,{field:"overdue",header:"Over Due"}),s(n,{field:"bounce",header:"Bounce"})]),_:1},8,["value"])])])):ee("",!0)],64)}}},vt=H(Fe,[["__scopeId","data-v-91aa4172"]]);export{vt as default};
