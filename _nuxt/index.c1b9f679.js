import E from"./toast.esm.4e99d986.js";import M from"./dropdown.esm.95d4a155.js";import j from"./calendar.esm.7662586a.js";import N from"./button.esm.55d690cc.js";import R from"./toolbar.esm.07cf8547.js";import z from"./column.esm.bcc460f0.js";import G from"./datatable.esm.ebe93f42.js";import{a2 as Y,$ as _,a4 as W,a5 as J,b as C,i as o,l as t,w as D,u as c,e as L,F as O,o as U,a6 as S,a7 as Z,a8 as q,ca as H}from"./entry.e1c0e88c.js";import{u as x,a as T,b as K}from"./cookie.4ac610cc.js";import"./portal.esm.afd7e75b.js";import"./basecomponent.esm.3d4eb624.js";import"./index.esm.ed66ea6d.js";import"./baseicon.esm.9d7b2230.js";import"./index.esm.a7dfedeb.js";import"./index.esm.9f6fb2c0.js";import"./index.esm.500ed3bc.js";import"./index.esm.a7c42a2e.js";import"./index.esm.7e6d68a5.js";import"./index.esm.19bbf2cf.js";import"./overlayeventbus.esm.fda4f9be.js";import"./virtualscroller.esm.b9c663eb.js";import"./index.esm.572cdd6a.js";import"./index.esm.10b96bd7.js";import"./index.esm.408c5cec.js";import"./badge.esm.782a7e7b.js";import"./paginator.esm.652ac4fa.js";import"./index.esm.281f3650.js";import"./inputnumber.esm.72c2fd77.js";import"./index.esm.d2a1dc5f.js";import"./index.esm.b432fde7.js";import"./inputtext.esm.8047d0d2.js";import"./index.esm.7f6ac9fd.js";import"./index.esm.8373fc69.js";import"./checkbox.esm.6eeb32a6.js";import"./radiobutton.esm.dda9b8c2.js";import"./index.esm.33125ab0.js";import"./index.esm.8c54b7f1.js";const h=g=>(Z("data-v-f5dd5ee2"),g=g(),q(),g),Q={class:"card"},X=h(()=>o("div",{class:"d-flex mr-2"},[o("h5",{class:"mb-1"},"User Reports")],-1)),ee={class:"flex gap-2 flex-wrap"},te={class:"user-selection w-full md:w-14rem w-full"},ae=h(()=>o("label",{class:"font-bold block mb-2"},"User:",-1)),oe={class:"flex justify-content-center"},le={class:"flex-auto"},se=h(()=>o("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),re={class:"flex-auto"},ne=h(()=>o("label",{for:"icondisplay",class:"font-bold block mb-2"}," To: ",-1)),ie={key:0,class:"card"},de={class:"flex align-items-center justify-content-between gap-2 mb-5"},ue=h(()=>o("h5",{class:"m-0"},"Preview",-1)),ce=h(()=>o("p",{class:"text-center"},"No Data found...",-1)),pe={__name:"index",setup(g){const k=H(),s=_(""),r=_(""),p=_(""),F=_([]),$=_(null),b=_(!1),m=_(!1),v=W(),y=n=>{const e=n,a=new Date(e),f=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0");return`${f}-${i}-${l}`},B=async()=>{if(p.value=="")return v.add({severity:"warn",summary:"Warning",detail:"Please Select User First",group:"br",life:3e3});if(s.value==""||r.value=="")return v.add({severity:"warn",summary:"Warning",detail:"Please Select Start Date and End Date",group:"br",life:3e3});const n=x("token");b.value=!0,y(s.value),y(r.value);const{data:e,error:a}=await T(`${k.public.apiUrl}/tasks/task-report-view?start_date=${s.value}&end_date=${r.value}&user_id=${p.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${n.value}`}},"$3y9pxb6gbv");return e.value.code==200?($.value=e.value.data,b.value=!1):(b.value=!1,v.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3}))},I=async()=>{const n=x("token");if(m.value=!0,p.value=="")return m.value=!1,v.add({severity:"error",summary:"Failed",detail:"Please Select Employee",group:"br",life:3e3});if(s.value==""&&r.value!=="")return m.value=!1,v.add({severity:"error",summary:"Failed",detail:"Please Select Start Date",group:"br",life:3e3});const e=y(s.value),a=y(r.value),{data:f,error:i}=await T(`${k.public.apiUrl}/tasks/task-report-download?user_id=${p.value.id}${s.value!==""?`&start_date=${e}`:""}${r.value!==""?`&end_date=${a}`:""}`,{headers:{Authorization:`Bearer ${n.value}`}},"$JMgttPZ06P");if(i.value)return console.log(i),m.value=!1;if(f.value.code==200){const l=document.createElement("a");return l.href=f.value.download_path,l.target="_blank",l.click(),m.value=!1}else return m.value=!1,v.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},V=(n,e)=>{const a=new Date(e);n=="startDate"?s.value=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate():r.value=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()},P=async()=>{var i,l,w;const n=x("token"),{data:e,pending:a,error:f}=await K("taskAssignModalData",()=>$fetch(`${k.public.apiUrl}/users/list`,{headers:{Authorization:`Bearer ${n.value}`}}));((l=(i=e.value)==null?void 0:i.data)==null?void 0:l.length)>0&&(F.value=(w=e.value)==null?void 0:w.data)};return J(()=>{P()}),(n,e)=>{const a=E,f=M,i=j,l=N,w=R,d=z,A=G;return U(),C(O,null,[o("div",Q,[t(a,{position:"bottom-right",group:"br"}),X,t(w,{class:"border-0 px-0"},{start:D(()=>[o("div",ee,[o("div",te,[ae,o("div",oe,[t(f,{modelValue:c(p),"onUpdate:modelValue":e[0]||(e[0]=u=>S(p)?p.value=u:null),options:c(F),optionLabel:"name",placeholder:"Select/Search User",class:"w-full md:w-14rem"},null,8,["modelValue","options"])])]),o("div",le,[se,t(i,{modelValue:c(s),"onUpdate:modelValue":e[1]||(e[1]=u=>S(s)?s.value=u:null),onDateSelect:e[2]||(e[2]=u=>V("startDate",u)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),o("div",re,[ne,t(i,{modelValue:c(r),"onUpdate:modelValue":e[3]||(e[3]=u=>S(r)?r.value=u:null),onDateSelect:e[4]||(e[4]=u=>V("endtDate",u)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:D(()=>[t(l,{onClick:B,class:"w-full",label:"Generate",loading:c(b)},null,8,["loading"])]),_:1})]),c($)?(U(),C("div",ie,[o("div",null,[o("div",de,[ue,t(l,{onClick:I,class:"w-fit",label:"Download",loading:c(m)},null,8,["loading"])]),t(A,{value:c($),tableStyle:"min-width: 50rem"},{empty:D(()=>[ce]),default:D(()=>[t(d,{field:"task_name",header:"Task"}),t(d,{field:"project_name",header:"Project"}),t(d,{field:"assignee_name",header:"Assignee"}),t(d,{field:"task_status",header:"Status"}),t(d,{field:"task_due_date",header:"Due Date"}),t(d,{field:"task_date_done",header:"Completed Date"}),t(d,{field:"formatted_time_tracked",header:"Time Track"}),t(d,{field:"overdue",header:"Over Due"}),t(d,{field:"bounce",header:"Bounce"})]),_:1},8,["value"])])])):L("",!0)],64)}}},He=Y(pe,[["__scopeId","data-v-f5dd5ee2"]]);export{He as default};
