import Ce from"./toast.esm.a949a884.js";import $e from"./dropdown.esm.86f50d1a.js";import Fe from"./calendar.esm.d2ab0d31.js";import be from"./button.esm.02c969f5.js";import Se from"./inputtext.esm.df1ed0e5.js";import Te from"./tabpanel.esm.ed24b913.js";import Ee from"./textarea.esm.8229b6ad.js";import{a2 as Me,a3 as Ke,a4 as he,$ as n,aq as qe,a as Pe,o as $,b as j,i as e,t as H,u as l,l as t,a6 as J,q as pe,e as K,I as me,F as _e,f as we,s as ke,a7 as Ie,a8 as Ae,ca as ye,w as b,c as Z,a5 as Le}from"./entry.f0c5cf2a.js";import{u as P,a as R,b as Be}from"./cookie.151b076d.js";import{u as De}from"./user.3d505962.js";import Oe from"./toolbar.esm.e29b6e89.js";import xe from"./column.esm.1ce75797.js";import Re from"./row.esm.a9acae0b.js";import Ne from"./columngroup.esm.e734fdaf.js";import Ue from"./datatable.esm.c8a0ac7e.js";import Ve from"./dialog.esm.b5cdb412.js";import Qe from"./tabview.esm.ffec7ef4.js";import je from"./progressspinner.esm.d974965d.js";import{a as se}from"./usePermission.6cb1f234.js";import"./portal.esm.b5621338.js";import"./basecomponent.esm.ed9a8dc9.js";import"./index.esm.f961079b.js";import"./baseicon.esm.a7d442d2.js";import"./index.esm.0dd784d2.js";import"./index.esm.492ad606.js";import"./index.esm.09b018b7.js";import"./index.esm.1932eccc.js";import"./index.esm.af38a3d4.js";import"./index.esm.535c9e07.js";import"./overlayeventbus.esm.f6271641.js";import"./virtualscroller.esm.f65cf989.js";import"./index.esm.540e4544.js";import"./index.esm.e1281ff7.js";import"./index.esm.0e9bb796.js";import"./badge.esm.6b4b3237.js";import"./paginator.esm.e80bd062.js";import"./index.esm.a48eb4f3.js";import"./inputnumber.esm.f13f38d5.js";import"./index.esm.e2ed82be.js";import"./index.esm.e94ddaa2.js";import"./index.esm.e8d5890c.js";import"./index.esm.5038da17.js";import"./checkbox.esm.576414ca.js";import"./radiobutton.esm.32ce14ec.js";import"./index.esm.5809deb4.js";import"./index.esm.cd2fa4b9.js";const ce=ie=>(Ie("data-v-b97fd3db"),ie=ie(),Ae(),ie),ze={class:"mx-auto",style:{"max-width":"55rem"}},We={action:"",class:"grid",style:{gap:"10px"}},Ge={class:"w-full col-12"},Ye={class:"w-full col-12 grid"},Ze={class:"col-12 md:col-5"},He=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Team Member",-1)),Je={class:"user-name"},Xe={class:"col-12 md:col-5"},el=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),ll={class:"col-12 md:col-2 flex align-items-end"},tl={key:0,class:"deadline-info mb-0 flex w-full justify-content-end"},al=ce(()=>e("span",{class:"font-bold mr-2"},"Deadline: ",-1)),ol={class:"w-full col-12 grid"},sl={class:"col-12 md:col-6"},nl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section",-1)),il={class:"user-name"},dl={class:"col-12 md:col-6"},rl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section",-1)),cl={class:"user-name"},ul={class:"col-12 md:col-6"},ml=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),pl={class:"col-12 md:col-6"},_l={for:"icondisplay",class:"font-bold block mb-2"},fl={class:"col-12"},vl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Comment",-1)),bl={class:"col-12"},hl=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"File",-1)),yl={class:"flex gap-2 align-items-center upload-wrapper w-full"},gl={key:0,class:"w-full"},kl=ce(()=>e("span",{class:"pi pi-file-import mr-2"},null,-1)),wl=["onClick"],$l=ce(()=>e("i",{class:"pi pi-times"},null,-1)),Sl=[$l],Vl=["id","onChange"],xl={class:"col-12 my-3"},Ul=ce(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Employee Self Remarks",-1)),Dl={class:"gap-2 flex justify-content-center w-full"},Cl={__name:"Submission",props:["quater"],setup(ie){const{getUserData:ee}=De(),{userProfile:ae}=Ke(De()),oe=he(),re=ye(),z=n(!1),A=n(!1),F=n(null),L=n(!1);console.log("Employee Value",L.value);const S=n(""),c=n([]),D=n([]),U=n([]),C=n([]),T=n([]),v=n([]),g=n(""),p=n([]);qe(S,_=>{_&&(L.value=!1,c.value=[],D.value=[],U.value=[],C.value=[],T.value=[],v.value=[],p.value=[],F.value=null)});const i=(_,s,V)=>{const E=Array.from(V.target.files);T.value[s]||(T.value[s]=[]),T.value[s].push(...E),v.value.includes(_.subsection_id)||v.value.push(_.subsection_id)},r=_=>{const s=document.getElementById(`submittedFiles${_}`);s&&s.click()},u=(_,s,V)=>{T.value[s]&&(T.value[s].splice(V,1),v.value=v.value.filter(E=>E!==_.subsection_id))},q=async()=>{var E,X,W,N,de,h,d;if((D.value.length>0||U.value.length>0||C.value.length>0||T.value.length>0||c.value)&&(D.value=[],U.value=[],C.value=[],T.value=[],c.value=[]),z.value=!0,S.value==="")return z.value=!1,oe.add({severity:"warn",summary:"Failed",detail:"Please select quarter",group:"br",life:3e3});const _=P("token"),{data:s,error:V}=await R(`${re.public.apiUrl}/kpi/show/${(X=(E=ae==null?void 0:ae.value)==null?void 0:E.data)==null?void 0:X.id}?quater_id=${S.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${_.value}`}},"$GEOxJeF5tI");if(console.log("Data Value",s.value),console.log("error Value",V.value),s.value)if(((N=(W=s.value)==null?void 0:W.data)==null?void 0:N.length)!==0)z.value=!1,L.value=!0,F.value=s.value,g.value=(h=(de=s.value)==null?void 0:de.line_maneger)==null?void 0:h.self_remarks,console.log("selfRemarks",g.value),(d=s.value)==null||d.data.forEach(O=>{console.log("data gotcha"),console.log("Item Value",O),O.sub_section_data.forEach(k=>{c.value.push({section_name:O.section.name,section_id:O.section.id,subSection_name:k.sub_section.title,subsection_id:k.id,target_mark:k.target_mark,mark_type:k.mark_type,quater_id:k.quater_id,achive_mark:k.achive_mark,comment:k.comment}),D.value.push(k.id),U.value.push(k.achive_mark),C.value.push(k.comment),T.value.push(null)}),console.log("Submitted Ids",D.value),console.log("Submitted submittedMarks",U.value),console.log("Submitted submittedComments",C.value),console.log("Submitted submittedFiles",T.value)}),console.log("Submission Value",s==null?void 0:s.value);else return z.value=!1,L.value=!1,oe.add({severity:"error",summary:"Failed",detail:"No data found",group:"br",life:3e3});else return console.log("erorr gotcha"),L.value=!1,z.value=!1,oe.add({severity:"error",summary:"Internal Server Error",detail:"Failed to show report",group:"br",life:3e3})},B=_=>{if(!_)return"Not Set";const s=new Date(_);if(isNaN(s))return"Invalid Date";const V={day:"2-digit",month:"short",year:"numeric"};return new Intl.DateTimeFormat("en-GB",V).format(s)},le=async()=>{var X;A.value=!0;const _=P("token"),s=new FormData;c.value.forEach((W,N)=>{console.log("SubIDSValue",D.value[N]),s.append("id[]",D.value[N]),s.append("achive_mark[]",U.value[N]),s.append("comment[]",C.value[N]),T.value[N]&&T.value[N].forEach(de=>{console.log("File Value",de),p.value.push(de)})}),p.value.forEach(W=>{console.log("File Value",W),s.append("files[]",W)}),v.value.forEach(W=>{s.append("files_id[]",W)}),s.append("self_remarks",g.value);const{data:V,error:E}=await R(`${re.public.apiUrl}/kpi/update`,{method:"POST",headers:{Authorization:`Bearer ${_.value}`},body:s},"$3n6oGZyvcV");if(((X=V.value)==null?void 0:X.code)===200){A.value=!1,L.value=!1,S.value="",D.value=[],U.value=[],C.value=[],T.value=[],v.value=[],g.value="",p.value=[],F.value=null,c.value=[],oe.add({severity:"success",summary:"Success",detail:"Submission successful!",group:"br",life:3e3});return}else return A.value=!1,oe.add({severity:"error",summary:"Failed",detail:"Failed to submit",group:"br",life:3e3})};return ee(),(_,s)=>{var de,h,d,O,k,Q;const V=$e,E=be,X=Se,W=Ee,N=Pe("tooltip");return $(),j("div",ze,[e("div",We,[e("div",Ge,[e("div",Ye,[e("div",Ze,[He,e("p",Je,H((h=(de=l(ae))==null?void 0:de.data)==null?void 0:h.name),1)]),e("div",Xe,[el,t(V,{class:"w-full",modelValue:l(S),"onUpdate:modelValue":s[0]||(s[0]=f=>J(S)?S.value=f:null),options:ie.quater,optionLabel:"name",placeholder:"Select Quarter"},null,8,["modelValue","options"])]),e("div",ll,[t(E,{class:"col-12 md:col-2 w-full",type:"submit",label:"Load",onClick:q,style:{height:"max-content",display:"flex","align-self":"end"},loading:l(z)},null,8,["loading"])])])]),l(F)?($(),j("p",tl,[al,pe(H(B((k=(O=(d=l(F))==null?void 0:d.data[0])==null?void 0:O.sub_section_data[0])==null?void 0:k.deadline)),1)])):K("",!0),l(L)?($(),j("form",{key:1,class:"card relative",onSubmit:me(le,["prevent"])},[($(!0),j(_e,null,we(l(c),(f,M)=>($(),j("div",{key:M},[e("div",ol,[e("div",sl,[nl,ke(($(),j("p",il,[pe(H(f.section_name),1)])),[[N,{value:f.section_name},void 0,{top:!0}]])]),e("div",dl,[rl,ke(($(),j("p",cl,[pe(H(f.subSection_name),1)])),[[N,{value:f.subSection_name},void 0,{top:!0}]])]),e("div",ul,[ml,t(V,{modelValue:l(S),"onUpdate:modelValue":s[1]||(s[1]=a=>J(S)?S.value=a:null),disabled:"",options:ie.quater,optionLabel:"name",placeholder:"Select Quarter",class:"w-full"},null,8,["modelValue","options"])]),e("div",pl,[e("label",_l," Achieved Mark (Target: "+H((f==null?void 0:f.target_mark)||0)+H((f==null?void 0:f.mark_type)==1?"%":0)+") ",1),t(X,{modelValue:l(U)[M],"onUpdate:modelValue":a=>l(U)[M]=a,placeholder:"Input Mark",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",fl,[vl,ke(t(W,{modelValue:l(C)[M],"onUpdate:modelValue":a=>l(C)[M]=a,id:"description",rows:"3",cols:"20",placeholder:"Write comment",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),[[N,{value:f.comment},void 0,{top:!0}]])]),e("div",bl,[hl,e("div",yl,[l(T)[M]&&l(T)[M].length?($(),j("div",gl,[($(!0),j(_e,null,we(l(T)[M],(a,o)=>($(),j("div",{key:o,class:"text-sm file-name font-semibold tracking-wide leading-3 bg-gray-300 px-3 py-2 flex align-items-center rounded relative"},[e("div",null,[kl,pe(),e("span",null,H(a.name),1)]),e("div",{onClick:y=>u(f,M,o),class:"close-comment"},Sl,8,wl)]))),128))])):K("",!0),e("div",null,[e("input",{type:"file",class:"hidden",id:`submittedFiles${M}`,onChange:a=>i(f,M,a)},null,40,Vl),t(E,{icon:"pi pi-cloud-upload",disabled:l(T)[M]&&l(T)[M].length>0,label:"Upload",onClick:a=>r(M),"aria-label":"Filter"},null,8,["disabled","onClick"])])])])])]))),128)),e("div",xl,[Ul,ke(t(W,{modelValue:l(g),"onUpdate:modelValue":s[2]||(s[2]=f=>J(g)?g.value=f:null),id:"description",rows:"5",cols:"20",placeholder:"Write your self remarks",class:"w-full"},null,8,["modelValue"]),[[N,{value:l(g)},void 0,{top:!0}]])]),e("div",Dl,[t(E,{disabled:(Q=l(F))==null?void 0:Q.isDeadlineMiss,label:"Submit",class:"bg-green-500 border-none",type:"submit",loading:l(A)},null,8,["disabled","loading"])])],32)):K("",!0)])])}}},Fl=Me(Cl,[["__scopeId","data-v-b97fd3db"]]),Tl={class:"card"},El={class:"flex gap-2 flex-wrap"},Ml={class:"user-selection w-full md:w-14rem w-full"},ql=e("label",{class:"font-bold block mb-2"},"Team Member:",-1),Il={class:"flex justify-content-center"},Al={class:"user-selection w-full md:w-14rem w-full"},Ll=e("label",{class:"font-bold block mb-2"},"Quarter:",-1),Bl={class:"flex justify-content-center"},Ql={key:0,class:"card"},Kl={class:"flex flex-wrap align-items-top justify-content-between gap-2 mb-5"},Pl={class:""},Ol={class:"font-bold"},Rl=e("td",null,"Name",-1),Nl={class:"pl-2"},jl={class:"font-bold"},zl=e("td",null,"Designation",-1),Wl={class:"pl-2"},Gl={class:"font-bold"},Yl=e("td",null,"Line Manager",-1),Zl={class:"pl-2"},Hl={class:"font-bold"},Jl=e("td",null,"Achievement",-1),Xl={class:"pl-2"},et={class:"font-bold"},lt=e("td",null,"Weightage Score",-1),tt={class:"pl-2"},at={class:""},ot=e("p",{class:"text-center"},"No Data found...",-1),st={class:"flex flex-wrap align-items-center justify-content-between gap-2 py-2"},nt={class:"text-xl text-900 font-bold"},it=["href"],dt={class:"my-5 flex gap-2 text-lg"},rt=e("p",{class:"font-bold"},"Self Remark:",-1),ct={class:""},ut={class:"col-12"},mt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Line Manager Feedback:",-1),pt={class:"col-12"},_t=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Training Needs Assessment:",-1),ft={class:"w-full flex justify-center"},vt={__name:"Report",props:["quater"],setup(ie){const ee=ye(),ae=he(),oe=n(!1),re=n(!1),z=n(!1),A=n(""),F=n(""),L=n(!1),S=n([]),c=n(""),D=n(""),U=n(null),C=()=>{console.log("Modal"),L.value=!0};(async()=>{var B,le,_;const i=P("token"),{data:r,pending:u,error:q}=await Be("getMembers",()=>$fetch(`${ee.public.apiUrl}/teams/members?report=1`,{headers:{Authorization:`Bearer ${i.value}`}}));console.log("memmbess",(B=r.value)==null?void 0:B.team_members),(le=r.value)!=null&&le.team_members&&(S.value=(_=r.value)==null?void 0:_.team_members.map(s=>({id:s.id,name:s.name})),console.log("employee",A.value))})();const v=async()=>{if(A.value==""||F.value=="")return ae.add({severity:"warn",summary:"Warning",detail:"Please Select Employee and Quarter",group:"br",life:3e3});const i=P("token"),{data:r,error:u}=await R(`${ee.public.apiUrl}/kpi/show/${A.value.id}?quater_id=${F.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${i.value}`}},"$PG910Me6qO");return r.value.code==200?(U.value=r.value,console.log("Report Value",r.value),oe.value=!1):(oe.value=!1,ae.add({severity:"error",summary:"Failed",detail:"Failed to show report",group:"br",life:3e3}))},g=async()=>{const i=P("token");re.value=!0;const{data:r,error:u}=await R(`${ee.public.apiUrl}/kpi/report-download/${A.value.id}?quater_id=${F.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${i.value}`}},"$8KxzC2nWbm");if(r.value.code==200){const q=document.createElement("a");q.href=r.value.download_path,q.target="_blank",q.click(),re.value=!1;return}else return re.value=!1,ae.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},p=async()=>{z.value=!0;const i=P("token"),r=new FormData;r.append("user_id",A.value.id),r.append("quater_id",F.value.id),r.append("line_manager_feedback",c.value),r.append("line_manager_assesment",D.value);const{data:u,error:q}=await R(`${ee.public.apiUrl}/kpi/line-manager-feedback`,{method:"POST",headers:{Authorization:`Bearer ${i.value}`},body:r},"$CYBu34Xv3m");return u.value?(z.value=!1,L.value=!1,v(),D.value="",c.value="",ae.add({severity:"success",summary:"Success",detail:"Feedback submitted successfully",group:"br",life:3e3})):(z.value=!1,ae.add({severity:"error",summary:"Failed",detail:"Failed to submit feedback",group:"br",life:3e3}))};return(i,r)=>{var W,N,de,h,d,O,k,Q,f,M;const u=Ce,q=$e,B=be,le=Oe,_=xe,s=Re,V=Ne,E=Ue,X=Ee;return $(),j(_e,null,[e("div",Tl,[t(u,{position:"bottom-right",group:"br"}),t(le,{class:"border-0 px-0"},{start:b(()=>[e("div",El,[e("div",Ml,[ql,e("div",Il,[t(q,{modelValue:l(A),"onUpdate:modelValue":r[0]||(r[0]=a=>J(A)?A.value=a:null),options:l(S),optionLabel:"name",placeholder:"Select Employee",class:"w-full md:w-14rem"},null,8,["modelValue","options"])])]),e("div",Al,[Ll,e("div",Bl,[t(q,{modelValue:l(F),"onUpdate:modelValue":r[1]||(r[1]=a=>J(F)?F.value=a:null),options:ie.quater,optionLabel:"name",placeholder:"Select Quarter",class:"w-full md:w-14rem"},null,8,["modelValue","options"])])])])]),end:b(()=>[t(B,{onClick:v,class:"w-full",label:"Generate",loading:l(oe)},null,8,["loading"])]),_:1})]),l(U)?($(),j("div",Ql,[e("div",null,[e("div",Kl,[e("div",Pl,[e("table",null,[e("tr",Ol,[Rl,e("td",Nl,": "+H((W=l(U))==null?void 0:W.user_name),1)]),e("tr",jl,[zl,e("td",Wl,": "+H((N=l(U))==null?void 0:N.designation),1)]),e("tr",Gl,[Yl,e("td",Zl,": "+H((de=l(U))==null?void 0:de.line_maneger_name),1)]),e("tr",Hl,[Jl,e("td",Xl,": "+H((h=l(U))==null?void 0:h.overAllKpi),1)]),e("tr",et,[lt,e("td",tt,": "+H((d=l(U))==null?void 0:d.overAllKpi.slice(0,-1)),1)])])]),e("div",at,[(O=l(U))!=null&&O.can_set_feedback?($(),Z(B,{key:0,class:"w-fit h-fit mx-1 bg-green-500",style:{border:"1px solid #22c55e"},label:"Feedback",onClick:C})):K("",!0),t(B,{onClick:g,class:"w-fit h-fit mx-1",label:"Download",loading:l(re)},null,8,["loading"])])]),($(!0),j(_e,null,we((k=l(U))==null?void 0:k.data,(a,o)=>($(),Z(E,{value:a.sub_section_data,key:o,showGridlines:"",tableStyle:"min-width: 50rem",class:"my-4"},{empty:b(()=>[ot]),header:b(()=>[e("div",st,[e("span",nt,H(a.section.name),1)])]),default:b(()=>[t(_,{field:"",header:"Sub Section",style:{width:"30%"}},{body:b(y=>{var I,w;return[e("div",null,H((w=(I=y==null?void 0:y.data)==null?void 0:I.sub_section)==null?void 0:w.title),1)]}),_:1}),t(_,{field:"target_mark",header:"Key result Target",style:{width:"8%"}}),t(_,{field:"achive_mark",header:"Key result Achivement",style:{width:"8%"}}),t(_,{field:"achive_mark_parcentage",header:"Achievement Percentage",style:{width:"8%"}}),t(_,{field:"weightage",header:"Weightage",style:{width:"8%"}}),t(_,{field:"weightage_score",header:"Weightage Score",style:{width:"8%"}}),t(_,{field:"comment",header:"Comment"}),t(_,{field:"",header:"File",style:{width:"8%"}},{body:b(y=>{var I,w;return[((I=y==null?void 0:y.data)==null?void 0:I.file_link)!==""?($(),j("a",{key:0,href:(w=y==null?void 0:y.data)==null?void 0:w.file_link,target:"_blank",class:"text-blue-500"}," Attachment ",8,it)):K("",!0)]}),_:1}),t(V,{type:"footer"},{default:b(()=>[t(s,null,{default:b(()=>{var y,I,w;return[t(_,{footer:"Summary:",colspan:3,footerStyle:"text-align:left"}),t(_,{footer:(y=a==null?void 0:a.section_summary)==null?void 0:y.achivementpercentage_sum},null,8,["footer"]),t(_,{footer:(I=a==null?void 0:a.section_summary)==null?void 0:I.section_weightage},null,8,["footer"]),t(_,{footer:(w=a==null?void 0:a.section_summary)==null?void 0:w.weighted_score_sum},null,8,["footer"]),t(_,{footer:""}),t(_,{footer:""})]}),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128)),t(E,{value:[(Q=l(U))==null?void 0:Q.line_maneger],showGridlines:""},{default:b(()=>[t(_,{field:"line_manager_feedback",header:"Line Manager Feedback on Improvement Areas"}),t(_,{field:"line_manager_assesment",header:"Training Needs Assessment"})]),_:1},8,["value"]),e("div",dt,[rt,e("p",ct,H((M=(f=l(U))==null?void 0:f.line_maneger)==null?void 0:M.self_remarks),1)])]),t(l(Ve),{visible:l(L),"onUpdate:visible":r[4]||(r[4]=a=>J(L)?L.value=a:null),modal:"",header:"Feedback",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[e("form",{onSubmit:me(p,["prevent"])},[e("div",ut,[mt,t(X,{modelValue:l(c),"onUpdate:modelValue":r[2]||(r[2]=a=>J(c)?c.value=a:null),rows:"3",cols:"20",placeholder:"Write comment",class:"w-full",required:""},null,8,["modelValue"])]),e("div",pt,[_t,t(X,{modelValue:l(D),"onUpdate:modelValue":r[3]||(r[3]=a=>J(D)?D.value=a:null),rows:"3",cols:"20",placeholder:"Write comment",class:"w-full",required:""},null,8,["modelValue"])]),e("div",ft,[t(B,{class:"w-fit h-fit mx-auto",type:"submit",label:"Submit",loading:l(z)},null,8,["loading"])])],32)]),_:1},8,["visible"])])):K("",!0)],64)}}},bt={class:"grid"},ht={class:"col-12"},yt={class:"flex justify-content-end my-4"},gt={class:"card"},kt=e("p",{class:"text-center"},"No Data found...",-1),wt={class:"card"},$t={class:"kpi-form grid"},St={class:"col-12"},Vt={class:"user-selection w-full"},xt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Title:",-1),Ut={class:"col-12"},Dt={class:"user-selection w-full"},Ct=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),Ft={class:"col-12"},Tt={class:"user-selection w-full"},Et=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Status:",-1),Mt={class:"col-12 mx-auto flex justify-content-center"},qt={class:"card"},It={class:"kpi-form grid"},At={class:"col-12"},Lt={class:"user-selection w-full"},Bt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Title:",-1),Qt={class:"col-12"},Kt={class:"user-selection w-full"},Pt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),Ot={class:"col-12"},Rt={class:"user-selection w-full"},Nt=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Section Status:",-1),jt={class:"col-12 mx-auto flex justify-content-center"},zt={class:"grid"},Wt={class:"col-12"},Gt={class:"flex justify-content-end my-4"},Yt={class:"card"},Zt=e("p",{class:"text-center"},"No Data found...",-1),Ht={class:"card"},Jt={class:"kpi-form grid"},Xt={class:"col-12"},ea=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Select Section:",-1),la={class:"col-12"},ta={class:"user-selection w-full"},aa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Title:",-1),oa={class:"col-12"},sa={class:"user-selection w-full"},na=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),ia={class:"col-12"},da={class:"user-selection w-full"},ra=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Mark Type:",-1),ca={class:"col-12"},ua={class:"user-selection w-full"},ma=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Target Mark:",-1),pa={class:"col-12"},_a={class:"user-selection w-full"},fa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Comment:",-1),va={class:"col-12"},ba={class:"user-selection w-full"},ha=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Status:",-1),ya={class:"col-12 mx-auto flex justify-content-center"},ga={class:"card"},ka={class:"kpi-form grid"},wa={class:"col-12"},$a=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Select Section:",-1),Sa={class:"col-12"},Va={class:"user-selection w-full"},xa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Title:",-1),Ua={class:"col-12"},Da={class:"user-selection w-full"},Ca=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1),Fa={class:"col-12"},Ta={class:"user-selection w-full"},Ea=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Mark Type:",-1),Ma={class:"col-12"},qa={class:"user-selection w-full"},Ia=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Target Mark:",-1),Aa={class:"col-12"},La={class:"user-selection w-full"},Ba=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Comment:",-1),Qa={class:"col-12"},Ka={class:"user-selection w-full"},Pa=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Status:",-1),Oa={class:"col-12 mx-auto flex justify-content-center"},Ra={__name:"Section",setup(ie){const ee=n(se("read_section")),ae=n(se("create_section")),oe=n(se("update_section")),re=n(se("delete_section")),z=n(se("read_sub_section")),A=n(se("create_sub_section")),F=n(se("update_sub_section")),L=n(se("delete_sub_section")),S=ye(),c=he(),D=n([]),U=n([]),C=n(!1),T=n(!1),v=n(!1),g=n(!1),p=n({}),i=n({}),r=n({}),u=n({}),q=n(!1),B=n(!1),le=n(!1),_=n(!1),s=n(!1),V=async()=>{var I;const a=P("token"),{data:o,pending:y}=await R(`${S.public.apiUrl}/kpi/section`,{method:"GET",headers:{Authorization:`Bearer ${a.value}`}},"$QLfPrBj95L");o&&(console.log("Section data: ",o.value.data),D.value=(I=o.value)==null?void 0:I.data.map((w,G)=>({...w,index:G+1})))},E=async()=>{var I;const a=P("token"),{data:o,pending:y}=await R(`${S.public.apiUrl}/kpi/sub-section`,{method:"GET",headers:{Authorization:`Bearer ${a.value}`}},"$WaU7WXQtZH");o&&(console.log("Section data: ",o.value.data),U.value=(I=o.value)==null?void 0:I.data.map((w,G)=>({...w,index:G+1})))},X=n([{name:"Active",label:1},{name:"Inactive",label:0}]),W=n([{name:"Percentage (%)",label:1},{name:"Number (01)",label:0}]),N=async()=>{var G;q.value=!0,console.log(Object.keys(p.value));const a=new FormData;if(a.append("name",p.value.name),a.append("status",(G=p.value.status)==null?void 0:G.label),a.append("section_weightage",p.value.section_weightage),!p.value.name||!p.value.status)return q.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const o=P("token"),{data:y,pending:I,error:w}=await R(`${S.public.apiUrl}/kpi/section-create`,{method:"POST",headers:{Authorization:`Bearer ${o.value}`},body:a},"$CJGlGi6sZy");y.value?(V(),C.value=!1,p.value={},q.value=!1,c.add({severity:"success",summary:"Updated",detail:"Section Created Successfully",group:"br",life:3e3})):(q.value=!1,c.add({severity:"error",summary:"Failed",detail:"Failed to create section!",group:"br",life:3e3}))},de=async()=>{var w,G;B.value=!0,console.log(Object.keys(i.value));const a=new FormData;if(a.append("section_id",(w=i.value.section)==null?void 0:w.id),a.append("title",i.value.name),a.append("target_mark",i.value.targetMark),a.append("mark_type",i.value.mark_type.label),a.append("weightage",i.value.weightage),a.append("comment",i.value.comment||""),a.append("status",(G=i.value.status)==null?void 0:G.label),!i.value.section||!i.value.name||!i.value.targetMark||!i.value.status)return B.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const o=P("token"),{data:y,pending:I}=await R(`${S.public.apiUrl}/kpi/sub-section-create`,{method:"POST",headers:{Authorization:`Bearer ${o.value}`},body:a},"$YVPI7MPSvE");y.value?(E(),T.value=!1,i.value={},B.value=!1,c.add({severity:"success",summary:"Updated",detail:"Sub Section Created Successfully",group:"br",life:3e3})):(B.value=!1,c.add({severity:"error",summary:"Failed",detail:"Failed to create sub section!",group:"br",life:3e3}))},h=async a=>{v.value=!0,r.value={...a,status:a.status===1?{name:"Active",label:1}:{name:"Inactive",label:0}},console.log("Edit Data:",r.value)},d=n(),O=async a=>{g.value=!0,d.value=D.value.map(o=>({name:o.name,id:o.id})),u.value={subSectionId:a.id,section_id:d.value.find(o=>o.id===a.section_id),title:a.title,target_mark:a.target_mark,mark_type:W.value.find(o=>o.label===a.mark_type),weightage:a.weightage,comment:a.comment,status:X.value.find(o=>o.label===a.status)}},k=async()=>{var G;if(le.value=!0,!r.value.name||!r.value.status)return le.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const a=new FormData;a.append("name",r.value.name),a.append("status",(G=r.value.status)==null?void 0:G.label),a.append("section_weightage",r.value.section_weightage);const o=P("token"),{data:y,pending:I,error:w}=await R(`${S.public.apiUrl}/kpi/section-update/${r.value.id}`,{method:"POST",headers:{Authorization:`Bearer ${o.value}`},body:a},"$RRgAmPcwW9");y.value?(V(),v.value=!1,r.value={},le.value=!1,c.add({severity:"success",summary:"Updated",detail:"Section Updated Successfully",group:"br",life:3e3})):(le.value=!1,c.add({severity:"error",summary:w.value.data.app_message,detail:w.value.data.user_message,group:"br",life:3e3}))},Q=async()=>{var G,te;if(_.value=!0,!u.value.section_id||!u.value.title||!u.value.target_mark||!u.value.status)return _.value=!1,c.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});console.log(u);const a=new FormData;a.append("section_id",(G=u.value.section_id)==null?void 0:G.id),a.append("title",u.value.title),a.append("weightage",u.value.weightage),a.append("target_mark",u.value.target_mark),a.append("mark_type",u.value.mark_type.label),a.append("comment",u.value.comment),a.append("status",(te=u.value.status)==null?void 0:te.label);const o=P("token"),{data:y,pending:I,error:w}=await R(`${S.public.apiUrl}/kpi/sub-section-update/${u.value.subSectionId}`,{method:"POST",headers:{Authorization:`Bearer ${o.value}`},body:a},"$Bgl5cHylQ2");y.value?(E(),g.value=!1,u.value={},_.value=!1,c.add({severity:"success",summary:"Updated",detail:"Sub Section Updated Successfully",group:"br",life:3e3})):(_.value=!1,c.add({severity:"error",summary:w.value.data.app_message||"Error",detail:w.value.data.user_message||"Failed To Update",group:"br",life:3e3}))},f=async a=>{const o=P("token"),{data:y,pending:I,error:w}=await R(`${S.public.apiUrl}/kpi/section-delete/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${o.value}`}},"$fSYmqaVVux");y.value?(V(),c.add({severity:"success",summary:"Deleted",detail:"Section Deleted Successfully",group:"br",life:3e3})):c.add({severity:"error",summary:"Failed",detail:w.value.data.user_message,group:"br",life:3e3})},M=async a=>{const o=P("token"),{data:y,pending:I,error:w}=await R(`${S.public.apiUrl}/kpi/sub-section-delete/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${o.value}`}},"$K5gf5dTDYf");y.value?(E(),c.add({severity:"success",summary:"Deleted",detail:"Sub Section Deleted Successfully",group:"br",life:3e3})):c.add({severity:"error",summary:"Failed",detail:w.value.data.user_message,group:"br",life:3e3})};return Le(()=>{V(),E()}),(a,o)=>{const y=be,I=je,w=xe,G=Ue,te=Se,x=$e,Y=Ve,ve=Te,ge=Qe;return $(),Z(ge,{activeIndex:0},{default:b(()=>[l(ee)?($(),Z(ve,{key:0,header:"Sections"},{default:b(()=>[e("div",bt,[e("div",ht,[e("div",yt,[l(ae)?($(),Z(y,{key:0,onClick:o[0]||(o[0]=()=>C.value=!0),label:"Section",icon:"pi pi-plus",class:""})):K("",!0)]),e("div",gt,[t(G,{class:"table-stR",value:l(D),paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:l(s)},{empty:b(()=>[kt]),loading:b(()=>[t(I,{style:{width:"50px",height:"50px"}})]),default:b(()=>[t(w,{field:"index",header:"Serial",sortable:""}),t(w,{style:{"text-wrap":"nowrap"},field:"name",header:"Section Name"}),t(w,{style:{"text-wrap":"nowrap"},field:"section_weightage",header:"Weightage"}),t(w,{field:"action",header:"Action"},{body:b(m=>[l(oe)?($(),Z(y,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:fe=>h(m.data)},null,8,["onClick"])):K("",!0),l(re)?($(),Z(y,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:fe=>f(m.data.id)},null,8,["onClick"])):K("",!0)]),_:1})]),_:1},8,["value","loading"])])])]),t(Y,{visible:l(C),"onUpdate:visible":o[4]||(o[4]=m=>J(C)?C.value=m:null),modal:"",header:"Create Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[e("form",{class:"",action:"",onSubmit:me(N,["prevent"])},[e("div",wt,[e("div",$t,[e("div",St,[e("div",Vt,[xt,t(te,{type:"text",modelValue:l(p).name,"onUpdate:modelValue":o[1]||(o[1]=m=>l(p).name=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Ut,[e("div",Dt,[Ct,t(te,{type:"text",modelValue:l(p).section_weightage,"onUpdate:modelValue":o[2]||(o[2]=m=>l(p).section_weightage=m),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Ft,[e("div",Tt,[Et,t(x,{modelValue:l(p).status,"onUpdate:modelValue":o[3]||(o[3]=m=>l(p).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",Mt,[t(y,{label:"Create",severity:"info",type:"submit",loading:l(q)},null,8,["loading"])])])])],32)]),_:1},8,["visible"]),t(Y,{visible:l(v),"onUpdate:visible":o[8]||(o[8]=m=>J(v)?v.value=m:null),modal:"",header:"Edit Section",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[e("form",{class:"",action:"",onSubmit:me(k,["prevent"])},[e("div",qt,[e("div",It,[e("div",At,[e("div",Lt,[Bt,t(te,{type:"text",modelValue:l(r).name,"onUpdate:modelValue":o[5]||(o[5]=m=>l(r).name=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Qt,[e("div",Kt,[Pt,t(te,{type:"text",modelValue:l(r).section_weightage,"onUpdate:modelValue":o[6]||(o[6]=m=>l(r).section_weightage=m),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Ot,[e("div",Rt,[Nt,t(x,{modelValue:l(r).status,"onUpdate:modelValue":o[7]||(o[7]=m=>l(r).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",jt,[t(y,{label:"Update",severity:"info",type:"submit",loading:l(le)},null,8,["loading"])])])])],32)]),_:1},8,["visible"])]),_:1})):K("",!0),l(z)?($(),Z(ve,{key:1,header:"Sub Sections"},{default:b(()=>[e("div",zt,[e("div",Wt,[e("div",Gt,[l(A)?($(),Z(y,{key:0,onClick:o[9]||(o[9]=()=>T.value=!0),label:"Sub Section",icon:"pi pi-plus",class:""})):K("",!0)]),e("div",Yt,[t(G,{class:"table-stR",value:l(U),paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:l(s)},{empty:b(()=>[Zt]),loading:b(()=>[t(I,{style:{width:"50px",height:"50px"}})]),default:b(()=>[t(w,{field:"index",header:"Serial",sortable:""}),t(w,{style:{"text-wrap":"nowrap"},field:"title",header:"Sub Section Name"}),t(w,{style:{"text-wrap":"nowrap"},field:"target_mark",header:"Target Mark"}),t(w,{style:{"text-wrap":"nowrap"},field:"weightage",header:"Weightage"}),t(w,{style:{"text-wrap":"nowrap"},field:"section_name",header:"Section"}),t(w,{style:{"text-wrap":"nowrap"},field:"comment",header:"Comment"}),t(w,{field:"action",header:"Action"},{body:b(m=>[l(F)?($(),Z(y,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:fe=>O(m.data)},null,8,["onClick"])):K("",!0),l(L)?($(),Z(y,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:fe=>M(m.data.id)},null,8,["onClick"])):K("",!0)]),_:1})]),_:1},8,["value","loading"])])])]),t(Y,{visible:l(T),"onUpdate:visible":o[17]||(o[17]=m=>J(T)?T.value=m:null),modal:"",header:"Create Sub Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[e("form",{class:"",action:"",onSubmit:me(de,["prevent"])},[e("div",Ht,[e("div",Jt,[e("div",Xt,[ea,t(x,{modelValue:l(i).section,"onUpdate:modelValue":o[10]||(o[10]=m=>l(i).section=m),options:l(D),optionLabel:"name",placeholder:"Select Section",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e("div",la,[e("div",ta,[aa,t(te,{type:"text",modelValue:l(i).name,"onUpdate:modelValue":o[11]||(o[11]=m=>l(i).name=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",oa,[e("div",sa,[na,t(te,{type:"text",modelValue:l(i).weightage,"onUpdate:modelValue":o[12]||(o[12]=m=>l(i).weightage=m),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",ia,[e("div",da,[ra,t(x,{modelValue:l(i).mark_type,"onUpdate:modelValue":o[13]||(o[13]=m=>l(i).mark_type=m),options:l(W),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",ca,[e("div",ua,[ma,t(te,{type:"number",modelValue:l(i).targetMark,"onUpdate:modelValue":o[14]||(o[14]=m=>l(i).targetMark=m),placeholder:"Set Target Mark",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",pa,[e("div",_a,[fa,t(te,{type:"text",modelValue:l(i).comment,"onUpdate:modelValue":o[15]||(o[15]=m=>l(i).comment=m),placeholder:"Comment",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",va,[e("div",ba,[ha,t(x,{modelValue:l(i).status,"onUpdate:modelValue":o[16]||(o[16]=m=>l(i).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",ya,[t(y,{label:"Create",severity:"info",type:"submit",loading:l(B)},null,8,["loading"])])])])],32)]),_:1},8,["visible"]),t(Y,{visible:l(g),"onUpdate:visible":o[25]||(o[25]=m=>J(g)?g.value=m:null),modal:"",header:"Edit Sub Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[e("form",{class:"",action:"",onSubmit:me(Q,["prevent"])},[e("div",ga,[e("div",ka,[e("div",wa,[$a,t(x,{modelValue:l(u).section_id,"onUpdate:modelValue":o[18]||(o[18]=m=>l(u).section_id=m),options:l(d),optionLabel:"name",placeholder:"Select Section",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e("div",Sa,[e("div",Va,[xa,t(te,{type:"text",modelValue:l(u).title,"onUpdate:modelValue":o[19]||(o[19]=m=>l(u).title=m),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Ua,[e("div",Da,[Ca,t(te,{type:"text",modelValue:l(u).weightage,"onUpdate:modelValue":o[20]||(o[20]=m=>l(u).weightage=m),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Fa,[e("div",Ta,[Ea,t(x,{modelValue:l(u).mark_type,"onUpdate:modelValue":o[21]||(o[21]=m=>l(u).mark_type=m),options:l(W),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",Ma,[e("div",qa,[Ia,t(te,{type:"number",modelValue:l(u).target_mark,"onUpdate:modelValue":o[22]||(o[22]=m=>l(u).target_mark=m),placeholder:"Set Target Mark",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Aa,[e("div",La,[Ba,t(te,{type:"text",modelValue:l(u).comment,"onUpdate:modelValue":o[23]||(o[23]=m=>l(u).comment=m),placeholder:"Comment",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Qa,[e("div",Ka,[Pa,t(x,{modelValue:l(u).status,"onUpdate:modelValue":o[24]||(o[24]=m=>l(u).status=m),options:l(X),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",Oa,[t(y,{label:"Update",severity:"info",type:"submit",loading:l(_)},null,8,["loading"])])])])],32)]),_:1},8,["visible"])]),_:1})):K("",!0)]),_:1})}}},Na={key:0,class:"grid"},ja={class:"col-12"},za={class:"flex justify-content-end my-4"},Wa={class:"card"},Ga={class:"card"},Ya={class:"kpi-form grid"},Za={class:"col-12"},Ha={class:"user-selection w-full"},Ja=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter Name:",-1),Xa={class:"col-12"},eo={class:"user-selection w-full"},lo=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Start Date:",-1),to={class:"col-12"},ao={class:"user-selection w-full"},oo=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"End Date:",-1),so={class:"col-12"},no={class:"user-selection w-full"},io=e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Year:",-1),ro={class:"text-center w-full text-red-500"},co={class:"col-12 mx-auto flex justify-content-center"},uo={__name:"Quater",setup(ie){const ee=n(se("read_quater")),ae=n(se("create_quater")),oe=n(se("update_quater")),re=n(se("delete_quater")),z=ye(),A=he(),F=n([]),L=n([]),S=n(!1),c=n({name:"",start_date:"",end_date:"",year:""}),D=n(""),U=async()=>{const p=P("token"),{data:i,pending:r}=await R(`${z.public.apiUrl}/kpi-quater/list`,{method:"GET",headers:{Authorization:`Bearer ${p.value}`}},"$xAc4CusaQB");i&&(F.value=i.value.data)},C=p=>{const i=new Date(p);return`${i.getFullYear()}-${("0"+(i.getMonth()+1)).slice(-2)}-${("0"+i.getDate()).slice(-2)}`},T=async p=>{console.log(p.newData);const i=new FormData;console.log(p.newData),i.append("name",p.newData.name),typeof p.newData.year=="string"?i.append("year",`${p.newData.year}-01-01`):i.append("year",C(p.newData.year)),typeof p.newData.start_date=="string"?i.append("start_date",`2024-${p.newData.start_date}`):i.append("start_date",C(p.newData.start_date)),typeof p.newData.end_date=="string"?i.append("end_date",`2024-${p.newData.end_date}`):i.append("end_date",C(p.newData.end_date));const r=P("token"),{data:u,pending:q}=await R(`${z.public.apiUrl}/kpi-quater/update/${p.newData.id}`,{method:"POST",headers:{Authorization:`Bearer ${r.value}`},body:i},"$l1lK7dLb4F");return u?(U(),A.add({severity:"success",summary:"Updated",detail:"Successfully updated",group:"br",life:3e3})):A.add({severity:"error",summary:"Failed",detail:"Failed to update",group:"br",life:3e3})},v=async p=>{const i=P("token"),{data:r,pending:u}=await R(`${z.public.apiUrl}/kpi-quater/delete/${p.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${i.value}`}},"$EbQqn17n2R");return r?(U(),A.add({severity:"success",summary:"Deleted",detail:"Successfully deleted",group:"br",life:3e3})):A.add({severity:"error",summary:"Failed",detail:"Failed to delete",group:"br",life:3e3})},g=async()=>{console.log(Object.keys(c.value)),console.log(c.value);const p=new FormData;if(c.value.name!="")p.append("name",c.value.name);else{D.value="Please fill the required fields";return}if(c.value.start_date!="")p.append("start_date",C(c.value.start_date));else{D.value="Please fill the required fields";return}if(c.value.end_date!="")p.append("end_date",C(c.value.end_date));else{D.value="Please fill the required fields";return}if(c.value.year!="")p.append("year",C(c.value.year));else{D.value="Please fill the required fields";return}const i=P("token"),{data:r,pending:u}=await R(`${z.public.apiUrl}/kpi-quater/create`,{method:"POST",headers:{Authorization:`Bearer ${i.value}`},body:p},"$J9PxtNIiS2");return r?(U(),S.value=!1,c.value={name:"",start_date:"",end_date:"",year:""},D.value=null,A.add({severity:"success",summary:"Updated",detail:"Successfully Created",group:"br",life:3e3})):A.add({severity:"error",summary:"Failed",detail:"Failed to update",group:"br",life:3e3})};return Le(()=>{U()}),(p,i)=>{const r=be,u=Se,q=xe,B=Fe,le=Ue,_=Ve;return $(),j(_e,null,[l(ee)?($(),j("div",Na,[e("div",ja,[e("div",za,[l(ae)?($(),Z(r,{key:0,onClick:i[0]||(i[0]=()=>S.value=!0),label:"Create",icon:"pi pi-plus",class:""})):K("",!0)]),e("div",Wa,[t(le,{editingRows:l(L),"onUpdate:editingRows":i[1]||(i[1]=s=>J(L)?L.value=s:null),value:l(F),editMode:"row",dataKey:"id",onRowEditSave:T,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:s})=>({style:s.d_editing&&"padding-top: 0.75rem; padding-bottom: 0.75rem"})}},dt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:s})=>({style:s.d_editing&&"padding-top: 0.75rem; padding-bottom: 0.75rem"})}}},{default:b(()=>[t(q,{field:"name",header:"Quarter",style:{width:"20%"}},{editor:b(({data:s,field:V})=>[t(u,{modelValue:s[V],"onUpdate:modelValue":E=>s[V]=E},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(q,{field:"start_date",header:"Start Date",style:{width:"20%"}},{editor:b(({data:s,field:V})=>[t(B,{modelValue:s[V],"onUpdate:modelValue":E=>s[V]=E,dateFormat:"mm-dd",fluid:"",value:s[V],manualInputs:!1},null,8,["modelValue","onUpdate:modelValue","value"])]),_:1}),t(q,{field:"end_date",header:"End Date",style:{width:"20%"}},{editor:b(({data:s,field:V})=>[t(B,{modelValue:s[V],"onUpdate:modelValue":E=>s[V]=E,dateFormat:"mm-dd",fluid:"",manualInputs:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(q,{field:"year",header:"Year",style:{width:"20%"}},{body:b(({data:s})=>[pe(H(s.year),1)]),editor:b(({data:s,field:V})=>[t(B,{modelValue:s[V],"onUpdate:modelValue":E=>s[V]=E,view:"year",dateFormat:"yy",fluid:"",manualInputs:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(re)?($(),Z(q,{key:0,header:"",style:{width:"1%","min-width":"1rem",padding:"0"},bodyStyle:"text-align:start"},{body:b(({data:s})=>[t(r,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-text",onClick:V=>v(s)},null,8,["onClick"])]),_:1})):K("",!0),l(oe)?($(),Z(q,{key:1,header:"Action",rowEditor:!0,style:{width:"1%","min-width":"6rem",padding:"0 auto"},bodyStyle:"text-align:start"})):K("",!0),l(oe)?K("",!0):($(),Z(q,{key:2,header:"Action",style:{width:"1%","min-width":"6rem",padding:"0 auto"},bodyStyle:"text-align:start"}))]),_:1},8,["editingRows","value","pt","dt"])])])])):K("",!0),t(_,{visible:l(S),"onUpdate:visible":i[6]||(i[6]=s=>J(S)?S.value=s:null),modal:"",header:"Create Quarter",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[e("form",{class:"",action:"",onSubmit:me(g,["prevent"])},[e("div",Ga,[e("div",Ya,[e("div",Za,[e("div",Ha,[Ja,t(u,{type:"text",modelValue:l(c).name,"onUpdate:modelValue":i[2]||(i[2]=s=>l(c).name=s),placeholder:"Name",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Xa,[e("div",eo,[lo,t(B,{modelValue:l(c).start_date,"onUpdate:modelValue":i[3]||(i[3]=s=>l(c).start_date=s),dateFormat:"mm-dd",fluid:"",manualInputs:!1,class:"w-full",required:"",placeholder:"MM-DD"},null,8,["modelValue"])])]),e("div",to,[e("div",ao,[oo,t(B,{modelValue:l(c).end_date,"onUpdate:modelValue":i[4]||(i[4]=s=>l(c).end_date=s),dateFormat:"mm-dd",fluid:"",manualInputs:!1,class:"w-full",required:"",placeholder:"MM-DD"},null,8,["modelValue"])])]),e("div",so,[e("div",no,[io,t(B,{modelValue:l(c).year,"onUpdate:modelValue":i[5]||(i[5]=s=>l(c).year=s),view:"year",dateFormat:"yy",fluid:"",manualInputs:!1,class:"w-full",placeholder:"YYYY"},null,8,["modelValue"])])]),e("p",ro,H(l(D)),1),e("div",co,[t(r,{label:"Create",severity:"info",type:"submit"})])])])],32)]),_:1},8,["visible"])],64)}}};const ne=ie=>(Ie("data-v-8a92889a"),ie=ie(),Ae(),ie),mo={class:"card"},po=ne(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"KPI Report")],-1)),_o={class:"card mx-auto",style:{"max-width":"50rem"}},fo={class:"grid col-12 w-full"},vo={class:"col-12 md:col-4"},bo=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Team Member",-1)),ho={class:"col-12 md:col-4"},yo=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),go={class:"col-12 md:col-4"},ko=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Deadline",-1)),wo={key:0,class:""},$o=["onClick"],So=ne(()=>e("i",{class:"pi pi-times-circle text-xl"},null,-1)),Vo=[So],xo={class:"w-full col-12 grid"},Uo={class:"col-12 md:col-6"},Do=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},[pe("Section"),e("i",{class:"text-red-400 text-italic"},"*")],-1)),Co={class:"col-12 md:col-6"},Fo=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},[pe("Sub Section"),e("i",{class:"text-red-400 text-italic"},"*")],-1)),To={class:"flex gap-2 w-full"},Eo={class:"col-12 md:col-6"},Mo=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Quarter",-1)),qo={class:"col-12 md:col-6"},Io={for:"icondisplay",class:"font-bold block mb-2"},Ao={class:"col-12"},Lo=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Comment",-1)),Bo={class:"gap-2 flex justify-content-center w-full"},Qo={class:""},Ko={class:"kpi-form grid"},Po={class:"col-12"},Oo=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Select Section:",-1)),Ro={class:"col-12"},No={class:"user-selection w-full"},jo=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Title:",-1)),zo={class:"col-12"},Wo={class:"user-selection w-full"},Go=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Weightage:",-1)),Yo={class:"col-12"},Zo={class:"user-selection w-full"},Ho=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Mark Type:",-1)),Jo={class:"col-12"},Xo={class:"user-selection w-full"},es=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Key result Target:",-1)),ls={class:"col-12"},ts={class:"user-selection w-full"},as=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Comment:",-1)),os={class:"col-12"},ss={class:"user-selection w-full"},ns=ne(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"Sub Section Status:",-1)),is={class:"col-12 mx-auto flex justify-content-center"},ds={__name:"index",setup(ie){const ee=ye(),ae=n(se("read_kpi")),oe=n(se("create_kpi")),re=n(se("read_quater")),z=n(se("read_section")),A=n([]),F=n(""),L=n([]),S=n(""),c=n(""),D=n([]);n("");const U=n([{name:"Active",label:1},{name:"Inactive",label:0}]),C=n(!1),T=n([]);n([]);const v=n({}),g=n([{section_id:null,subsection_id:null,quater_id:null,achive_mark:0,target_mark:0,comment:""}]),p=n(""),i=n(!1),r=n(!1),u=he(),q=async()=>{var Q,f,M;const h=P("token"),{data:d,pending:O,error:k}=await Be("getMembers22",()=>$fetch(`${ee.public.apiUrl}/teams/members`,{headers:{Authorization:`Bearer ${h.value}`}}));console.log("memmbess",(Q=d.value)==null?void 0:Q.team_members),(f=d.value)!=null&&f.team_members&&(A.value=(M=d.value)==null?void 0:M.team_members.map(a=>({id:a.id,name:a.name})),console.log("employee",F.value))},B=async()=>{var k,Q,f;const h=P("token"),{data:d,error:O}=await R(`${ee.public.apiUrl}/kpi-quater/list`,{method:"GET",headers:{Authorization:`Bearer ${h.value}`}},"$LQ1vlojxsA");((Q=(k=d.value)==null?void 0:k.data)==null?void 0:Q.length)>0&&(L.value=(f=d.value)==null?void 0:f.data)},le=async()=>{var k,Q,f;const h=P("token"),{data:d,error:O}=await R(`${ee.public.apiUrl}/kpi/section`,{method:"GET",headers:{Authorization:`Bearer ${h.value}`}},"$aOHxRgEOE3");((Q=(k=d.value)==null?void 0:k.data)==null?void 0:Q.length)>0&&(D.value=(f=d.value)==null?void 0:f.data)},_=async()=>{var k,Q,f;const h=P("token"),{data:d,error:O}=await R(`${ee.public.apiUrl}/kpi/sub-section`,{method:"GET",headers:{Authorization:`Bearer ${h.value}`}},"$QrpcIVwZho");((Q=(k=d.value)==null?void 0:k.data)==null?void 0:Q.length)>0&&(T.value=(f=d.value)==null?void 0:f.data)},s=async()=>{var Q,f;C.value=!0,console.log(Object.keys(v.value));const h=new FormData;if(h.append("section_id",(Q=v.value.section)==null?void 0:Q.id),h.append("title",v.value.name),h.append("target_mark",v.value.targetMark),h.append("mark_type",v.value.mark_type.label),h.append("weightage",v.value.weightage),h.append("comment",v.value.comment||""),h.append("status",(f=v.value.status)==null?void 0:f.label),!v.value.section||!v.value.name||!v.value.targetMark||!v.value.status)return C.value=!1,u.add({severity:"error",summary:"Failed",detail:"Please fill all required fields",group:"br",life:3e3});const d=P("token"),{data:O,pending:k}=await R(`${ee.public.apiUrl}/kpi/sub-section-create`,{method:"POST",headers:{Authorization:`Bearer ${d.value}`},body:h},"$wlxClc7uGM");O.value?(_(),r.value=!1,v.value={},C.value=!1,u.add({severity:"success",summary:"Updated",detail:"Sub Section Created Successfully",group:"br",life:3e3})):(C.value=!1,u.add({severity:"error",summary:"Failed",detail:"Failed to create sub section!",group:"br",life:3e3}))},V=()=>{const h=g.value[g.value.length-1];if(h.section_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Section Not selected",group:"br",life:3e3});if(h.subsection_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Sub-section Not selected",group:"br",life:3e3});g.value.push({section_id:null,subsection_id:null,quater_id:null,achive_mark:0,comment:""})};qe(g,(h,d)=>{console.log(h)});const E=async()=>{const h=P("token");if(F.value=="")return u.add({severity:"error",summary:"KPI Information",detail:"Employee not selected",group:"br",life:3e3});if(c.value=="")return u.add({severity:"error",summary:"KPI Information",detail:"Quarter not selected",group:"br",life:3e3});if(S.value=="")return u.add({severity:"error",summary:"KPI Information",detail:"Deadline not selected",group:"br",life:3e3});const d=g.value[g.value.length-1];if(d.section_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Section Not selected",group:"br",life:3e3});if(d.subsection_id==null)return u.add({severity:"warn",summary:"KPI Information",detail:"Sub-section Not selected",group:"br",life:3e3});const O=g.value.map(f=>({user_id:F.value.id,section_id:f.section_id.id,subsection_id:f.subsection_id.id,quater_id:c.value.id,achive_mark:f.achive_mark,comment:f.comment,deadline:W(S.value)})),{data:k,error:Q}=await R(`${ee.public.apiUrl}/kpi/store`,{method:"POST",headers:{Authorization:`Bearer ${h.value}`},body:O},"$Fnl3NEI4jt");return k.value?(u.add({severity:"success",summary:"KPI Information",detail:"KPI Submission Complete",group:"br",life:3e3}),g.value=[{section_id:null,subsection_id:null,quater_id:null,achive_mark:0,target_mark:0,comment:""}],F.value="",i.value=!1):(i.value=!1,u.add({severity:"error",summary:"Failed",detail:"Failed to submit",group:"br",life:3e3}))},X=h=>{g.value.splice(h,1)},W=h=>{const d=new Date(h);return`${d.getFullYear()}-${("0"+(d.getMonth()+1)).slice(-2)}-${("0"+d.getDate()).slice(-2)}`},N=h=>{h.index==0&&(q(),B(),le(),_())};q(),B(),le(),_();const de=new Date;return p.value=de.getFullYear(),(h,d)=>{const O=Ce,k=$e,Q=Fe,f=be,M=Se,a=Te,o=Fl,y=vt,I=Qe,w=Ra,G=uo,te=Ve;return $(),j(_e,null,[e("div",mo,[t(O,{position:"bottom-right",group:"br"}),po,t(I,{onTabChange:N,class:"mt-3"},{default:b(()=>[l(ae)?($(),Z(a,{key:0,class:"file-upload",header:"KPI"},{default:b(()=>[t(I,null,{default:b(()=>[l(oe)?($(),Z(a,{key:0,header:"Generate"},{default:b(()=>[e("div",_o,[e("form",{action:"",class:"grid",style:{gap:"10px"},onSubmit:me(E,["prevent"])},[e("div",fo,[e("div",vo,[bo,t(k,{modelValue:l(F),"onUpdate:modelValue":d[0]||(d[0]=x=>J(F)?F.value=x:null),options:l(A),optionLabel:"name",placeholder:"Select User",class:"w-full"},null,8,["modelValue","options"])]),e("div",ho,[yo,t(k,{modelValue:l(c),"onUpdate:modelValue":d[1]||(d[1]=x=>J(c)?c.value=x:null),options:l(L),optionLabel:"name",placeholder:"Select Quarter",class:"w-full"},null,8,["modelValue","options"])]),e("div",go,[ko,t(Q,{modelValue:l(S),"onUpdate:modelValue":d[2]||(d[2]=x=>J(S)?S.value=x:null),dateFormat:"dd-mm-yy",placeholder:"DD-MM-YYYY"},null,8,["modelValue"])])]),l(F)!=""&&l(c)!==""?($(),j("div",wo,[($(!0),j(_e,null,we(l(g),(x,Y)=>{var ve,ge,m,fe;return $(),j("div",{key:Y,class:"card relative"},[Y!=0?($(),j("button",{key:0,type:"button",class:"close",onClick:ue=>X(Y)},Vo,8,$o)):K("",!0),e("div",xo,[e("div",Uo,[Do,t(k,{modelValue:l(g)[Y].section_id,"onUpdate:modelValue":ue=>l(g)[Y].section_id=ue,options:l(D),optionLabel:"name",placeholder:"Select Section",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),e("div",Co,[Fo,e("div",To,[t(k,{modelValue:l(g)[Y].subsection_id,"onUpdate:modelValue":ue=>l(g)[Y].subsection_id=ue,options:(ge=(ve=l(g)[Y])==null?void 0:ve.section_id)==null?void 0:ge.sub_section,optionLabel:"title",placeholder:"Select Sub Section",class:"w-full",style:{"max-width":"17rem"}},null,8,["modelValue","onUpdate:modelValue","options"]),t(f,{onClick:d[3]||(d[3]=()=>r.value=!0),icon:"pi pi-plus",severity:"success","aria-label":"Add New",class:""})])]),e("div",Eo,[Mo,t(k,{disabled:"",modelValue:l(c),"onUpdate:modelValue":d[4]||(d[4]=ue=>J(c)?c.value=ue:null),options:l(L),optionLabel:"name",placeholder:"Select Quarter",class:"w-full"},null,8,["modelValue","options"])]),e("div",qo,[e("label",Io,"Achieved Mark (Target: "+H(((m=l(g)[Y].subsection_id)==null?void 0:m.target_mark)||0)+H(((fe=l(g)[Y].subsection_id)==null?void 0:fe.mark_type)==1?"%":0)+")",1),t(M,{modelValue:l(g)[Y].achive_mark,"onUpdate:modelValue":ue=>l(g)[Y].achive_mark=ue,placeholder:"Input Mark",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Ao,[Lo,t(M,{modelValue:l(g)[Y].comment,"onUpdate:modelValue":ue=>l(g)[Y].comment=ue,placeholder:"Write comment",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])])}),128))])):K("",!0),e("div",Bo,[t(f,{label:"New Section",class:"bg-green-500 border-none",onClick:d[5]||(d[5]=me(x=>V(h.index),["prevent"]))}),t(f,{type:"submit",label:"Submit",class:"",disabled:l(F)===""||l(c)===""||l(S)===""},null,8,["disabled"])])],32)])]),_:1})):K("",!0),t(a,{header:"Submission"},{default:b(()=>[t(o,{quater:l(L)},null,8,["quater"])]),_:1}),t(a,{header:"Report"},{default:b(()=>[t(y,{quater:l(L)},null,8,["quater"])]),_:1})]),_:1})]),_:1})):K("",!0),l(z)?($(),Z(a,{key:1,header:"Sections"},{default:b(()=>[t(w)]),_:1})):K("",!0),l(re)?($(),Z(a,{key:2,header:"Quarter"},{default:b(()=>[t(G)]),_:1})):K("",!0)]),_:1})]),t(te,{visible:l(r),"onUpdate:visible":d[13]||(d[13]=x=>J(r)?r.value=x:null),modal:"",header:"Create Sub Section",style:{width:"40rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:b(()=>[e("form",{class:"",action:"",onSubmit:me(s,["prevent"])},[e("div",Qo,[e("div",Ko,[e("div",Po,[Oo,t(k,{modelValue:l(v).section,"onUpdate:modelValue":d[6]||(d[6]=x=>l(v).section=x),options:l(D),optionLabel:"name",placeholder:"Select Section",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e("div",Ro,[e("div",No,[jo,t(M,{type:"text",modelValue:l(v).name,"onUpdate:modelValue":d[7]||(d[7]=x=>l(v).name=x),placeholder:"Title",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",zo,[e("div",Wo,[Go,t(M,{type:"text",modelValue:l(v).weightage,"onUpdate:modelValue":d[8]||(d[8]=x=>l(v).weightage=x),placeholder:"Weightage",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",Yo,[e("div",Zo,[Ho,t(k,{modelValue:l(v).mark_type,"onUpdate:modelValue":d[9]||(d[9]=x=>l(v).mark_type=x),options:[{name:"Percentage (%)",label:1},{name:"Number (01)",label:0}],optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",Jo,[e("div",Xo,[es,t(M,{type:"number",modelValue:l(v).targetMark,"onUpdate:modelValue":d[10]||(d[10]=x=>l(v).targetMark=x),placeholder:"Set Target Mark",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",ls,[e("div",ts,[as,t(M,{type:"text",modelValue:l(v).comment,"onUpdate:modelValue":d[11]||(d[11]=x=>l(v).comment=x),placeholder:"Comment",min:"0",class:"w-full"},null,8,["modelValue"])])]),e("div",os,[e("div",ss,[ns,t(k,{modelValue:l(v).status,"onUpdate:modelValue":d[12]||(d[12]=x=>l(v).status=x),options:l(U),optionLabel:"name",placeholder:"Select Status",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])])]),e("div",is,[t(f,{label:"Create",severity:"info",type:"submit",loading:l(C)},null,8,["loading"])])])])],32)]),_:1},8,["visible"])],64)}}},ln=Me(ds,[["__scopeId","data-v-8a92889a"]]);export{ln as default};
