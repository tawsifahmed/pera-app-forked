import H from"./toast.esm.7a5f4c19.js";import q from"./multiselect.esm.e7c7d546.js";import J from"./calendar.esm.0a445aee.js";import Z from"./button.esm.7f915b6f.js";import K from"./toolbar.esm.9bce1566.js";import Q from"./column.esm.bad48978.js";import X from"./datatable.esm.1709ce08.js";import{a2 as ee,a6 as te,$ as v,ad as ae,ae as oe,b as y,i as a,l,w as V,u as p,e as A,F as U,o as D,ag as C,f as M,t as R,q as le,a3 as se,a4 as ne,ca as re}from"./entry.e3d024fb.js";import{u as T,a as ie}from"./cookie.bbdfbee5.js";import{u as N}from"./fetch.5df6b8b7.js";import{u as de}from"./workCompany.f22cac75.js";import ue from"./radiobutton.esm.5b746ce8.js";import"./portal.esm.e352cabe.js";import"./basecomponent.esm.1e75bdb5.js";import"./index.esm.ad69de90.js";import"./baseicon.esm.760a237c.js";import"./index.esm.a85e9c2b.js";import"./index.esm.a37f4bb4.js";import"./index.esm.1a25ecda.js";import"./checkbox.esm.53fff157.js";import"./index.esm.bfaec2db.js";import"./index.esm.7e495903.js";import"./index.esm.c2b97eac.js";import"./overlayeventbus.esm.9997582c.js";import"./virtualscroller.esm.624d1150.js";import"./index.esm.ea51d105.js";import"./index.esm.e91ad7d5.js";import"./index.esm.ac200d6e.js";import"./badge.esm.4135f5c9.js";import"./paginator.esm.0c5535f0.js";import"./index.esm.e319477c.js";import"./dropdown.esm.ce355c94.js";import"./inputnumber.esm.430988e9.js";import"./index.esm.c62c3d0b.js";import"./index.esm.26bfdb01.js";import"./inputtext.esm.213e50cf.js";import"./index.esm.386b821f.js";import"./index.esm.648c6045.js";import"./index.esm.3cf26f0c.js";import"./index.esm.e9d669d8.js";const g=F=>(se("data-v-50fafca5"),F=F(),ne(),F),ce={class:"card"},pe=g(()=>a("div",{class:"d-flex mr-2"},[a("h5",{class:"mb-1"},"User Reports")],-1)),me={class:"flex gap-2 flex-wrap"},fe={class:"user-selection w-full md:w-14rem w-full"},ve=g(()=>a("label",{class:"font-bold block mb-2"},"User:",-1)),_e={class:"flex justify-content-center"},he={class:"user-selection w-full md:w-14rem w-full"},ge=g(()=>a("label",{class:"font-bold block mb-2"},"Project:",-1)),be={class:"flex justify-content-center"},ye={class:"flex-auto"},De=g(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),ke={class:"flex-auto"},we=g(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),xe={class:"flex-auto ml-2"},Se=g(()=>a("label",{for:"icondisplay",class:"font-bold block mb-2"},"Date Type: ",-1)),$e={class:"flex flex-wrap gap-2 mt-3 mb-2 text-sm"},Ve=["for"],Ce={key:0,class:"card"},Fe={class:"flex align-items-center justify-content-between gap-2 mb-5"},Ie=g(()=>a("h5",{class:"m-0"},"Preview",-1)),je=g(()=>a("p",{class:"text-center"},"No Data found...",-1)),Pe={key:0,class:"font-bold"},Ue={__name:"index",setup(F){const{totalProjects:O}=te(de()),P=re(),d=v(""),S=v("Create"),z=v([{name:"Create",key:"A"},{name:"Due Date",key:"B"}]),u=v(""),_=v(""),m=v(),B=v([]),I=v(null),k=v(!1),w=v(!1),x=ae(),j=f=>{const t=f,s=new Date(t),o=s.getFullYear(),c=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");return`${o}-${c}-${i}`},L=async()=>{var n,b,e;if(_.value=="")return x.add({severity:"warn",summary:"Warning",detail:"Please Select User First",group:"br",life:3e3});if(d.value&&!u.value||!d.value&&u.value)return k.value=!1,x.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const f=T("token");k.value=!0;const t=j(d.value),s=j(u.value),o=new FormData,c=(n=_.value)==null?void 0:n.map(r=>r.id);if(console.log("User ID",c),c.forEach(r=>{o.append("user_id[]",r)}),m.value&&m.value.length>0){const r=(b=m.value)==null?void 0:b.map($=>$.id);console.log("Project ID",r),r.length>0&&r.forEach($=>{o.append("project_id[]",$)})}d.value&&u.value&&(S.value=="Create"?(o.append("start_date",t),o.append("end_date",s)):(o.append("start_due_date",t),o.append("end_due_date",s)));const{data:i,error:h}=await N(`${P.public.apiUrl}/tasks/task-report-view`,{method:"POST",headers:{Authorization:`Bearer ${f.value}`},body:o},"$3y9pxb6gbv");return((e=i.value)==null?void 0:e.code)==200?(I.value=i.value.data,k.value=!1):(k.value=!1,x.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},W=async()=>{var n,b;const f=T("token");if(w.value=!0,_.value=="")return w.value=!1,x.add({severity:"error",summary:"Failed",detail:"Please Select Employee",group:"br",life:3e3});if(d.value&&!u.value||!d.value&&u.value)return k.value=!1,x.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const t=j(d.value),s=j(u.value),o=new FormData,c=(n=_.value)==null?void 0:n.map(e=>e.id);if(console.log("User ID",c),c.forEach(e=>{o.append("user_id[]",e)}),m.value&&m.value.length>0){const e=(b=m.value)==null?void 0:b.map(r=>r.id);console.log("Project ID",e),e.length>0&&e.forEach(r=>{o.append("project_id[]",r)})}d.value&&u.value&&(S.value=="Create"?(o.append("start_date",t),o.append("end_date",s)):(o.append("start_due_date",t),o.append("end_due_date",s)));const{data:i,error:h}=await N(`${P.public.apiUrl}/tasks/task-report-download`,{method:"POST",headers:{Authorization:`Bearer ${f.value}`},body:o},"$JMgttPZ06P");if(h.value)return console.log(h),w.value=!1;if(i.value.code==200){const e=document.createElement("a");return e.href=i.value.download_path,e.target="_blank",e.click(),w.value=!1}else return w.value=!1,x.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},E=(f,t)=>{const s=new Date(t);f=="startDate"?d.value=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate():u.value=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()},Y=async()=>{var c,i,h;const f=T("token"),{data:t,pending:s,error:o}=await ie("taskAssignModalData",()=>$fetch(`${P.public.apiUrl}/users/list`,{headers:{Authorization:`Bearer ${f.value}`}}));((i=(c=t.value)==null?void 0:c.data)==null?void 0:i.length)>0&&(B.value=(h=t.value)==null?void 0:h.data)};oe(()=>{Y()});const G=()=>{_.value="",m.value=[],d.value="",u.value="",I.value=null};return(f,t)=>{const s=H,o=q,c=J,i=Z,h=K,n=Q,b=X;return D(),y(U,null,[a("div",ce,[l(s,{position:"bottom-right",group:"br"}),pe,l(h,{class:"border-0 px-0"},{start:V(()=>[a("div",me,[a("div",fe,[ve,a("div",_e,[l(o,{display:"chip",modelValue:p(_),"onUpdate:modelValue":t[0]||(t[0]=e=>C(_)?_.value=e:null),options:p(B),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select User",class:"w-full"},null,8,["modelValue","options"])])]),a("div",he,[ge,a("div",be,[l(o,{display:"chip",modelValue:p(m),"onUpdate:modelValue":t[1]||(t[1]=e=>C(m)?m.value=e:null),options:p(O),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full"},null,8,["modelValue","options"])])]),a("div",ye,[De,l(c,{modelValue:p(d),"onUpdate:modelValue":t[2]||(t[2]=e=>C(d)?d.value=e:null),onDateSelect:t[3]||(t[3]=e=>E("startDate",e)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),a("div",ke,[we,l(c,{modelValue:p(u),"onUpdate:modelValue":t[4]||(t[4]=e=>C(u)?u.value=e:null),onDateSelect:t[5]||(t[5]=e=>E("endtDate",e)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),a("div",xe,[Se,a("div",$e,[(D(!0),y(U,null,M(p(z),e=>(D(),y("div",{key:e.key,class:"flex align-items-center"},[l(p(ue),{modelValue:p(S),"onUpdate:modelValue":t[6]||(t[6]=r=>C(S)?S.value=r:null),inputId:e.key,name:"dynamic",value:e.name},null,8,["modelValue","inputId","value"]),a("label",{for:e.key,class:"ml-2"},R(e.name),9,Ve)]))),128))])])])]),end:V(()=>[l(i,{onClick:G,label:"Reset",class:"mr-2"}),l(i,{onClick:L,class:"",label:"Generate",loading:p(k)},null,8,["loading"])]),_:1})]),p(I)?(D(),y("div",Ce,[a("div",null,[a("div",Fe,[Ie,l(i,{onClick:W,class:"w-fit",label:"Download",loading:p(w)},null,8,["loading"])]),l(b,{value:p(I),tableStyle:"min-width: 50rem"},{empty:V(()=>[je]),default:V(()=>[l(n,{field:"task_name",header:"Task"}),l(n,{field:"project_name",header:"Project"}),l(n,{field:"assignee_name",header:"Assignee"},{body:V(e=>[(D(!0),y(U,null,M(e.data.assignee_name,(r,$)=>(D(),y("div",null,[le(R(r.name),1),$<e.data.assignee_name.length-1?(D(),y("span",Pe,", ")):A("",!0)]))),256))]),_:1}),l(n,{field:"task_status",header:"Status"}),l(n,{field:"task_due_date",header:"Due Date"}),l(n,{field:"task_date_done",header:"Completed Date"}),l(n,{field:"formatted_time_tracked",header:"Time Track"}),l(n,{field:"overdue",header:"Over Due"}),l(n,{field:"bounce",header:"Bounce"})]),_:1},8,["value"])])])):A("",!0)],64)}}},yt=ee(Ue,[["__scopeId","data-v-50fafca5"]]);export{yt as default};
