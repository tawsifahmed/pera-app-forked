import T from"./toast.esm.ef8cdcd7.js";import{_ as V}from"./nuxt-link.d5d115f9.js";import B from"./inputicon.esm.d7523654.js";import F from"./inputtext.esm.5cd40da3.js";import M from"./iconfield.esm.1b32a169.js";import E from"./button.esm.a55c2431.js";import{a2 as R,$ as i,a3 as K,a4 as O,b as Y,l as e,i as a,w as l,u as o,a5 as A,P as q,a as z,o as W,q as h,s as G,a6 as H}from"./entry.570ab878.js";import{u as J,a as Q}from"./cookie.3ed14f9e.js";import X from"./dialog.esm.0b6d087d.js";import{u as C}from"./company.198e2c6a.js";import{a as P}from"./usePermission.23a55d5e.js";import _ from"./column.esm.6208f1b7.js";import Z from"./datatable.esm.3837e306.js";import"./portal.esm.1e4af6e4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./baseicon.esm.c7f0dea4.js";import"./index.esm.2547ec1e.js";import"./index.esm.c6f3b761.js";import"./index.esm.417f68ee.js";import"./badge.esm.54d3e6c5.js";import"./index.esm.b72e702d.js";import"./fetch.11b9759f.js";import"./workCompany.886927d5.js";import"./paginator.esm.23dce669.js";import"./index.esm.c592065e.js";import"./dropdown.esm.4fa36b0b.js";import"./index.esm.d468d720.js";import"./index.esm.2cce7489.js";import"./overlayeventbus.esm.c91907e9.js";import"./virtualscroller.esm.84c3372a.js";import"./inputnumber.esm.9d737ca0.js";import"./index.esm.bb3da758.js";import"./index.esm.e450f24c.js";import"./index.esm.f3846021.js";import"./index.esm.b806f7cb.js";import"./index.esm.feb1baca.js";import"./checkbox.esm.1ad534d4.js";import"./radiobutton.esm.b232767f.js";import"./index.esm.a8b59750.js";import"./index.esm.ecdc2543.js";const ee={class:"card"},te={class:"d-flex create-space-btn-wrapper mb-3"},oe={class:"breadCrumWrap"},ie=a("p",{class:"pi pi-angle-right"},null,-1),ae=a("div",{class:"create-btn-wrapper"},null,-1),re={class:"flex justify-content-end mb-2"},se=a("i",{class:"pi pi-search"},null,-1),le=a("p",{class:"py-2 text-center"},"No Data found...",-1),ne=a("p",null,[h("Do you want to "),a("i",{class:"font-bold"},"unarchive"),h(" this project?")],-1),it={__name:"index",setup(ce){const{getSingleSpace:pe,deleteProject:de,editProject:S}=C(),{singleSpace:ue,isProjectDeleted:me,isProjectEdited:D}=R(C()),I=H(),N=i(P("archive_edit"));i(P("update_project")),i(P("delete_project"));const n=i(),x=i(!0),g=K();i(!1);const u=i([]),b=i(null),w=async()=>{var m,v,f;const r=J("token"),{data:t,pending:k,error:y}=await Q("tagsList",()=>$fetch(`${I.public.apiUrl}/projects/list?is_archive=1`,{headers:{Authorization:`Bearer ${r.value}`}}));((v=(m=t.value)==null?void 0:m.data)==null?void 0:v.length)>0&&(u.value=(f=t.value)==null?void 0:f.data.map((d,j)=>({...d,index:j+1})),console.log("archivedProjects",u.value.length),u.value.length===1?b.value=1:b.value=null)},c=i(null),$=i(null),p=i(!1),U=r=>{if(N.value===!1){g.add({severity:"error",summary:"Error",detail:"You do not have permission to unarchive project",group:"br",life:3e3});return}else c.value=r.id,console.log("refCompanyId",c.value),$.value=r.space_id,p.value=!0},L=async()=>{console.log("refCompanyIdFin",c.value);let r=0;const t={id:c.value,space_id:$.value,is_archive:r};await S(t),D.value===!0?(g.add({severity:"success",summary:"Successful",detail:"Project unarchived successfully",group:"br",life:3e3}),b.value===1&&location.reload(),w(),p.value=!1,console.log("space deleted"),c.value=null,unArchiveLoader.value=!1):(g.add({severity:"error",summary:"Error",detail:"Unable to unarchive project",group:"br",life:3e3}),console.log("space not deleted"),c.value=null,unArchiveLoader.value=!1)};return O(()=>{w(),x.value=!1}),(()=>{n.value={global:{value:null,matchMode:q.CONTAINS}}})(),(r,t)=>{const k=T,y=V,m=B,v=F,f=M,d=E,j=z("tooltip");return W(),Y("div",ee,[e(k,{position:"bottom-right",group:"br"}),a("div",te,[a("div",oe,[e(y,{to:"/",class:"text pi pi-home responsive-text"}),ie,e(y,{to:"/archived-projects",class:"text"},{default:l(()=>[h("Archived Projects")]),_:1})]),ae]),a("div",re,[e(f,{iconPosition:"right"},{default:l(()=>[e(m,null,{default:l(()=>[se]),_:1}),e(v,{modelValue:o(n).global.value,"onUpdate:modelValue":t[0]||(t[0]=s=>o(n).global.value=s),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),e(o(Z),{filters:o(n),"onUpdate:filters":t[1]||(t[1]=s=>A(n)?n.value=s:null),class:"table-dsp",value:o(u),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:20,rowsPerPageOptions:[5,10,20,50],dataKey:"id",filterDisplay:"menu",loading:o(x)},{empty:l(()=>[le]),loading:l(()=>[h(" Loading data. Please wait. ")]),default:l(()=>[e(o(_),{field:"index",header:"Serial",sortable:""}),e(o(_),{field:"name",header:"Project Name"}),e(o(_),{field:"space_name",header:"Under the Space of"}),e(o(_),{header:"Action"},{body:l(s=>[G(e(d,{icon:"pi pi-upload",text:"",class:"",severity:"warning",rounded:"",onClick:fe=>U(s.data)},null,8,["onClick"]),[[j,{value:"Unarchive"},void 0,{top:!0}]])]),_:1})]),_:1},8,["filters","value","loading"]),e(o(X),{visible:o(p),"onUpdate:visible":t[3]||(t[3]=s=>A(p)?p.value=s:null),header:" ",dismissableMask:"true",style:{width:"25rem"}},{default:l(()=>[ne,e(d,{label:"No",icon:"pi pi-times",text:"",onClick:t[2]||(t[2]=s=>p.value=!1)}),e(d,{label:"Yes",icon:"pi pi-check",loading:r.unArchiveLoader,text:"",onClick:L},null,8,["loading"])]),_:1},8,["visible"])])}}};export{it as default};
