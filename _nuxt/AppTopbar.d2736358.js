import At from"./toast.esm.ef8cdcd7.js";import Lt from"./button.esm.a55c2431.js";import{_ as Ot}from"./nuxt-link.d5d115f9.js";import Vt from"./dialog.esm.0b6d087d.js";import{N as st,a as qt,_ as Rt,b as zt,c as Ft}from"./Search.16769d56.js";import{a2 as G,a3 as Gt,$ as s,cd as Jt,a4 as it,ab as Qt,V as Yt,ak as Ht,Y as Wt,al as Kt,at as Xt,b as D,l as r,w as f,i as o,u as i,e as A,c as J,s as Q,k as Y,a5 as Zt,r as te,a as ee,o as m,t as oe,a6 as ae}from"./entry.570ab878.js";import{u as lt}from"./fetch.11b9759f.js";import{u as nt}from"./cookie.3ed14f9e.js";import{_ as se}from"./avatar.3c58da0e.js";import{u as rt}from"./user.8f004bf6.js";import{u as ut}from"./clock.2898074a.js";import{u as ct,o as ie,m as le}from"./auth.eab47870.js";import"./password.esm.4c141a5a.js";import{u as ne}from"./layout.b18253cb.js";import"./portal.esm.1e4af6e4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./baseicon.esm.c7f0dea4.js";import"./index.esm.2547ec1e.js";import"./index.esm.c6f3b761.js";import"./index.esm.417f68ee.js";import"./badge.esm.54d3e6c5.js";import"./index.esm.b72e702d.js";import"./inputtext.esm.5cd40da3.js";import"./floatlabel.esm.8c53ce5f.js";import"./tabpanel.esm.abefec25.js";import"./tabview.esm.354b8422.js";import"./index.esm.7c91399e.js";import"./index.esm.b806f7cb.js";import"./radiobutton.esm.b232767f.js";import"./editor.esm.83e67d7a.js";import"./company.198e2c6a.js";import"./workCompany.886927d5.js";import"./inputicon.esm.d7523654.js";import"./iconfield.esm.1b32a169.js";import"./card.esm.9c921175.js";import"./_commonjsHelpers.87174ba5.js";import"./index.esm.3c79b49a.js";import"./overlayeventbus.esm.c91907e9.js";const re={class:"layout-topbar"},ue=o("img",{src:se,alt:"logo"},null,-1),ce=o("i",{class:"pi pi-bars"},null,-1),de=[ce],me={class:"p-link layout-topbar-menu-button layout-topbar-button"},pe={key:0,class:"notification"},ve=o("i",{class:"pi pi-bell"},null,-1),fe=o("i",{class:"pi pi-ellipsis-v"},null,-1),_e=[fe],be=o("i",{class:"pi pi-moon"},null,-1),ke=o("i",{class:"pi pi-sun"},null,-1),he=o("i",{class:"pi pi-search"},null,-1),ge=o("span",null,"Search",-1),ye=[he,ge],Te={class:"relative"},Ce={key:0,class:"ping-container"},Se=o("span",{class:"ping-outer"},null,-1),De=o("span",{class:"ping-inner"},null,-1),Ie=[Se,De],we=o("i",{class:"pi pi-bell"},null,-1),Me=o("span",{class:"ml-4"},"Notification",-1),$e=[we,Me],xe={key:1,class:"notification"},Ne={key:0,class:"flex align-items-center gap-2"},Ee={class:"userImage"},Pe=["src"],Be={key:1,src:qt,alt:"",style:{height:"50px",width:"50px","border-radius":"50%","object-fit":"cover"}},Ue=o("span",{class:"ml-4"},"Profile",-1),je={class:"nclock-wrapper relative ml-2"},Ae=o("i",{class:Y("pi pi-stop text-white"),style:{"font-size":"11px","font-weight":"700"}},null,-1),Le=[Ae],Oe={class:"text-sm absolute text-black time-int",id:"timer-interval"},Ve=o("i",{class:"pi pi-sign-out"},null,-1),qe=o("span",null,"Sign Out",-1),Re=[Ve,qe],ze=o("p",null,"Are you sure you want to sign out?",-1),Po={__name:"AppTopbar",setup(Fe){var ot;const{getStoreTimer:dt,handleCloseDeadlineJustify:H}=ut(),{timerData:u,isTImerStopped:mt,deadlineMissModal:I,deadlineTaskId:pt,deadlineProjectId:vt,deadlineDueDate:ft}=G(ut()),{getUserData:_t}=rt(),{userProfile:L}=G(rt()),bt=Gt(),{layoutConfig:_,onMenuToggle:kt}=ne(),h=s(null),w=s(!1),ht=Jt(),W=ae();s("name"),s(null);const P=s(!1),{logUserOut:gt}=ct();G(ct());const B=s(!1),O=s(!1),b=s(!1),yt=()=>{gt(),location.reload(),ht.push("/login")};it(()=>{St()}),Qt(()=>{Dt()});const Tt=()=>{w.value=!w.value},Ct=Yt(()=>({"layout-topbar-menu-mobile-active":w.value})),St=()=>{h.value||(h.value=e=>{It(e)&&(w.value=!1)},document.addEventListener("click",h.value))},Dt=()=>{h.value&&(document.removeEventListener("click",h),h.value=null)},It=e=>{if(!w.value)return;const t=document.querySelector(".layout-topbar-menu"),l=document.querySelector(".layout-topbar-menu-button");return!(t.isSameNode(e.target)||t.contains(e.target)||l.isSameNode(e.target)||l.contains(e.target))},wt=()=>{b.value&&(b.value=!1,y.value=!1)},K=e=>{b.value=e},g={beforeMount(e,t){e.clickOutsideEvent=l=>{e==l.target||e.contains(l.target)||t.value(l)},document==null||document.body.addEventListener("click",e.clickOutsideEvent)},unmounted(e){var t;(t=document==null?void 0:document.body)==null||t.removeEventListener("click",e.clickOutsideEvent)}};Ht(()=>{const e=document.querySelector(".relative");g==null||g.unmounted(e)}),_t();const Mt=()=>{B.value=!B.value},$t=Wt(),xt=(e,t)=>{$t.changeTheme(_.theme.value,e,"theme-css",()=>{_.theme.value=e,_.darkTheme.value=t})},U=e=>{const t=e?_.theme.value.replace("light","dark"):_.theme.value.replace("dark","light");console.log("New Theme: ==>",t),e?localStorage.setItem("mode","dark"):localStorage.setItem("mode","light"),_.darkTheme.value=e,xt(t,e)};it(async()=>{const e=document.querySelector(".relative");g==null||g.beforeMount(e,{value:wt}),localStorage.getItem("mode")==="dark"?await U(!0):await U(!1)});const y=s(!1);(async()=>{const e=nt("token");try{const{data:t,pending:l,error:p}=await lt(`${W.public.apiUrl}/notification/list?limit=5&page=1`,{method:"GET",headers:{Authorization:`Bearer ${e.value}`}},"$QWEnQlnRVH");t.value&&(t.value.data.find(c=>c.is_read===0)?y.value=!0:y.value=!1)}catch(t){console.log(t)}})();const X=()=>{b.value=!b.value,y.value&&(y.value=!1)};s(!1);const V=s(),Z=s(),tt=s(),M=s(),et=localStorage.getItem("storeTaskCompanyID");localStorage.getItem("storeTaskSpaceID"),localStorage.getItem("storeTaskProjectID"),localStorage.getItem("storeTaskID");const Nt=s(),q=s();(async()=>{var t,l,p,c,v,d,C,S,k,$,x,N,E;const e=nt("token");try{const{data:n,pending:z,error:F}=await lt(`${W.public.apiUrl}/tasks/timer-history`,{method:"GET",headers:{Authorization:`Bearer ${e.value}`}},"$h9G4Eef10F");n.value&&(Nt.value=(l=(t=n.value)==null?void 0:t.data)==null?void 0:l.is_timer_start,((c=(p=n.value)==null?void 0:p.data)==null?void 0:c.is_timer_start)==="true"&&(V.value=(v=n.value)==null?void 0:v.data.company_id,Z.value=(C=(d=n.value)==null?void 0:d.data)==null?void 0:C.space_id,tt.value=(k=(S=n.value)==null?void 0:S.data)==null?void 0:k.project_id,M.value=(x=($=n.value)==null?void 0:$.data)==null?void 0:x.task_id,q.value=(E=(N=n.value)==null?void 0:N.data)==null?void 0:E.start_time))}catch(n){console.log(n)}})();const Et=s();u.value&&(Et.value=(ot=u.value)==null?void 0:ot.task_id),et&&(V.value=et),Kt(u,(e,t)=>{t&&(M.value=t.task_id)});let T=null;function R(e){const t=document.getElementById("timer-interval");if(e==="stop"){T&&(clearInterval(T),T=null);return}else{let p=function(){const v=new Date-l,d=Math.floor(v/(1e3*60*60)),C=Math.floor(v%(1e3*60*60)/(1e3*60)),S=Math.floor(v%(1e3*60)/1e3);return`${String(d).padStart(2,"0")}:${String(C).padStart(2,"0")}:${String(S).padStart(2,"0")}`};const l=new Date(e);return t&&(t.style.visibility="hidden"),setTimeout(()=>{t&&(t.style.visibility="visible")},500),T&&clearInterval(T),T=setInterval(()=>{t&&(t.textContent=p())},1e3),p()}}dt(),Xt(async()=>{mt.value===!0&&(M.value=null,R("stop")),u.value||M.value?O.value=!0:O.value=!1});const j=s(!1),Pt=e=>{j.value=!1},Bt=()=>{I.value=!1,H()},Ut=()=>{I.value=!1,H()};return ie(le,e=>{console.log(e),bt.add({severity:"contrast",summary:e.notification.title,detail:e.notification.body,life:3e3})}),(e,t)=>{var $,x,N,E,n,z,F;const l=At,p=te("router-link"),c=Lt,v=Ot,d=Vt,C=zt,S=Ft,k=ee("tooltip");return m(),D("div",re,[r(l,{position:"bottom-right",group:"br"}),r(p,{to:"/",class:"layout-topbar-logo absolute"},{default:f(()=>[ue]),_:1}),o("button",{class:"p-link layout-menu-button layout-topbar-button",style:{"margin-left":"0 !important"},onClick:t[0]||(t[0]=a=>i(kt)())},de),o("div",me,[o("button",{class:"nav-btn",onClick:X},[b.value?(m(),D("div",pe,[r(st,{onCloseNotification:t[1]||(t[1]=a=>K(a))})])):A("",!0),ve]),o("button",{class:"nav-btn",onClick:t[2]||(t[2]=a=>Tt())},_e)]),o("div",{class:Y(["layout-topbar-menu",Ct.value])},[i(_).darkTheme.value?(m(),J(c,{key:0,onClick:t[3]||(t[3]=()=>U(!1)),class:"p-link layout-topbar-button",text:"",rounded:"","aria-label":"Filter"},{default:f(()=>[be]),_:1})):(m(),J(c,{key:1,onClick:t[4]||(t[4]=()=>U(!0)),class:"p-link layout-topbar-button",text:"",rounded:"","aria-label":"Filter"},{default:f(()=>[ke]),_:1})),o("button",{class:"p-link layout-topbar-button ml-0",onClick:t[5]||(t[5]=a=>j.value=!0),style:{"padding-top":"0.1rem"}},ye),o("div",Te,[y.value?(m(),D("div",Ce,Ie)):A("",!0),o("button",{onClick:X,class:"p-link layout-topbar-button notify-btn ml-0"},$e),b.value?(m(),D("div",xe,[r(st,{onCloseNotification:t[6]||(t[6]=a=>K(a))})])):A("",!0)]),o("button",{onClick:Mt,class:"p-link layout-topbar-button"},[(x=($=i(L))==null?void 0:$.data)!=null&&x.image?Q((m(),D("div",Ne,[o("div",Ee,[o("img",{src:`${(E=(N=i(L))==null?void 0:N.data)==null?void 0:E.image}`,class:"",style:{height:"100%",width:"100%","object-fit":"cover"}},null,8,Pe)])])),[[k,{value:"Profile"},void 0,{bottom:!0}]]):Q((m(),D("img",Be,null,512)),[[k,{value:"Profile"},void 0,{bottom:!0}]]),Ue]),O.value?Q((m(),J(v,{key:2,to:{path:`/companies/${V.value}/spaces/${i(u)?(n=i(u))==null?void 0:n.space_id:Z.value}/projects/${i(u)?(z=i(u))==null?void 0:z.project_id:tt.value}`,query:{task_key:i(u)?(F=i(u))==null?void 0:F.task_id:M.value}},class:"flex absolute gap-2 align-items-center ntask-timer-wrapper mr-2"},{default:f(()=>{var a,at;return[o("div",je,[o("div",{class:Y("nclock-btn bg-pink-300"),onClick:t[7]||(t[7]=(...jt)=>e.handleClickClock&&e.handleClickClock(...jt))},Le),o("div",Oe,oe((a=i(u))!=null&&a.timerStartTime?R((at=i(u))==null?void 0:at.timerStartTime):q.value?R(q.value):" "),1)])]}),_:1},8,["to"])),[[k,{value:"Active Task"},void 0,{left:!0}]]):A("",!0),o("button",{onClick:t[8]||(t[8]=a=>P.value=!0),class:"p-link layout-topbar-button"},Re),r(d,{visible:P.value,"onUpdate:visible":t[10]||(t[10]=a=>P.value=a),modal:"",header:"Signing out?",style:{width:"25rem"},dismissableMask:"true"},{default:f(()=>[ze,r(c,{label:"No",icon:"pi pi-times",text:"",onClick:t[9]||(t[9]=a=>P.value=!1)}),r(c,{label:"Yes",icon:"pi pi-check",loading:e.btnLoading,text:"",onClick:yt},null,8,["loading"])]),_:1},8,["visible"])],2),r(d,{visible:B.value,"onUpdate:visible":t[11]||(t[11]=a=>B.value=a),modal:"",header:"Profile",dismissableMask:"true",style:{width:"65rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:f(()=>[r(C,{userProfile:i(L)},null,8,["userProfile"])]),_:1},8,["visible"]),r(d,{visible:i(I),"onUpdate:visible":[t[13]||(t[13]=a=>Zt(I)?I.value=a:null),Ut],modal:"",header:"Deadline Miss Justification",style:{width:"45rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:f(()=>[r(S,{onCloseMissDeadlineModal:t[12]||(t[12]=a=>Bt(a)),deadlineTaskId:i(pt),deadlineProjectId:i(vt),deadlineDueDate:i(ft)},null,8,["deadlineTaskId","deadlineProjectId","deadlineDueDate"])]),_:1},8,["visible"]),r(d,{visible:j.value,"onUpdate:visible":t[15]||(t[15]=a=>j.value=a),modal:"",header:"Search",dismissableMask:"true",position:"top",class:"search-container"},{default:f(()=>[r(Rt,{onCloseSearch:t[14]||(t[14]=a=>Pt(a))})]),_:1},8,["visible"])])}}};export{Po as default};
