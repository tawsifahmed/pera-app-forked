import ae from"./toast.esm.ce38771d.js";import H from"./button.esm.c54db15a.js";import re from"./inputicon.esm.714e5b85.js";import q from"./inputtext.esm.233582dc.js";import ne from"./iconfield.esm.8ed024d0.js";import ce from"./toolbar.esm.2a700d64.js";import de from"./progressspinner.esm.5abe8272.js";import W from"./multiselect.esm.02a2f9e7.js";import{a4 as j,$ as t,a5 as K,a6 as Z,a as pe,o as x,b as V,i as o,q as N,s as G,l,u as e,a7 as D,e as E,ca as X,a2 as me,a8 as ue,a9 as _e,w as _,P as ve,c as O,F as fe,f as xe,t as ye}from"./entry.e89720bc.js";import{u as A,a as ee,b as J}from"./cookie.f9cf43a3.js";import I from"./column.esm.23462c2c.js";import be from"./datatable.esm.6b7235cc.js";import{a as z}from"./usePermission.a160ee1c.js";import Q from"./dialog.esm.7fe8ed85.js";import"./portal.esm.a34e9c64.js";import"./basecomponent.esm.91e596c6.js";import"./index.esm.8eab902c.js";import"./baseicon.esm.fe79efc6.js";import"./index.esm.041242c3.js";import"./index.esm.441b8d98.js";import"./index.esm.e703480f.js";import"./badge.esm.cf8f221b.js";import"./index.esm.c9862811.js";import"./checkbox.esm.d0c3b3d0.js";import"./index.esm.14e1d642.js";import"./index.esm.272ad973.js";import"./overlayeventbus.esm.b72d439b.js";import"./virtualscroller.esm.2f55518a.js";import"./paginator.esm.7495ebe4.js";import"./index.esm.f40e3f95.js";import"./dropdown.esm.1498a871.js";import"./inputnumber.esm.e84393aa.js";import"./index.esm.edc43b09.js";import"./index.esm.50bef698.js";import"./index.esm.d38d4e1f.js";import"./index.esm.11311365.js";import"./index.esm.b0b5ba0a.js";import"./radiobutton.esm.ea07f46b.js";import"./index.esm.da61ff69.js";import"./index.esm.e73d6386.js";const he={class:"field"},ge={for:"company"},$e=o("i",{class:"text-red-400 text-italic"},"*",-1),Te={class:"pi pi-info-circle cursor-pointer ml-1 text-sm instruction-tip"},Re={class:"field permission_selection"},ke=o("i",{class:"text-red-400 text-italic"},"*",-1),we={class:"pi pi-info-circle cursor-pointer ml-1 text-sm instruction-tip"},Ce={key:0,style:{color:"red"}},Se={class:"create-btn-wrapper mb-0"},Pe={__name:"CreateRole",props:{param:{type:Object,required:!0}},emits:["closeCreateModal"],setup(b,{emit:L}){const M=X(),h=b,g=j(),a=t(""),v=t(h.param.permissionsList),d=t([]),r=t(!1),y=t(!0),f=L,w=async()=>{var u;if(a.value===""){r.value=!0;return}else if(r.value=!1,!r.value){const i=A("token"),{data:p,pending:$}=await ee(`${M.public.apiUrl}/roles/create`,{method:"POST",headers:{Authorization:`Bearer ${i.value}`},body:{name:a.value,permissions:d.value.map(T=>T.id)}},"$lLTkTCcXoV");((u=p.value)==null?void 0:u.code)===201?(a.value=null,y.value=!1,f("closeCreateModal",!1),g.add({severity:"success",summary:"Success",detail:"Role Created successfully!",group:"br",life:3e3})):g.add({severity:"error",summary:"Error",detail:"Role Creation Failed!",group:"br",life:3e3})}};return K(()=>{const u=document.getElementById("createRoleName");Z(()=>{u&&u.focus()})}),(u,i)=>{const p=q,$=W,T=H,R=pe("tooltip");return x(),V("div",null,[o("div",he,[o("label",ge,[N("Role Name"),$e,N(),G(o("span",Te,null,512),[[R,{value:"Demo Text Text Demo Text Text Demo Text Text Demo Text Text Demo Text Text."},void 0,{right:!0}]])]),l(p,{id:"createRoleName",modelValue:e(a),"onUpdate:modelValue":i[0]||(i[0]=m=>D(a)?a.value=m:null),class:"w-full",placeholder:"Enter role name"},null,8,["modelValue"])]),o("div",Re,[o("label",null,[N("Permissions"),ke,N(),G(o("span",we,null,512),[[R,{value:"Demo Text Text Demo Text Text Demo Text Text Demo Text Text Demo Text Text."},void 0,{right:!0}]])]),l($,{display:"chip",modelValue:e(d),"onUpdate:modelValue":i[1]||(i[1]=m=>D(d)?d.value=m:null),options:e(v),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(r)?(x(),V("p",Ce,"Please enter role name")):E("",!0),o("div",Se,[l(T,{label:"Save",icon:"pi pi-check",text:"",onClick:w})])])}}};const te=b=>(ue("data-v-ae8a0175"),b=b(),_e(),b),Ve={class:"field"},De=te(()=>o("label",{for:"company"},[N("Role Name"),o("i",{class:"text-red-400 text-italic"},"*")],-1)),Le={class:"field permission_selection"},Ne=te(()=>o("label",null,[N("Permissions"),o("i",{class:"text-red-400 text-italic"},"*")],-1)),Ee={key:0,style:{color:"red"}},Me={class:"create-btn-wrappe"},Ue={__name:"EditRole",props:{param:{type:Object,required:!0}},emits:["closeEditModal"],setup(b,{emit:L}){const M=X(),h=b,g=j(),a=t(h.param.id),v=t(h.param.name),d=t(h.param.permissionsList),r=t(h.param.slctdPermissions),y=t(!1),f=t(!0),w=L,u=async()=>{var i;if(v.value===""){y.value=!0;return}else if(y.value=!1,!y.value){const p=A("token"),{data:$,pending:T}=await ee(`${M.public.apiUrl}/roles/update/${a.value}`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:{name:v.value,permissions:r.value.map(R=>R.id)}},"$AftFLbfnYe");((i=$.value)==null?void 0:i.code)===200?(f.value=!1,w("closeEditModal",!1),g.add({severity:"success",summary:"Success",detail:"Role updated successfully!",group:"br",life:3e3})):g.add({severity:"error",summary:"Error",detail:"Failed to update role!",group:"br",life:3e3})}};return K(async()=>{const i=document.getElementById("editTeamName");Z(()=>{i&&i.focus()})}),(i,p)=>{const $=q,T=W,R=H;return x(),V("div",null,[o("div",Ve,[De,l($,{id:"editTeamName",modelValue:e(v),"onUpdate:modelValue":p[0]||(p[0]=m=>D(v)?v.value=m:null),class:"w-full",placeholder:"Edit role name"},null,8,["modelValue"])]),o("div",Le,[Ne,l(T,{display:"chip",modelValue:e(r),"onUpdate:modelValue":p[1]||(p[1]=m=>D(r)?r.value=m:null),options:e(d),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(y)?(x(),V("p",Ee,"Please enter tag name")):E("",!0),o("div",Me,[l(R,{label:"Update",icon:"pi pi-check",text:"",onClick:u})])])}}},Be=me(Ue,[["__scopeId","data-v-ae8a0175"]]);const Fe={key:0,class:"card"},Ie=o("div",{class:"d-flex mr-2"},[o("h5",{class:"mb-1"},"User Role")],-1),Ae=o("i",{class:"pi pi-search"},null,-1),Oe=o("p",{class:"text-center"},"No Data found...",-1),ze={style:{display:"flex","flex-wrap":"wrap",gap:"5px"}},Pt={__name:"index",setup(b){const L=X(),M=t(z("read_role")),h=t(z("create_role")),g=t(z("update_role")),a=t(),v=t(!0);j();const d=t(!1),r=t(!1),y=t([]),f=t([]),w=t([]),u=t(""),i=t(""),p=c=>{d.value=!1,m()},$=c=>{r.value=!1,m()},T=()=>{d.value=!0,m()},R=c=>{var s;r.value=!0,u.value=c.id,i.value=c.name,f.value=f.value,w.value=[],((s=c==null?void 0:c.permissions)==null?void 0:s.length)>0&&c.permissions.map(U=>{f.value.map(k=>{U.id===k.id&&w.value.push(k)})})},m=async()=>{var C,S,P;const c=A("token"),{data:s,pending:U,error:k}=await J("roleList",()=>$fetch(`${L.public.apiUrl}/roles/list`,{headers:{Authorization:`Bearer ${c.value}`}}));((S=(C=s.value)==null?void 0:C.data)==null?void 0:S.length)>0&&(y.value=(P=s.value)==null?void 0:P.data.map((B,F)=>({...B,index:F+1})))},oe=async()=>{var C,S,P;const c=A("token"),{data:s,pending:U,error:k}=await J("permissionList",()=>$fetch(`${L.public.apiUrl}/permissions/list`,{headers:{Authorization:`Bearer ${c.value}`}}));((S=(C=s.value)==null?void 0:C.data)==null?void 0:S.length)>0&&(f.value=(P=s.value)==null?void 0:P.data.map((B,F)=>({...B,index:F+1})))},se=()=>{a.value={global:{value:null,matchMode:ve.CONTAINS}}};return K(()=>{m(),oe(),v.value=!1}),se(),(c,s)=>{const U=ae,k=H,C=re,S=q,P=ne,B=ce,F=de,le=Pe,ie=Be;return e(M)?(x(),V("div",Fe,[l(U,{position:"bottom-right",group:"br"}),Ie,l(B,{class:"border-0 px-0"},{start:_(()=>[e(h)?(x(),O(k,{key:0,icon:"pi pi-plus",label:"Create",onClick:T,class:"mr-2",severity:"secondary"})):E("",!0)]),end:_(()=>[l(P,{iconPosition:"right",raised:""},{default:_(()=>[l(C,null,{default:_(()=>[Ae]),_:1}),l(S,{modelValue:e(a).global.value,"onUpdate:modelValue":s[0]||(s[0]=n=>e(a).global.value=n),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),_:1}),l(e(be),{filters:e(a),"onUpdate:filters":s[1]||(s[1]=n=>D(a)?a.value=n:null),class:"table-stR",value:e(y),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:e(v)},{empty:_(()=>[Oe]),loading:_(()=>[l(F,{style:{width:"50px",height:"50px"}})]),default:_(()=>[l(e(I),{field:"index",header:"Serial",sortable:""}),l(e(I),{style:{"text-wrap":"nowrap"},field:"name",header:"Role Name"}),l(e(I),{field:"permissions",header:"Permission"},{body:_(n=>[o("div",ze,[(x(!0),V(fe,null,xe(n.data.permissions,Y=>(x(),V("div",{class:"border rounded",key:c.permission,style:{border:"1px solid rgba(167, 167, 167, 0.486)","border-radius":"5px",padding:"2px 5px"}},[o("p",null,ye(Y.name),1)]))),128))])]),_:1}),l(e(I),{field:"action",header:"Action"},{body:_(n=>[e(g)?(x(),O(k,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:Y=>R(n.data)},null,8,["onClick"])):E("",!0),e(g)?E("",!0):(x(),O(k,{key:1,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),l(e(Q),{visible:e(d),"onUpdate:visible":s[3]||(s[3]=n=>D(d)?d.value=n:null),modal:"",header:"Create Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:_(()=>[l(le,{param:{permissionsList:e(f)},onCloseCreateModal:s[2]||(s[2]=n=>p(n))},null,8,["param"])]),_:1},8,["visible"]),l(e(Q),{visible:e(r),"onUpdate:visible":s[5]||(s[5]=n=>D(r)?r.value=n:null),modal:"",header:"Edit Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:_(()=>[l(ie,{param:{id:e(u),name:e(i),permissionsList:e(f),slctdPermissions:e(w)},onCloseEditModal:s[4]||(s[4]=n=>$(n))},null,8,["param"])]),_:1},8,["visible"])])):E("",!0)}}};export{Pt as default};
