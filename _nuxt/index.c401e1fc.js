import ye from"./toast.esm.ef8cdcd7.js";import{_ as xe}from"./nuxt-link.d5d115f9.js";import{_ as be}from"./CreateSpecificProject.304f88a8.js";import ke from"./inputicon.esm.d7523654.js";import me from"./inputtext.esm.5cd40da3.js";import je from"./iconfield.esm.1b32a169.js";import ve from"./button.esm.a55c2431.js";import we from"./textarea.esm.c90f9326.js";import Se from"./inputgroupaddon.esm.1285f9f6.js";import Pe from"./inputgroup.esm.8bb2a589.js";import Ce from"./dropdown.esm.4fa36b0b.js";import{d as $e}from"./vuedraggable.umd.e8c4ca38.js";import{a2 as _e,a3 as fe,$ as l,V as re,al as ue,a4 as ge,ar as Ve,a as he,o as f,b as $,u as e,i as t,q as C,t as X,l as s,a5 as g,w as u,s as F,e as P,K as Ee,as as Ne,ai as Te,c as G,P as De}from"./entry.570ab878.js";import{u as Q}from"./company.198e2c6a.js";import pe from"./colorpicker.esm.1250a2eb.js";import"./inputswitch.esm.5c1885a6.js";import ce from"./dialog.esm.0b6d087d.js";import{a as W}from"./usePermission.23a55d5e.js";import z from"./column.esm.6208f1b7.js";import Ue from"./datatable.esm.3837e306.js";import"./portal.esm.1e4af6e4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./baseicon.esm.c7f0dea4.js";import"./index.esm.2547ec1e.js";import"./index.esm.c6f3b761.js";import"./index.esm.417f68ee.js";import"./fetch.11b9759f.js";import"./cookie.3ed14f9e.js";import"./workCompany.886927d5.js";import"./badge.esm.54d3e6c5.js";import"./index.esm.b72e702d.js";import"./index.esm.d468d720.js";import"./index.esm.2cce7489.js";import"./overlayeventbus.esm.c91907e9.js";import"./virtualscroller.esm.84c3372a.js";import"./_commonjsHelpers.87174ba5.js";import"./paginator.esm.23dce669.js";import"./index.esm.c592065e.js";import"./inputnumber.esm.9d737ca0.js";import"./index.esm.bb3da758.js";import"./index.esm.e450f24c.js";import"./index.esm.f3846021.js";import"./index.esm.b806f7cb.js";import"./index.esm.feb1baca.js";import"./checkbox.esm.1ad534d4.js";import"./radiobutton.esm.b232767f.js";import"./index.esm.a8b59750.js";import"./index.esm.ecdc2543.js";const Ie={class:"position-relative d-flex flex-column justify-content-between w-100 modal-container"},Le={key:0},Me={class:"field"},Oe={for:"name"},Be={class:"field flex flex-column"},Fe=t("label",{for:"editProjectName"},[C("Project Name"),t("i",{class:"text-red-400 text-italic"},"*")],-1),Ae={class:"field flex flex-column"},qe=t("label",{for:"name"},"Project Description",-1),Ge={class:"mb-4"},Ke=t("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[C("Setup Task Status"),t("i",{class:"text-red-400 text-italic"},"*")],-1),Je={class:""},Re=t("p",{class:"pi pi-plus cursor-pointer"},null,-1),He={key:0,class:"text-red-600 text-small"},Ye={class:"row mt-2"},We={class:"col-12 d-flex flex-column p-0"},ze=["onMouseenter"],Xe={style:{"margin-right":"-3px"},width:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",class:"cu-status-manager-status-list-item__drag-handler-icon"},Qe=t("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},[t("circle",{cx:"5",cy:"5",r:"1"}),t("circle",{cx:"5",cy:"12",r:"1"}),t("circle",{cx:"5",cy:"19",r:"1"}),t("circle",{cx:"12",cy:"5",r:"1"}),t("circle",{cx:"12",cy:"12",r:"1"}),t("circle",{cx:"12",cy:"19",r:"1"})],-1),Ze=[Qe],et={class:"flex align-items-center",style:{width:"88%"}},tt=["onClick"],ot=t("p",{class:"pi pi-times"},null,-1),st=[ot],lt={class:""},at=t("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[C("Set Task Close Status"),t("i",{class:"text-red-400 text-italic"},"*")],-1),it={class:""},nt={class:"field"},rt={key:0,class:"text-red-600 text-small"},ct={class:"flex w-full gap-2"},dt={class:"field flex flex-column mb-3",style:{width:"49%"}},ut=t("label",{for:"name"},"Gitlab ID ",-1),pt={class:"field flex flex-column mb-3",style:{width:"49%"}},mt=t("label",{for:"name"},"Gitlab Token ",-1),vt={key:0,class:"text-center",style:{color:"red"}},_t={class:"float-right"},ft={__name:"EditProject",props:["refProjectId","singleSpace"],emits:["closeEditProject"],setup(Z,{emit:ee}){const{editProject:te}=Q(),{isProjectEdited:oe}=_e(Q()),h=fe(),{refProjectId:i,singleSpace:de}=Z,K=ee,se=l(!0),T=l(!1),J=l(!0),R=l(!1),b=l(null),H=l(!0),V=re(()=>({animation:250,group:"tasks",disabled:!H.value,ghostClass:"ghost"})),D=re(()=>({backgroundColor:"inherit",boxShadow:"0px 2px 2px inherit",cursor:"grab",margin:"8px 0px"})),p=re(()=>({backgroundColor:"inherit",boxShadow:"0px 4px 4px inherit",cursor:"grab",margin:"8px 0px"})),y=l(""),S=l(i==null?void 0:i.statuses.map((a,o)=>({...a,serial_no:o+1}))),d=l([]);d.value=JSON.parse(JSON.stringify(S.value));const x=l("6466f1"),E=l(null),U=l(!1),k=l(i==null?void 0:i.name),I=l(i==null?void 0:i.description),A=l(i==null?void 0:i.git_project_id),j=l(i==null?void 0:i.git_token),le=()=>{var a;if(y.value?U.value=!1:U.value=!0,((a=y==null?void 0:y.value)==null?void 0:a.length)>0){const o={name:y.value,color_code:`#${x.value}`,is_closed_status:0,serial_no:d.value.length+1};d.value.push(o),y.value=""}else U.value=!0;d.value.length>0&&(E.value=!0)},ae=a=>{var o,m;d.value.splice(a,1),((o=w.value)==null?void 0:o.is_closed_status)===((m=d.value[a])==null?void 0:m.is_closed_status)&&(w.value=null),d.value.length==0&&(E.value=!1)},w=l(null);w.value=d.value.find(a=>a.is_closed_status===1),ue(w,a=>{a&&d.value.forEach(o=>{o.is_closed_status=o.name===a.name?1:0})}),ue(d,a=>{a.forEach((o,m)=>{o.serial_no=m+1})});const _=a=>a.map(o=>({taskStatusName:o.name,taskStatusColor:o.color_code.startsWith("#")?o.color_code:`#${o.color_code}`,is_closed_status:o.is_closed_status,serial_no:o.serial_no})),c=l(!1),ie=async()=>{if(c.value=!0,k.value===null||d.value.length<=0||!w.value)T.value=!0,c.value=!1;else{T.value=!1,d.value.forEach(M=>{const v=["color_code","name","is_closed_status","serial_no"];Object.keys(M).forEach(O=>{v.includes(O)||delete M[O]})});const a=JSON.parse(JSON.stringify(d.value)),o=_(a);console.log("shallow List",a),console.log("transformedTaskStatusList",o);const m={id:i==null?void 0:i.id,name:k.value,description:I.value,space_id:i==null?void 0:i.space_id,statuses:o,git_project_id:A.value,git_token:j.value};await te(m),oe.value===!0?(K("closeEditProject",!1),c.value=!1,h.add({severity:"success",summary:"Project creation",detail:"Project updated successfully!",group:"br",life:3e3})):(c.value=!1,h.add({severity:"error",summary:"Project creation",detail:"Failed to update project!",group:"br",life:3e3}))}},L=()=>{K("closeEditProject",!1)};return ge(()=>{S.value=i==null?void 0:i.statuses;const a=document.getElementById("editProjectName");Ve(()=>{a&&a.focus()})}),(a,o)=>{var n;const m=me,M=we,v=Se,O=Pe,Y=Ce,q=ve,N=he("tooltip");return f(),$("div",Ie,[e(se)?(f(),$("div",Le,[t("div",Me,[t("label",Oe,[C("Project: "),t("strong",null,X((n=Z.refProjectId)==null?void 0:n.name),1)])]),t("div",Be,[Fe,s(m,{id:"editProjectName",modelValue:e(k),"onUpdate:modelValue":o[0]||(o[0]=r=>g(k)?k.value=r:null),required:"true"},null,8,["modelValue"])]),t("div",Ae,[qe,s(M,{id:"description",class:"border-gray-300",modelValue:e(I),"onUpdate:modelValue":o[1]||(o[1]=r=>g(I)?I.value=r:null),rows:"3",cols:"20"},null,8,["modelValue"])]),t("div",Ge,[Ke,t("div",Je,[s(O,null,{default:u(()=>[s(v,null,{default:u(()=>[F(s(e(pe),{class:"color-pick",style:{width:"1.5rem"},modelValue:e(x),"onUpdate:modelValue":o[2]||(o[2]=r=>g(x)?x.value=r:null),inputId:"cp-hex",format:"hex"},null,8,["modelValue"]),[[N,{value:"Pick Color"},void 0,{left:!0}]])]),_:1}),F(s(m,{class:"form-control",modelValue:e(y),"onUpdate:modelValue":o[3]||(o[3]=r=>g(y)?y.value=r:null),placeholder:"e.g., TO-DO, DOING"},null,8,["modelValue"]),[[N,{value:"Type Status Name"},void 0,{top:!0}]]),s(v,{onClick:le,class:"btn btn-outline-secondary cursor-pointer"},{default:u(()=>[Re]),_:1})]),_:1}),e(U)?(f(),$("p",He,"Please type status name!")):P("",!0),t("div",Ye,[t("div",We,[s(e($e),{modelValue:e(d),"onUpdate:modelValue":o[5]||(o[5]=r=>g(d)?d.value=r:null),options:e(V),disabled:!e(J),class:"list-group","ghost-class":"ghost",move:a.checkMove,onStart:o[6]||(o[6]=r=>R.value=!0),onEnd:o[7]||(o[7]=r=>R.value=!1)},{item:u(({element:r,index:ne})=>[(f(),$("div",{class:"flex delete-task justify-content-between",style:Ee(e(b)===ne?e(p):e(D)),onMouseenter:B=>b.value=ne,onMouseleave:o[4]||(o[4]=B=>b.value=null),key:r.id},[(f(),$("svg",Xe,Ze)),t("div",et,[F(s(e(pe),{class:"color-pick mr-2 status-colors border-none",modelValue:r.color_code,"onUpdate:modelValue":B=>r.color_code=B,inputId:"cp-hex",format:"hex"},null,8,["modelValue","onUpdate:modelValue"]),[[N,{value:"Change Color"},void 0,{left:!0}]]),F(s(m,{class:"text-uppercase text-muteds w-full",modelValue:r.name,"onUpdate:modelValue":B=>r.name=B,required:"true"},null,8,["modelValue","onUpdate:modelValue"]),[[N,{value:"Change Status Name"},void 0,{right:!0}]])]),t("div",{onClick:B=>ae(ne),class:"cursor-pointer cross-icon ms-1 flex justify-content-center align-items-center"},st,8,tt)],44,ze))]),_:1},8,["modelValue","options","disabled","move"])])])])]),t("div",lt,[at,t("div",it,[t("div",nt,[s(Y,{modelValue:e(w),"onUpdate:modelValue":o[8]||(o[8]=r=>g(w)?w.value=r:null),options:e(d),optionLabel:"name",placeholder:"Select Status",class:"w-full"},null,8,["modelValue","options"])]),a.closeStatusError?(f(),$("p",rt,"Please set close status!")):P("",!0)])]),t("div",ct,[t("div",dt,[ut,s(m,{modelValue:e(A),"onUpdate:modelValue":o[9]||(o[9]=r=>g(A)?A.value=r:null),type:"number",required:"true"},null,8,["modelValue"])]),t("div",pt,[mt,s(m,{modelValue:e(j),"onUpdate:modelValue":o[10]||(o[10]=r=>g(j)?j.value=r:null),type:"text",required:"true"},null,8,["modelValue"])])]),e(T)?(f(),$("p",vt,"Please add/fill/check up all the fields")):P("",!0)])):P("",!0),t("div",_t,[s(q,{label:"Cancel",icon:"pi pi-times",text:"",onClick:L}),s(q,{loading:e(c),label:"Save",icon:"pi pi-check",text:"",onClick:ie},null,8,["loading"])])])}}};const gt={class:"card"},ht={class:"d-flex create-space-btn-wrapper mb-3"},yt={class:"breadCrumWrap"},xt=t("p",{class:"pi pi-angle-right"},null,-1),bt=t("p",{class:"pi pi-angle-right responsive-text"},null,-1),kt=t("p",{class:"pi pi-angle-right responsive-text"},null,-1),jt={class:"text cursor-pointer responsive-text"},wt={class:"create-btn-wrapper"},St={class:"flex justify-content-end mb-2"},Pt=t("i",{class:"pi pi-search"},null,-1),Ct=t("p",{class:"py-2 text-center"},"No Data found...",-1),$t={class:"cursor-pointer hover:text-primary font-semibold"},Vt=t("p",null,"Are you sure you want to delete?",-1),Et=t("p",null,[C("Do you want to "),t("i",{class:"font-bold"},"archive"),C(" this project?")],-1),Co={__name:"index",setup(Z){const{getSingleSpace:ee,deleteProject:te,editProject:oe}=Q(),{singleSpace:h,singleSpaceProjects:i,isProjectDeleted:de,isProjectEdited:K}=_e(Q()),se=l(W("create_project")),T=l(W("update_project")),J=l(W("delete_project")),R=l(W("archive_edit")),b=l(),H=l(!0),V=fe(),{spaces:D}=Ne().params;if(l(!1),h.value===void 0)throw Te({statusCode:404,message:"Space not found",fatal:!0});const p=l(null),y=_=>{p.value=_,console.log("refCompanyId",p.value),x.value=!0},S=l(!1),d=_=>{if(R.value===!1){V.add({severity:"error",summary:"Error",detail:"You do not have permission to archive project",group:"br",life:3e3});return}else p.value=_,console.log("refCompanyId",p.value),S.value=!0},x=l(!1),E=l(!1),U=async()=>{E.value=!0,console.log("refCompanyIdFin",p.value),await te(p.value,D),de.value===!0?(V.add({severity:"success",summary:"Successful",detail:"Project deleted successfully",group:"br",life:3e3}),x.value=!1,console.log("space deleted"),p.value=null,E.value=!1):(V.add({severity:"error",summary:"Error",detail:"Unable to delete project",group:"br",life:3e3}),console.log("space not deleted"),p.value=null,E.value=!1)},k=l(!1),I=async()=>{k.value=!0,console.log("refCompanyIdFin",p.value);let _=1;const c={id:p.value,space_id:D,is_archive:_};await oe(c),K.value===!0?(V.add({severity:"success",summary:"Successful",detail:"Project archived successfully",group:"br",life:3e3}),console.log("space deleted"),p.value=null,k.value=!1,S.value=!1):(V.add({severity:"error",summary:"Error",detail:"Unable to archive project",group:"br",life:3e3}),console.log("space not deleted"),p.value=null,k.value=!1)};ge(()=>{ee(D),H.value=!1}),(()=>{b.value={global:{value:null,matchMode:De.CONTAINS}}})();const j=l(!1),le=_=>{j.value=!0,p.value=_},ae=_=>{j.value=_},w=l(!0);return(_,c)=>{var q,N;const ie=ye,L=xe,a=be,o=ke,m=me,M=je,v=ve,O=ft,Y=he("tooltip");return f(),$("div",gt,[s(ie,{position:"bottom-right",group:"br"}),t("div",ht,[t("div",yt,[s(L,{to:"/",class:"text pi pi-home responsive-text"}),xt,s(L,{to:"/companies",class:"text"},{default:u(()=>[C("Companies")]),_:1}),bt,s(L,{class:"text responsive-text",to:`/companies/${(q=e(h))==null?void 0:q.company_id}`},{default:u(()=>{var n;return[C(" Company - "+X((n=e(h))==null?void 0:n.company_name),1)]}),_:1},8,["to"]),kt,t("p",jt,"Space - "+X((N=e(h))==null?void 0:N.name),1)]),t("div",wt,[e(se)?F((f(),G(a,{key:0,singleSpace:e(h),spaces:e(D),isPage:e(w)},null,8,["singleSpace","spaces","isPage"])),[[Y,{value:"Create Project"},void 0,{left:!0}]]):P("",!0)])]),t("div",St,[s(M,{iconPosition:"right"},{default:u(()=>[s(o,null,{default:u(()=>[Pt]),_:1}),s(m,{modelValue:e(b).global.value,"onUpdate:modelValue":c[0]||(c[0]=n=>e(b).global.value=n),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),s(e(Ue),{filters:e(b),"onUpdate:filters":c[1]||(c[1]=n=>g(b)?b.value=n:null),class:"table-dsp",value:e(i),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:10,rowsPerPageOptions:[5,10,20,50],dataKey:"id",filterDisplay:"menu",loading:e(H)},{empty:u(()=>[Ct]),loading:u(()=>[C(" Loading data. Please wait. ")]),default:u(()=>[s(e(z),{field:"index",header:"Serial",sortable:""}),s(e(z),{field:"name",header:"Project Name"},{body:u(n=>[s(L,{style:{color:"inherit"},to:`/companies/${e(h).company_id}/spaces/${e(h).id}/projects/${n.data.id}`},{default:u(()=>[t("p",$t,X(n.data.name),1)]),_:2},1032,["to"])]),_:1}),s(e(z),{field:"space_name",header:"Under the Space of"}),s(e(z),{header:"Action"},{body:u(n=>[e(T)?(f(),G(v,{key:0,icon:"pi pi-pencil",text:"",class:"",severity:"success",rounded:"",onClick:r=>le(n.data)},null,8,["onClick"])):P("",!0),F(s(v,{icon:"pi pi-download",text:"",class:"",severity:"warning",rounded:"",onClick:r=>d(n.data.id)},null,8,["onClick"]),[[Y,{value:"Archive"},void 0,{top:!0}]]),e(J)?(f(),G(v,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"danger",rounded:"",onClick:r=>y(n.data.id)},null,8,["onClick"])):P("",!0),e(T)?P("",!0):(f(),G(v,{key:2,icon:"pi pi-pencil",text:"",class:"",severity:"success",style:{visibility:"hidden"}})),e(J)?P("",!0):(f(),G(v,{key:3,icon:"pi pi-trash",text:"",class:"",severity:"danger",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(ce),{visible:e(x),"onUpdate:visible":c[3]||(c[3]=n=>g(x)?x.value=n:null),header:" ",dismissableMask:"true",style:{width:"25rem"}},{default:u(()=>[Vt,s(v,{label:"No",icon:"pi pi-times",text:"",onClick:c[2]||(c[2]=n=>x.value=!1)}),s(v,{label:"Yes",icon:"pi pi-check",loading:e(E),text:"",onClick:U},null,8,["loading"])]),_:1},8,["visible"]),s(e(ce),{visible:e(S),"onUpdate:visible":c[5]||(c[5]=n=>g(S)?S.value=n:null),header:" ",dismissableMask:"true",style:{width:"25rem"}},{default:u(()=>[Et,s(v,{label:"No",icon:"pi pi-times",text:"",onClick:c[4]||(c[4]=n=>S.value=!1)}),s(v,{label:"Yes",icon:"pi pi-check",loading:e(k),text:"",onClick:I},null,8,["loading"])]),_:1},8,["visible"]),s(e(ce),{visible:e(j),"onUpdate:visible":c[7]||(c[7]=n=>g(j)?j.value=n:null),modal:"",header:"Edit Project",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(O,{refProjectId:e(p),singleSpace:e(h),onCloseEditProject:c[6]||(c[6]=n=>ae(n))},null,8,["refProjectId","singleSpace"])]),_:1},8,["visible"])])}}};export{Co as default};
