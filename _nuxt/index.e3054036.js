import{_ as Fe}from"./nuxt-link.a08cf38a.js";import Re from"./dropdown.esm.07682d7a.js";import Ue from"./calendar.esm.30ebebcc.js";import Ee from"./button.esm.8c1f7487.js";import{a as Ne}from"./CreateCompany.3d148983.js";import{a2 as Be,a3 as N,$ as l,a5 as K,ar as X,b as p,i as e,l as r,w as g,c as h,u as c,e as M,F as Oe,f as ze,a as He,o as i,t as y,s as Ye,k as We,K as qe,a8 as Ge,a9 as Je,ca as Ke,an as Xe}from"./entry.5b48de2c.js";import{u as Qe}from"./fetch.fa55c2bd.js";import{u as Ze}from"./cookie.176eb22b.js";import{u as et}from"./layout.a5b336dd.js";import{a as S}from"./usePermission.cc855e97.js";import{u as Q}from"./auth.3008f3d9.js";import{u as Z}from"./company.73e446f2.js";import{u as ee}from"./workCompany.049c8fd3.js";import te from"./chart.esm.c022dc74.js";import"./baseicon.esm.f47fb25e.js";import"./basecomponent.esm.0814e763.js";import"./index.esm.90145e47.js";import"./index.esm.69aebbe9.js";import"./index.esm.581e9f43.js";import"./index.esm.0b057fe3.js";import"./index.esm.03e51172.js";import"./overlayeventbus.esm.68792cfe.js";import"./portal.esm.9672152d.js";import"./virtualscroller.esm.a2e37262.js";import"./index.esm.acd31b41.js";import"./index.esm.795f82f7.js";import"./index.esm.ca1873b8.js";import"./badge.esm.1ad4ee89.js";import"./inputtext.esm.1cde6a35.js";import"./dialog.esm.1c3209b4.js";const a=D=>(Ge("data-v-7d71c88a"),D=D(),Je(),D),tt={class:"grid"},st={class:"col-12 lg:col-6 xl:col-3"},lt={class:"card mb-0"},ot=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Company",-1)),at={class:"text-900 font-medium text-xl"},nt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-blue-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-microsoft text-blue-500 text-xl"})],-1)),it={class:"col-12 lg:col-6 xl:col-3"},ct={class:"card mb-0"},rt=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Employees",-1)),dt={class:"text-900 font-medium text-xl",style:{visibility:"visible"}},ut=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-purple-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user text-purple-500 text-xl"})],-1)),mt=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Employees"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),pt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-purple-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user text-purple-500 text-xl"})],-1)),vt={class:"col-12 lg:col-6 xl:col-3"},_t={class:"card mb-0"},ft=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Roles",-1)),gt={class:"text-900 font-medium text-xl"},ht=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-red-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user-edit text-red-500 text-xl"})],-1)),yt=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Roles"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),bt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-red-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-user-edit text-red-500 text-xl"})],-1)),xt={class:"col-12 lg:col-6 xl:col-3"},Ct={class:"card mb-0"},wt=a(()=>e("span",{class:"block text-500 font-medium mb-3"},"Tags",-1)),kt={class:"text-900 font-medium text-xl"},St=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-green-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-tags text-green-500 text-xl"})],-1)),Dt=a(()=>e("div",null,[e("span",{class:"block text-500 font-medium mb-3"},"Tags"),e("div",{class:"text-900 font-medium text-xl role-hide"},"0")],-1)),jt=a(()=>e("div",{class:"flex align-items-center justify-content-center bg-green-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[e("i",{class:"pi pi-tags text-green-500 text-xl"})],-1)),Tt={key:0,class:"col-12 xl:col-6"},Pt={class:"card h-full"},$t={class:"flex gap-2 align-items-center flex-wrap",style:{padding:"10px"}},Vt=a(()=>e("h5",{class:"mb-2"},"Tasks",-1)),It={class:"flex gap-2 flex-wrap justify-content-end filter-container"},Lt={class:"mb-2 relative w-full md:w-12rem"},At={class:"task-container"},Mt={key:0,class:"flex justify-content-center align-items-center",style:{height:"22rem"}},Ft=a(()=>e("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2.25rem"}},null,-1)),Rt=[Ft],Ut={key:1},Et=["onClick"],Nt={class:"title-group"},Bt={class:"title line-clamp-1",style:{"font-weight":"600"}},Ot=a(()=>e("div",{style:{"background-color":"#00000040",height:"5px",width:"5px","border-radius":"15px"}},null,-1)),zt={style:{"font-size":"12px"}},Ht={key:2},Yt=a(()=>e("p",{class:"text-black text-lg text-center"},"No Tasks found!",-1)),Wt=[Yt],qt={class:"w-full flex justify-content-center"},Gt={class:"col-12 xl:col-6"},Jt={class:"card h-full"},Kt=a(()=>e("h5",null,"Tasks Statistics",-1)),Xt={class:"w-full flex justify-content-center"},Qt={class:"col-12 h-full"},Zt={class:"card dashChart"},es={class:"flex justify-content-between align-items-center"},ts={class:"flex align-items-center gap-3"},ss=a(()=>e("h5",{class:"mb-0"},"Projects Overview",-1)),ls={class:"flex gap-2"},os={class:"chartWrapper"},as={class:"chartAreaWrapper"},ns={key:1},is={__name:"index",setup(D){ee();const{totalCompanies:B,totalProjects:se}=N(ee()),le=Ke(),{getChartData:oe,getTaskAssignModalData:ae,getRoles:ne,getTagsAssignModalData:ie}=Z(),{chartProjectInfo:ce,inProgressCnt:re,chartClosedTaskInfo:de,totalDashboardProjects:ue,completedTasksChartData:me,inProgressTasksChartData:pe,unAssignedTasksChartData:ve,users:_e,rolesLists:O,tags:z}=N(Z());Q(),N(Q());const fe=l(S("read_user")),ge=l(S("read_role")),he=l(S("read_tags")),ye=l(S("read_task"));l(S("create_company"));const{isDarkTheme:be}=et();l(null);const xe=l({labels:ce,datasets:[{label:"In Progress",data:re,fill:!1,backgroundColor:"#6366f1",borderColor:"#6366f1",tension:.4},{label:"Completed",data:de,fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4}]});K(()=>{H.value=Se(),Y.value=De()});const H=l(),Y=l();let Ce=localStorage.getItem("completedTasksChartData"),we=localStorage.getItem("inProgressTasksChartData"),ke=localStorage.getItem("unAssignedTasksChartData");const Se=()=>{const t=getComputedStyle(document.body);return{labels:["Completed","In Progress","Unassigned"],datasets:[{data:[Ce,we,ke],backgroundColor:[t.getPropertyValue("--cyan-500"),t.getPropertyValue("--orange-500"),t.getPropertyValue("--gray-500")],hoverBackgroundColor:[t.getPropertyValue("--cyan-400"),t.getPropertyValue("--orange-400"),t.getPropertyValue("--gray-400")]}]}},De=()=>({plugins:{legend:{labels:{usePointStyle:!0,color:getComputedStyle(document.documentElement).getPropertyValue("--text-color")}}}}),b=l([]);l([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const F=l(null),j=l(!1),T=l(null),je=()=>{var t;T.value=JSON.parse(localStorage.getItem("userCompany")),console.log("hasUserCompany =>",T.value),T.value===null||((t=T.value)==null?void 0:t.length)==0?j.value=!0:j.value=!1,console.log("visibleCreateCompany =>",j.value)},Te=()=>{F.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},Pe=()=>{F.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}},m=l(),W=l(),q=l(),f=l(),P=l(!1),R=l(!1);X(m,t=>{var s,n;W.value=[{name:"All",id:""},...((n=(s=m.value)==null?void 0:s.statuses)==null?void 0:n.map(d=>({name:d.name,id:d.id})))||[]]});const C=l(),$=l(),V=l(),I=l(),G=l(1);let v=l(1);const x=async()=>{$.value=m.value?m.value.id:"",V.value=C.value?C.value.id:"",I.value=f.value,E?v.value++:v.value=1,G.value=v.value,L.value=0,U($.value,V.value,I.value,G.value),E=!1},$e=t=>{P.value=!0;const s=new Date(t);f.value=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate(),x()},Ve=()=>{P.value=!1,f.value="",I.value="",x()},Ie=()=>{if(m.value||q.value||f.value||v.value>1)m.value="",q.value="",f.value="",$.value="",V.value="",C.value="",P.value=!1,x();else return},Le=async t=>{const s=localStorage.getItem("userCompany");console.log("Task click: ",t),await Xe({path:`/companies/${s}/spaces/${t==null?void 0:t.space_id}/projects/${t==null?void 0:t.project_id}`,query:{task_key:t.id}})},Ae=t=>{const s=t,n=new Date(s),d=n.getFullYear(),A=String(n.getMonth()+1).padStart(2,"0");return`${String(n.getDate()).padStart(2,"0")}-${A}-${d}`},L=l(0),J=l(!1),w=l(!1),Me=async t=>{t==="hide-loader"&&(J.value=!0),w.value=!0,v.value++,await U($.value,V.value,I.value,v.value)},U=async(t="",s="",n="",d=1)=>{var u;J.value||(R.value=!0),console.log("status",s);try{const k=Ze("token"),{data:_,pending:o,error:cs}=await Qe(`${le.public.apiUrl}/tasks/list?due_date=${n}&status=${s}&project_id=${t}&limit=15&page=${d}`,{method:"GET",headers:{Authorization:`Bearer ${k.value}`}},"$PslAyef5YX");_.value&&_.value.data&&((u=_.value.counts)!=null&&u.total_tasks)?(L.value=Math.ceil(_.value.counts.total_tasks/15),b.value=d===1?_.value.data:[...b.value,..._.value.data],w.value=!1):(b.value=[],w.value=!1),console.log("Task list: ",b.value)}catch(k){console.log(k),w.value=!1}finally{R.value=!1}};let E=!1;return window.addEventListener("scroll",()=>{const{scrollTop:t,scrollHeight:s,clientHeight:n}=document.documentElement;t+n>=s-50&&v.value<L&&(E=!0,x())}),U(),K(()=>{ne(),ae(),ie(),oe(),je()}),X(be,t=>{t?Pe():Te()},{immediate:!0}),(t,s)=>{const n=Fe,d=Re,A=Ue,u=Ee,k=Ne,_=He("tooltip");return i(),p("div",tt,[e("div",st,[e("div",lt,[r(n,{to:"/companies",class:"flex justify-content-between mb-3"},{default:g(()=>[e("div",null,[ot,e("div",at,y(c(B)?c(B):"0"),1)]),nt]),_:1})])]),e("div",it,[e("div",ct,[fe.value?(i(),h(n,{key:0,to:"/employees",class:"flex justify-content-between mb-3"},{default:g(()=>[e("div",null,[rt,e("div",dt,y(c(_e).length),1)]),ut]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:g(()=>[mt,pt]),_:1}))])]),e("div",vt,[e("div",_t,[ge.value?(i(),h(n,{key:0,to:"/roles",class:"flex justify-content-between mb-3"},{default:g(()=>[e("div",null,[ft,e("div",gt,y(c(O)?c(O).length:"0"),1)]),ht]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:g(()=>[yt,bt]),_:1}))])]),e("div",xt,[e("div",Ct,[he.value?(i(),h(n,{key:0,to:"/tags",class:"flex justify-content-between mb-3"},{default:g(()=>[e("div",null,[wt,e("div",kt,y(c(z)?c(z).length:"0"),1)]),St]),_:1})):(i(),h(n,{key:1,class:"flex justify-content-between mb-3"},{default:g(()=>[Dt,jt]),_:1}))])]),ye.value?(i(),p("div",Tt,[e("div",Pt,[e("div",$t,[Vt,e("div",It,[r(d,{onChange:s[0]||(s[0]=o=>x()),modelValue:m.value,"onUpdate:modelValue":s[1]||(s[1]=o=>m.value=o),options:c(se),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options"]),r(d,{onChange:s[2]||(s[2]=o=>x()),modelValue:C.value,"onUpdate:modelValue":s[3]||(s[3]=o=>C.value=o),options:W.value,disabled:!m.value,optionLabel:"name",placeholder:"Select Status",class:"w-full md:w-12rem mb-2"},null,8,["modelValue","options","disabled"]),e("div",Lt,[r(A,{onDateSelect:s[4]||(s[4]=o=>$e(o)),modelValue:f.value,"onUpdate:modelValue":s[5]||(s[5]=o=>f.value=o),placeholder:"Select Date",class:"w-full md:w-12rem"},null,8,["modelValue"]),P.value?(i(),p("p",{key:0,onClick:Ve,class:"pi pi-times end-cross absolute cursor-pointer"})):M("",!0)]),r(u,{onClick:Ie,label:"Reset",class:"mb-2",severity:"secondary"})])]),e("div",At,[R.value?(i(),p("div",Mt,Rt)):b.value.length>0?(i(),p("div",Ut,[(i(!0),p(Oe,null,ze(b.value,o=>(i(),p("div",{key:o.id,onClick:()=>Le(o),class:"task-card"},[e("div",Nt,[Ye(e("div",{class:We("status"),style:qe(`background-color: ${o==null?void 0:o.status_color};`)},null,4),[[_,{value:`Status: ${o.status_name}`},void 0,{left:!0}]]),e("p",Bt,y(o==null?void 0:o.name),1),Ot,e("p",null,y(o==null?void 0:o.project_name),1)]),e("div",null,[e("p",zt,"Due: "+y(o.due_date?Ae(o==null?void 0:o.due_date):"Not Set"),1)])],8,Et))),128))])):(i(),p("div",Ht,Wt)),e("div",qt,[c(v)<L.value?(i(),h(u,{key:0,onClick:s[6]||(s[6]=o=>Me("hide-loader")),loading:w.value,label:"Load More",severity:"secondary"},null,8,["loading"])):M("",!0)])])])])):M("",!0),e("div",Gt,[e("div",Jt,[Kt,e("div",Xt,[r(c(te),{type:"pie",data:H.value,options:Y.value,class:"w-full md:w-30rem"},null,8,["data","options"])])])]),e("div",Qt,[e("div",Zt,[e("div",es,[e("div",ts,[ss,r(u,{label:`Total Projects: ${c(ue)}`,severity:"secondary"},null,8,["label"])]),e("div",ls,[r(u,{label:`In Progress: ${c(pe)}`,class:"",severity:"info",outlined:""},null,8,["label"]),r(u,{label:`Unassigned: ${c(ve)}`,severity:"help",outlined:""},null,8,["label"]),r(u,{label:`Completed: ${c(me)}`,severity:"contrast",outlined:""},null,8,["label"])])]),e("div",os,[e("div",as,[r(c(te),{type:"bar",data:xe.value,options:F.value},null,8,["data","options"])])])])]),j.value?(i(),p("div",ns,[r(k)])):M("",!0)])}}},Es=Be(is,[["__scopeId","data-v-7d71c88a"]]);export{Es as default};
