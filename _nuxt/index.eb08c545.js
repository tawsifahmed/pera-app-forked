import me from"./inputtext.esm.5cd40da3.js";import ce from"./inputicon.esm.d7523654.js";import pe from"./password.esm.4c141a5a.js";import fe from"./button.esm.a55c2431.js";import{_ as ve}from"./nuxt-link.d5d115f9.js";import{ao as J,$ as d,a3 as Y,a8 as K,o as m,b as c,l as s,aV as Q,a6 as ge,V as _e,a2 as be,al as he,a4 as ye,i as e,u as G,I as O,q as y,e as g,w as we,t as xe,k as ke,F as Ee,ap as Ve,aq as Se}from"./entry.570ab878.js";import{_ as T}from"./avatar.3c58da0e.js";import{_ as Pe,a as Ce}from"./googleBtn.44534869.js";import{u as Ie}from"./layout.b18253cb.js";import Oe from"./AppConfig.a7c769d2.js";import{s as Te,p as Fe,a as Re,u as j}from"./auth.eab47870.js";import Ue from"./checkbox.esm.1ad534d4.js";import"./radiobutton.esm.b232767f.js";import X from"./toast.esm.ef8cdcd7.js";import{u as $e}from"./fetch.11b9759f.js";import{u as W}from"./cookie.3ed14f9e.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.3c79b49a.js";import"./baseicon.esm.c7f0dea4.js";import"./overlayeventbus.esm.c91907e9.js";import"./portal.esm.1e4af6e4.js";import"./badge.esm.54d3e6c5.js";import"./index.esm.b72e702d.js";import"./inputswitch.esm.5c1885a6.js";import"./selectbutton.esm.90e1b354.js";import"./sidebar.esm.3b81a57d.js";import"./index.esm.c6f3b761.js";import"./index.esm.330f474a.js";import"./index.esm.2547ec1e.js";import"./index.esm.417f68ee.js";const qe=Q('<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="32" height="32" viewBox="0 0 48 48" data-v-e311f8d4><path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z" data-v-e311f8d4></path><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z" data-v-e311f8d4></path><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z" data-v-e311f8d4></path><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z" data-v-e311f8d4></path></svg><span class="" data-v-e311f8d4>Sign in with Google</span>',2),Ne={__name:"GoogleLogin",setup(k){const $=ge();d(null);const w=Y(),E=K(),v=async()=>{var t,_,F;const f=await Te(Re,Fe).then(r=>r._tokenResponse.oauthAccessToken).catch(r=>{console.error("Error signing in with Google:",r.message)});try{const{data:r}=await $e(`${$.public.apiUrl}/verify-google-token`,{method:"GET",headers:{token:f}},"$W9KDbYnWwU");if(r.value){const V=(_=(t=r==null?void 0:r.value)==null?void 0:t.company)==null?void 0:_.id;V&&localStorage.setItem("userCompany",JSON.stringify(V)),w.add({severity:"success",summary:"Authorized",detail:"Login Successful",group:"br",life:3e3});const q=W("token");q.value=r.value.token,setTimeout(()=>{E.push("/")},300);const N=W("rolePermission");N.value=(F=r==null?void 0:r.value)==null?void 0:F.permissions}}catch(r){w.add({severity:"error",summary:"Authorization Failed",detail:"Something went wrong.",group:"br",life:3e3}),console.log(r)}};return(f,t)=>{const _=X;return m(),c("button",{class:"login-with-google-btn",onClick:v},[s(_,{position:"bottom-right",group:"br"}),qe])}}},Me=J(Ne,[["__scopeId","data-v-e311f8d4"]]);const p=k=>(Ve("data-v-9212c410"),k=k(),Se(),k),ze={class:"surface-ground flex align-items-center justify-content-center min-h-screen min-w-screen overflow-hidden"},He={class:"flex flex-column align-items-center justify-content-center"},Be={style:{"border-radius":"56px",padding:"0.3rem",background:"linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 30%)"}},De={key:0,class:"w-full surface-card py-8 px-5 sm:px-8",style:{"border-radius":"53px","padding-top":"28px !important","padding-bottom":"34px !important"}},Le=p(()=>e("div",{class:"text-center mb-5"},[e("img",{src:T,alt:"Image",height:"80",class:"mb-3"}),e("div",{"data-v-d804f83c":"",class:"text-900 text-3xl font-medium mb-3"},"Sign in to continue")],-1)),Ae={class:"field md:w-28rem mb-4"},Ge=p(()=>e("label",{for:"email",class:"block text-900 text-xl font-medium mb-2"},"Work Email",-1)),je={key:0,id:"email-help",class:"error-report red-text red-text"},We={class:"field md:w-28rem mb-4"},Je=p(()=>e("label",{for:"password",class:"block text-900 font-medium text-xl mb-2"},"Password",-1)),Ye={key:0,id:"password-help",class:"error-report red-text"},Ke={class:"flex align-items-center justify-content-between mb-5 gap-5"},Qe={class:"flex align-items-center"},Xe=p(()=>e("label",{for:"rememberme1"},"Remember me",-1)),Ze={class:"w-full mt-4"},es={class:"flex flex-wrap items-center justify-between mt-4"},ss=Q('<div class="flex justify-content-center gap-2 mt-3" data-v-9212c410><a href="https://apps.apple.com/us/app/the-pera/id6505035655" target="_blank" data-v-9212c410><img src="'+Pe+'" height="40" alt="Image" class="" data-v-9212c410></a><a href="https://play.google.com/store/apps/details?id=com.singularity.the.pera.app" target="_blank" data-v-9212c410><img src="'+Ce+'" height="40" alt="Image" class="" data-v-9212c410></a></div>',1),as={key:1,class:"w-full surface-card py-8 px-5 sm:px-8",style:{"border-radius":"53px"}},ts=p(()=>e("div",{class:"text-center mb-5"},[e("img",{src:T,alt:"Image",height:"80",class:"mb-3"}),e("div",{"data-v-d804f83c":"",class:"text-900 text-3xl font-medium mt-1 mb-3"},"Verify Your Email")],-1)),ls={class:"field md:w-28rem mb-4"},rs=p(()=>e("label",{for:"name",class:"block text-900 text-xl font-medium mb-2"},"OTP",-1)),os={key:0,id:"name-help",class:"error-report red-text"},is={class:"flex flex-wrap items-center justify-between mt-4"},ds={key:0},ns={key:1,class:""},us=["disabled"],ms={key:2,class:"w-full surface-card py-8 px-5 sm:px-8",style:{"border-radius":"53px"}},cs=p(()=>e("div",{class:"text-center mb-5"},[e("img",{src:T,alt:"Image",height:"80",class:"mb-3"}),e("div",{"data-v-d804f83c":"",class:"text-900 text-3xl font-medium mt-1 mb-3"},"Reset Password")],-1)),ps={class:"field md:w-28rem mb-4"},fs=p(()=>e("label",{for:"email",class:"block text-900 text-xl font-medium mb-2"},"Email",-1)),vs={key:0,id:"email-help",class:"error-report red-text"},gs={key:3,class:"w-full surface-card py-8 px-5 sm:px-8",style:{"border-radius":"53px"}},_s=p(()=>e("div",{class:"text-center mb-5"},[e("img",{src:T,alt:"Image",height:"80",class:"mb-3"}),e("div",{"data-v-d804f83c":"",class:"text-900 text-3xl font-medium mt-1 mb-3"},"Verify OTP")],-1)),bs={class:"field md:w-28rem mb-4"},hs=p(()=>e("label",{for:"name",class:"block text-900 text-xl font-medium mb-2"},"OTP",-1)),ys={key:0,id:"name-help",class:"error-report red-text"},ws={key:4,class:"w-full surface-card py-8 px-5 sm:px-8",style:{"border-radius":"53px"}},xs=p(()=>e("div",{class:"text-center mb-5"},[e("img",{src:T,alt:"Image",height:"80",class:"mb-3"}),e("div",{"data-v-d804f83c":"",class:"text-900 text-3xl font-medium mb-3"},"Set Your New Password")],-1)),ks={class:"field md:w-28rem mb-5"},Es=p(()=>e("label",{for:"password",class:"block text-900 font-medium text-xl mb-2"},"New Password",-1)),Vs={class:"field md:w-28rem mb-5"},Ss=p(()=>e("label",{for:"confirm-password",class:"block text-900 font-medium text-xl mb-2"},"Confirm Password",-1)),Ps={__name:"index",setup(k){const{layoutConfig:$}=Ie();_e(()=>`/layout/images/${$.darkTheme.value?"logo-white":"logo-dark"}.svg`);const w=d(!0),E=d(!1),v=d(""),f=d({password:"",confirm_password:""}),t=d(!1),_=d(""),{authenticateUser:F,otpVerify:r,resendOtp:V,forgotPassword:q,forgotPasswordOtp:N,passwordReset:Z}=j(),{authenticated:D,checkOTP:ee,resendOtpResponse:se,resendOtpMsg:R,authOtp:ae,resetState:Cs}=be(j()),o=Y(),L=K(),n=d({email:null,password:null,remember:!1}),h=d({email:null,password:null,otp:null}),l=d({emailError:!1,passwordError:!1,otpError:!1}),M=()=>{S.value=30,A.value=!1,z=setInterval(()=>{S.value>0?S.value-=1:(clearInterval(z),A.value=!0)},1e3)},b=d(!1),S=d(),A=d(!1);let z=null;const te=async()=>{console.log(n.value),b.value=!0,n.value.email?l.value.emailError=!1:l.value.emailError=!0,n.value.password?l.value.passwordError=!1:l.value.passwordError=!0,l.value.emailError||l.value.passwordError||(b.value=!0,n.value.remember?localStorage.setItem("credentials",JSON.stringify(n.value)):localStorage.removeItem("credentials"),await F(n.value),ee.value===!0?(w.value=!1,E.value=!0,h.value.email=n.value.email,h.value.password=n.value.password,M(),o.add({severity:"success",summary:"OTP Verification",detail:"Please verify OTP",group:"br",life:3e3})):D.value==!0?(l.value.passwordError=!1,l.value.emailError=!1,o.add({severity:"success",summary:"Authorized",detail:"Login Successful",group:"br",life:3e3}),setTimeout(()=>{L.push("/")},300)):o.add({severity:"error",summary:"Authorization Failed!",detail:"Invalid email or password",group:"br",life:3e3})),b.value=!1},le=async()=>{b.value=!0,h.value.email?l.value.emailError=!1:l.value.emailError=!0,h.value.otp?l.value.otpError=!1:l.value.otpError=!0,l.value.emailError||l.value.otpError||(await r(h.value),D.value==!0?(console.log("authOtpPPP",ae.value),o.add({severity:"success",summary:"Successfully Verified",detail:R,group:"br",life:3e3}),location.reload(),L.push("/login")):o.add({severity:"error",summary:"Verification Failed",detail:R,group:"br",life:3e3})),b.value=!1},P=d(!1),re=async()=>{P.value=!0,await V({email:h.value.email}),se.value===!0?(P.value=!1,o.add({severity:"info",summary:"OTP Resent",detail:R,group:"br",life:3e3}),M()):(P.value=!1,o.add({severity:"error",summary:"Error",detail:R,group:"br",life:3e3}))},x=d(""),oe=()=>{v.value="email",w.value=!1},ie=async()=>{if(t.value=!0,x.value===""){o.add({severity:"error",summary:"Error",detail:"Email required",group:"br",life:3e3}),t.value=!1;return}else{const a=await q(x.value);a.code==200?(v.value=a.message,t.value=!1):(t.value=!1,o.add({severity:"error",summary:"Error",detail:a.message,group:"br",life:3e3}))}},H=d(!1),de=async()=>{if(t.value=!0,_.value===""){H.value=!0,o.add({severity:"error",summary:"Error",detail:"OTP required",group:"br",life:3e3}),t.value=!1;return}const a=await N(x.value,_.value);a.code==200?(H.value=!1,v.value=a.message,t.value=!1,o.add({severity:"success",summary:"Success",detail:a.message,group:"br",life:3e3})):(t.value=!1,o.add({severity:"error",summary:"Error",detail:a.message,group:"br",life:3e3}))},ne=async()=>{if(t.value=!0,f.value.password===""||f.value.confirm_password===""){o.add({severity:"error",summary:"Error",detail:"Password required",group:"br",life:3e3}),t.value=!1;return}else if(f.value.password!==f.value.confirm_password){o.add({severity:"error",summary:"Error",detail:"Passwords do not match",group:"br",life:3e3}),t.value=!1;return}else{const a=await Z(x.value,f);console.log(a),a.code==200?(v.value="",w.value=!0,v.value=a.message,t.value=!1,o.add({severity:"success",summary:"Success",detail:a.message,group:"br",life:3e3})):(t.value=!1,o.add({severity:"error",summary:"Error",detail:a.message,group:"br",life:3e3}))}};return he(()=>E.value,a=>{a?M():clearInterval(z)}),ye(()=>{const a=localStorage.getItem("credentials");console.log("User Data storage: ",a),a&&(n.value=JSON.parse(a))}),(a,i)=>{const U=me,C=ce,B=pe,I=fe,ue=ve;return m(),c(Ee,null,[e("div",ze,[e("div",He,[s(G(X),{position:"bottom-right",group:"br"}),e("div",Be,[w.value?(m(),c("div",De,[Le,e("form",{onSubmit:O(te,["prevent"])},[e("div",Ae,[Ge,s(U,{id:"email",modelValue:n.value.email,"onUpdate:modelValue":i[0]||(i[0]=u=>n.value.email=u),type:"email",placeholder:"Enter your work email",class:"w-full",style:{padding:"1rem"}},null,8,["modelValue"]),l.value.emailError?(m(),c("small",je,[s(C,{class:"pi pi-exclamation-triangle"}),y(" Email required! ")])):g("",!0)]),e("div",We,[Je,s(B,{id:"password",modelValue:n.value.password,"onUpdate:modelValue":i[1]||(i[1]=u=>n.value.password=u),placeholder:"Enter password",feedback:!1,toggleMask:!0,class:"w-full",inputClass:"w-full",inputStyle:{padding:"1rem"}},null,8,["modelValue"]),l.value.passwordError?(m(),c("small",Ye,[s(C,{class:"pi pi-exclamation-triangle"}),y(" Password required! ")])):g("",!0)]),e("div",Ke,[e("div",Qe,[s(G(Ue),{inputId:"rememberme1",modelValue:n.value.remember,"onUpdate:modelValue":i[2]||(i[2]=u=>n.value.remember=u),binary:"",class:"mr-2"},null,8,["modelValue"]),Xe]),e("a",{onClick:oe,class:"font-medium no-underline ml-2 text-right cursor-pointer",style:{color:"var(--primary-color)"}},"Forgot password?")]),s(I,{type:"submit",label:"Sign In",loading:b.value,class:"w-full p-3 text-xl"},null,8,["loading"])],32),e("div",Ze,[s(Me)]),e("div",es,[y(" Don't have an account?  "),s(ue,{to:"/register",class:"forgot_pass md:mb-0"},{default:we(()=>[y(" Click Here.")]),_:1})]),ss])):g("",!0),E.value?(m(),c("div",as,[ts,e("form",{onSubmit:O(le,["prevent"])},[e("div",ls,[rs,s(U,{id:"name",modelValue:h.value.otp,"onUpdate:modelValue":i[3]||(i[3]=u=>h.value.otp=u),type:"text",placeholder:"Enter OTP",class:"w-full",style:{padding:"1rem"}},null,8,["modelValue"]),l.value.otpError?(m(),c("small",os,[s(C,{class:"pi pi-exclamation-triangle"}),y(" OTP required! ")])):g("",!0)]),s(I,{type:"submit",label:"Verify",loading:b.value,class:"w-full p-3 text-xl"},null,8,["loading"])],32),e("div",is,[S.value>0?(m(),c("span",ds,"Resend OTP in "+xe(S.value)+"s",1)):(m(),c("span",ns,[y("Resend OTP?  "),e("button",{onClick:re,class:ke(["forgot_pass md:mb-0 cursor-pointer text-blue-600",P.value?"blink_text":""]),disabled:P.value},"Click Here",10,us)]))])])):g("",!0),v.value=="email"?(m(),c("div",ms,[cs,e("form",{onSubmit:O(ie,["prevent"])},[e("div",ps,[fs,s(U,{id:"email",modelValue:x.value,"onUpdate:modelValue":i[4]||(i[4]=u=>x.value=u),type:"email",required:"",placeholder:"example@gmail.com",class:"w-full",style:{padding:"1rem"}},null,8,["modelValue"]),l.value.emailError?(m(),c("small",vs,[s(C,{class:"pi pi-exclamation-triangle"}),y(" Email required! ")])):g("",!0)]),s(I,{type:"submit",label:"Submit",loading:t.value,class:"w-full p-3 text-xl"},null,8,["loading"])],32)])):g("",!0),v.value=="otp"?(m(),c("div",gs,[_s,e("form",{onSubmit:O(de,["prevent"])},[e("div",bs,[hs,s(U,{id:"name",modelValue:_.value,"onUpdate:modelValue":i[5]||(i[5]=u=>_.value=u),type:"text",placeholder:"Enter OTP",invalid:H.value,class:"w-full",style:{padding:"1rem"}},null,8,["modelValue","invalid"]),l.value.otpError?(m(),c("small",ys,[s(C,{class:"pi pi-exclamation-triangle"}),y(" OTP required! ")])):g("",!0)]),s(I,{type:"submit",label:"Verify",loading:t.value,class:"w-full p-3 text-xl"},null,8,["loading"])],32)])):g("",!0),v.value=="new-password"?(m(),c("div",ws,[xs,e("form",{onSubmit:O(ne,["prevent"])},[e("div",ks,[Es,s(B,{id:"password",modelValue:f.value.password,"onUpdate:modelValue":i[6]||(i[6]=u=>f.value.password=u),placeholder:"Enter password",feedback:!1,toggleMask:!0,class:"w-full",inputClass:"w-full",inputStyle:{padding:"1rem"}},null,8,["modelValue"])]),e("div",Vs,[Ss,s(B,{id:"confirm-password",modelValue:f.value.confirm_password,"onUpdate:modelValue":i[7]||(i[7]=u=>f.value.confirm_password=u),placeholder:"Enter password",feedback:!1,toggleMask:!0,class:"w-full",inputClass:"w-full",inputStyle:{padding:"1rem"}},null,8,["modelValue"])]),s(I,{type:"submit",label:"Submit",loading:t.value,class:"w-full p-3 text-xl"},null,8,["loading"])],32)])):g("",!0)])])]),s(Oe,{simple:""})],64)}}},ra=J(Ps,[["__scopeId","data-v-9212c410"]]);export{ra as default};
