import P from"./dropdown.esm.4fa36b0b.js";import j from"./calendar.esm.b28ea8e1.js";import N from"./button.esm.a55c2431.js";import G from"./toolbar.esm.473997f4.js";import I from"./column.esm.6208f1b7.js";import Y from"./datatable.esm.3837e306.js";import{a2 as A,$ as c,a3 as M,b as y,u as d,l as o,w as b,e as C,i as a,F as z,o as D,a5 as $,a6 as L}from"./entry.570ab878.js";import{u as T}from"./fetch.11b9759f.js";import{u as V}from"./cookie.3ed14f9e.js";import{a as O}from"./usePermission.23a55d5e.js";import{u as W}from"./workCompany.886927d5.js";import"./baseicon.esm.c7f0dea4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./index.esm.d468d720.js";import"./index.esm.2cce7489.js";import"./index.esm.b72e702d.js";import"./index.esm.c6f3b761.js";import"./overlayeventbus.esm.c91907e9.js";import"./portal.esm.1e4af6e4.js";import"./virtualscroller.esm.84c3372a.js";import"./index.esm.7c91399e.js";import"./index.esm.b806f7cb.js";import"./index.esm.e138fc7f.js";import"./badge.esm.54d3e6c5.js";import"./paginator.esm.23dce669.js";import"./index.esm.c592065e.js";import"./inputnumber.esm.9d737ca0.js";import"./index.esm.bb3da758.js";import"./index.esm.e450f24c.js";import"./inputtext.esm.5cd40da3.js";import"./index.esm.f3846021.js";import"./index.esm.feb1baca.js";import"./checkbox.esm.1ad534d4.js";import"./radiobutton.esm.b232767f.js";import"./index.esm.a8b59750.js";import"./index.esm.ecdc2543.js";const q={key:0,class:"card"},H=a("div",{class:"d-flex mr-2"},[a("h5",{class:"mb-1"},"User's Task Summary")],-1),J={class:"flex gap-2"},K={class:"flex-auto"},Q=a("label",{for:"icondisplay",class:"font-bold block mb-2"},"Project: ",-1),X={class:"flex-auto"},Z=a("label",{for:"icondisplay",class:"font-bold block mb-2"},"Start Date: ",-1),ee={class:"flex-auto"},te=a("label",{for:"icondisplay",class:"font-bold block mb-2"},"End Date: ",-1),oe={key:1,class:"card"},ae={class:"flex align-items-center justify-content-between gap-2 mb-5"},le=a("h5",{class:"m-0"},"Preview",-1),se=a("p",{class:"text-center"},"No Data found...",-1),Oe={__name:"index",setup(ne){const{companyList:re,totalProjects:x}=A(W()),F=c(O("read_task")),w=L(),g=M(),l=c(""),s=c(""),v=c(!1),f=c(!1),_=c(null),n=c(""),h=i=>{const e=i,t=new Date(e),u=t.getFullYear(),m=String(t.getMonth()+1).padStart(2,"0"),k=String(t.getDate()).padStart(2,"0");return`${u}-${m}-${k}`},B=async()=>{if(l.value==""||s.value=="")return g.add({severity:"warn",summary:"Warning",detail:"Please Select Start Date and End Date",group:"br",life:3e3});const i=V("token");v.value=!0,h(l.value),h(s.value);const{data:e,error:t}=await T(`${w.public.apiUrl}/tasks/report-view?start_date=${l.value}&end_date=${s.value}&project_id=${n.value.id?n.value.id:""}`,{method:"GET",headers:{Authorization:`Bearer ${i.value}`}},"$7Y62SUoCiS");return e.value.code==200?(_.value=e.value.data,console.log("Report Value",e.value.data),v.value=!1):(v.value=!1,g.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},R=async()=>{const i=V("token");f.value=!0,h(l.value),h(s.value);const{data:e,error:t}=await T(`${w.public.apiUrl}/tasks/report-download?start_date=${l.value}&end_date=${s.value}${n!=null&&n.value.id?`&project_id=${n.value.id}`:""}`,{method:"GET",headers:{Authorization:`Bearer ${i.value}`}},"$BBxrS9PTT8");if(e.value.code==200){const u=document.createElement("a");u.href=e.value.download_path,u.target="_blank",u.click(),f.value=!1;return}else return f.value=!1,g.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},S=(i,e)=>{const t=new Date(e);i=="startDate"?l.value=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate():s.value=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},U=()=>{l.value="",s.value="",n.value="",_.value=null};return(i,e)=>{const t=P,u=j,m=N,k=G,p=I,E=Y;return D(),y(z,null,[d(F)?(D(),y("div",q,[H,o(k,{class:"border-0 px-0"},{start:b(()=>[a("div",J,[a("div",K,[Q,o(t,{onChange:e[0]||(e[0]=r=>i.filterTasks()),modelValue:d(n),"onUpdate:modelValue":e[1]||(e[1]=r=>$(n)?n.value=r:null),filter:"",options:d(x),optionLabel:"name",placeholder:"Select Project (Optional)"},null,8,["modelValue","options"])]),a("div",X,[Z,o(u,{modelValue:d(l),"onUpdate:modelValue":e[2]||(e[2]=r=>$(l)?l.value=r:null),onDateSelect:e[3]||(e[3]=r=>S("startDate",r)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),a("div",ee,[te,o(u,{modelValue:d(s),"onUpdate:modelValue":e[4]||(e[4]=r=>$(s)?s.value=r:null),onDateSelect:e[5]||(e[5]=r=>S("endtDate",r)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:b(()=>[o(m,{onClick:U,label:"Reset",class:"mr-2"}),o(m,{onClick:B,class:"",label:"Generate",loading:d(v)},null,8,["loading"])]),_:1})])):C("",!0),d(_)?(D(),y("div",oe,[a("div",null,[a("div",ae,[le,o(m,{onClick:R,class:"w-fit",label:"Download",loading:d(f)},null,8,["loading"])]),o(E,{value:d(_),tableStyle:"min-width: 50rem"},{empty:b(()=>[se]),default:b(()=>[o(p,{field:"name",header:"Name"}),o(p,{field:"total_tasks_count",header:"Total Task"}),o(p,{field:"completed_count",header:"Completed"}),o(p,{field:"overdue_count",header:"Over Due"}),o(p,{field:"bounce_count",header:"Bounce"})]),_:1},8,["value"])])])):C("",!0)],64)}}};export{Oe as default};
