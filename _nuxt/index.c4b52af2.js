import Y from"./toast.esm.c29266ca.js";import q from"./multiselect.esm.89669ccb.js";import J from"./calendar.esm.f94a2fbb.js";import K from"./button.esm.3176abd6.js";import Q from"./toolbar.esm.4d8fb4de.js";import X from"./column.esm.9e7e3fa6.js";import Z from"./datatable.esm.7ce57948.js";import ee from"./tabpanel.esm.c77034de.js";import te from"./tabview.esm.798a638f.js";import{a2 as ae,a5 as oe,$ as h,a6 as le,a7 as se,ar as ne,b as G,l as t,w as b,o as T,i as e,u as o,a9 as B,c as R,e as M,a3 as ie,a4 as re,ca as de}from"./entry.cbc4cad8.js";import{u as W}from"./fetch.92bc8ca7.js";import{u as O}from"./cookie.650bfd0d.js";import{u as ce}from"./workCompany.1b7d25f0.js";import"./radiobutton.esm.567e210f.js";import"./portal.esm.d33d469a.js";import"./basecomponent.esm.6fe80a6b.js";import"./index.esm.40366b4d.js";import"./baseicon.esm.abfcf349.js";import"./index.esm.c92528da.js";import"./index.esm.693955ee.js";import"./index.esm.654b8d3d.js";import"./checkbox.esm.3bb6ea33.js";import"./index.esm.3aee824d.js";import"./index.esm.1e659663.js";import"./index.esm.17a7140c.js";import"./overlayeventbus.esm.3bb8389f.js";import"./virtualscroller.esm.09f1d1b9.js";import"./index.esm.825e4b6a.js";import"./index.esm.c9125384.js";import"./index.esm.273ae94a.js";import"./badge.esm.58e1fc0b.js";import"./paginator.esm.849cd2cd.js";import"./index.esm.e2b409df.js";import"./dropdown.esm.78020c76.js";import"./inputnumber.esm.c12d6f45.js";import"./index.esm.3b91898a.js";import"./index.esm.ff143372.js";import"./inputtext.esm.a3cafc3d.js";import"./index.esm.86c4af79.js";import"./index.esm.9c90e4b7.js";import"./index.esm.7485515f.js";import"./index.esm.2ef3fb31.js";const s=C=>(ie("data-v-69989117"),C=C(),re(),C),ue={class:"card"},pe=s(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"Project Reports")],-1)),me={class:"card"},_e=s(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"Task Reports")],-1)),fe={class:"flex gap-2 flex-wrap align-items-center"},ve={class:"user-selection w-full md:w-14rem w-full"},he=s(()=>e("label",{class:"font-bold block mb-2"},"Spaces:",-1)),be={class:"flex justify-content-center"},ge={class:"user-selection w-full md:w-14rem w-full"},ye=s(()=>e("label",{class:"font-bold block mb-2"},"Projects:",-1)),we={class:"flex justify-content-center"},je={class:"flex-auto"},De=s(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),Se={class:"flex-auto"},xe=s(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),ke={key:0,class:"card"},$e={class:"flex align-items-center justify-content-between gap-2 mb-5"},Ie=s(()=>e("h5",{class:"m-0",style:{visibility:"hidden"}},"Overview",-1)),Ne={class:"card"},Te=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Overview")],-1)),Ce=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Pe=s(()=>e("br",null,null,-1)),Ve={class:"card"},Fe=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Project Wise Count")],-1)),Be=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Me=s(()=>e("br",null,null,-1)),Re={class:"card"},Ue=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Sprint")],-1)),Ee=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Ge={__name:"index",setup(C){const{totalProjectsforReport:w,totalSpaces:z}=oe(ce()),U=de(),c=h(""),u=h(""),r=h(),j=h([]),f=h(),S=h(null),x=h(null),k=h(null),D=h(!1),$=h(!1),P=le();se(()=>{(!r.value||r.value.length===0)&&(w.value&&w.value.length>0?j.value=[...w.value]:j.value=[])}),ne(r,_=>{if(_&&_.length>0){const l=_.flatMap(p=>p.projects);j.value=l}else w.value&&w.value.length>0?j.value=[...w.value]:j.value=[]});const V=_=>{const l=_,p=new Date(l),n=p.getFullYear(),i=String(p.getMonth()+1).padStart(2,"0"),d=String(p.getDate()).padStart(2,"0");return`${n}-${i}-${d}`},A=async()=>{var a,g,m,F,v,E;if(c.value&&!u.value||!c.value&&u.value)return D.value=!1,P.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const _=O("token");D.value=!0;const l=V(c.value),p=V(u.value);let n;r.value&&r.value.length>0&&(n=(a=r.value)==null?void 0:a.map(y=>y.id),console.log("Space ID",n));let i;f.value&&f.value.length>0&&(i=(g=f.value)==null?void 0:g.map(y=>y.id),console.log("Project ID",i));const{data:d,error:I}=await W(`${U.public.apiUrl}/project-report/view?space_ids=${n||""}&project_ids=${i||""}&start_date=${c.value?l:""}&end_date=${u.value?p:""}`,{method:"GET",headers:{Authorization:`Bearer ${_.value}`}},"$tkCbN62YMP");return((m=d.value)==null?void 0:m.code)==200?(S.value=(F=d.value.data)==null?void 0:F.overView.map((y,N)=>({...y,index:N+1})),x.value=(v=d.value.data)==null?void 0:v.projectWiseCount.map((y,N)=>({...y,index:N+1})),k.value=(E=d.value.data)==null?void 0:E.sprintTask.map((y,N)=>({...y,index:N+1})),D.value=!1):(D.value=!1,P.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},L=async()=>{var a,g;const _=O("token");if($.value=!0,c.value&&!u.value||!c.value&&u.value)return D.value=!1,P.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const l=V(c.value),p=V(u.value);let n;r.value&&r.value.length>0&&(n=(a=r.value)==null?void 0:a.map(m=>m.id),console.log("Space ID",n));let i;f.value&&f.value.length>0&&(i=(g=f.value)==null?void 0:g.map(m=>m.id),console.log("Project ID",i));const{data:d,error:I}=await W(`${U.public.apiUrl}/project-report/download?space_ids=${n||""}&project_ids=${i||""}&start_date=${c.value?l:""}&end_date=${u.value?p:""}`,{method:"GET",headers:{Authorization:`Bearer ${_.value}`}},"$tccjGN5izh");if(I.value)return console.log(I),$.value=!1;if(d.value.code==200){const m=document.createElement("a");return m.href=d.value.download_path,m.target="_blank",m.click(),$.value=!1}else return $.value=!1,P.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},H=()=>{c.value="",u.value="",r.value=[],f.value=[],S.value=null,x.value=null,k.value=null};return(_,l)=>{const p=Y,n=q,i=J,d=K,I=Q,a=X,g=Z,m=ee,F=te;return T(),G("div",ue,[t(p,{position:"bottom-right",group:"br"}),pe,t(F,{onTabChange:_.onTabChange,class:"mt-3"},{default:b(()=>[t(m,{class:"file-upload",header:"Project Report"},{default:b(()=>[e("div",me,[t(p,{position:"bottom-right",group:"br"}),_e,t(I,{class:"border-0 px-0"},{start:b(()=>[e("div",fe,[e("div",ve,[he,e("div",be,[t(n,{display:"chip",modelValue:o(r),"onUpdate:modelValue":l[0]||(l[0]=v=>B(r)?r.value=v:null),options:o(z),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Spaces",class:"w-full"},null,8,["modelValue","options"])])]),e("div",ge,[ye,e("div",we,[t(n,{display:"chip",modelValue:o(f),"onUpdate:modelValue":l[1]||(l[1]=v=>B(f)?f.value=v:null),options:o(j),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Projects",class:"w-full"},null,8,["modelValue","options"])])]),e("div",je,[De,t(i,{modelValue:o(c),"onUpdate:modelValue":l[2]||(l[2]=v=>B(c)?c.value=v:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),e("div",Se,[xe,t(i,{modelValue:o(u),"onUpdate:modelValue":l[3]||(l[3]=v=>B(u)?u.value=v:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:b(()=>[t(d,{onClick:H,icon:"pi pi-undo",rounded:"",raised:"",class:"mr-2"}),t(d,{onClick:A,class:"",label:"Generate",loading:o(D)},null,8,["loading"])]),_:1})]),o(S)||o(x)||o(k)?(T(),G("div",ke,[e("div",$e,[Ie,t(d,{onClick:L,class:"w-fit",label:"Download",loading:o($)},null,8,["loading"])]),e("div",Ne,[Te,o(S)?(T(),R(g,{key:0,value:o(S),tableStyle:"min-width: 50rem"},{empty:b(()=>[Ce]),default:b(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"total_iteration",header:"Total Number of Iteration"}),t(a,{field:"total_missed_deadline",header:"No. of Missed Deadlines"}),t(a,{field:"missed_deadline_percentage",header:"% of Missed Deadlines"})]),_:1},8,["value"])):M("",!0)]),Pe,e("div",Ve,[Fe,o(x)?(T(),R(g,{key:0,value:o(x),tableStyle:"min-width: 50rem"},{empty:b(()=>[Be]),default:b(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"project_name",header:"Project Name"}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"total_iteration",header:"No. of Iteration"}),t(a,{field:"total_missed_deadline",header:"No.of Missed Deadlines"})]),_:1},8,["value"])):M("",!0)]),Me,e("div",Re,[Ue,o(k)?(T(),R(g,{key:0,value:o(k),tableStyle:"min-width: 50rem"},{empty:b(()=>[Ee]),default:b(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"task_name",style:{width:"40%"},header:"Task Name"}),t(a,{field:"project_name",header:"Project Name"}),t(a,{field:"status",header:"Status"}),t(a,{field:"due_date",header:"Due Date"}),t(a,{field:"end_date",header:"End Date"}),t(a,{field:"duration",header:"Duration"}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"missed_deadline",header:"Missed Deadlines"})]),_:1},8,["value"])):M("",!0)])])):M("",!0)]),_:1})]),_:1},8,["onTabChange"])])}}},Nt=ae(Ge,[["__scopeId","data-v-69989117"]]);export{Nt as default};
