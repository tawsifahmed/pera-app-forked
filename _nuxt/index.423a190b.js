import xe from"./toast.esm.16706d1d.js";import{_ as ye}from"./nuxt-link.ef0b86f5.js";import{_ as be}from"./CreateSpecificProject.a8a9f3b9.js";import ke from"./inputicon.esm.f1ad76e0.js";import pe from"./inputtext.esm.1c917bdc.js";import Se from"./iconfield.esm.90c91864.js";import me from"./button.esm.9c998168.js";import we from"./textarea.esm.c4f0d395.js";import je from"./inputgroupaddon.esm.6af70af4.js";import Pe from"./inputgroup.esm.135d09ab.js";import $e from"./dropdown.esm.fa37588e.js";import{d as Ce}from"./vuedraggable.umd.dcdb2131.js";import{a6 as _e,ad as ve,$ as a,V as le,a7 as ce,ae as fe,af as Ve,a as ge,o as m,b as w,u as e,i as t,q as P,t as J,l as s,ag as f,w as u,s as L,e as b,K as Ne,ah as Ee,a9 as Te,c as I,P as De}from"./entry.12385925.js";import{u as R}from"./company.a2d0ba78.js";import de from"./colorpicker.esm.b7c000d5.js";import"./inputswitch.esm.deea3268.js";import ue from"./dialog.esm.2da5d4af.js";import{a as ae}from"./usePermission.a2439f52.js";import A from"./column.esm.d0dd4893.js";import Ue from"./datatable.esm.00cd79a6.js";import"./portal.esm.7c211f22.js";import"./basecomponent.esm.eff3cf3d.js";import"./index.esm.054fe2dd.js";import"./baseicon.esm.86ce3472.js";import"./index.esm.ef3b2b86.js";import"./index.esm.1b38267c.js";import"./index.esm.e001a8c3.js";import"./fetch.934ce5db.js";import"./cookie.48088fb4.js";import"./workCompany.9c51fb99.js";import"./badge.esm.8ec4b72c.js";import"./index.esm.b334fb33.js";import"./index.esm.a0e9f148.js";import"./index.esm.f713f216.js";import"./overlayeventbus.esm.43aee091.js";import"./virtualscroller.esm.fd9c1abe.js";import"./_commonjsHelpers.87174ba5.js";import"./paginator.esm.6f66b768.js";import"./index.esm.bce58630.js";import"./inputnumber.esm.fbc8edd5.js";import"./index.esm.91d08464.js";import"./index.esm.73ebdbae.js";import"./index.esm.879c66d9.js";import"./index.esm.9d5cefa2.js";import"./index.esm.a355524a.js";import"./checkbox.esm.a1eb3d76.js";import"./radiobutton.esm.8b88f7e6.js";import"./index.esm.62331e7a.js";import"./index.esm.afe178f9.js";const Ie={class:"position-relative d-flex flex-column justify-content-between w-100 modal-container"},Le={key:0},Oe={class:"field"},Me={for:"name"},Be={class:"field flex flex-column"},Fe=t("label",{for:"editProjectName"},[P("Project Name"),t("i",{class:"text-red-400 text-italic"},"*")],-1),qe={class:"field flex flex-column"},Ge=t("label",{for:"name"},"Project Description",-1),Ke={class:"mb-4"},Ae=t("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[P("Setup Task Status"),t("i",{class:"text-red-400 text-italic"},"*")],-1),Je={class:""},Re=t("p",{class:"pi pi-plus cursor-pointer"},null,-1),He={key:0,class:"text-red-600 text-small"},We={class:"row mt-2"},ze={class:"col-12 d-flex flex-column p-0"},Xe=["onMouseenter"],Ye={style:{"margin-right":"-3px"},width:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",class:"cu-status-manager-status-list-item__drag-handler-icon"},Qe=t("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},[t("circle",{cx:"5",cy:"5",r:"1"}),t("circle",{cx:"5",cy:"12",r:"1"}),t("circle",{cx:"5",cy:"19",r:"1"}),t("circle",{cx:"12",cy:"5",r:"1"}),t("circle",{cx:"12",cy:"12",r:"1"}),t("circle",{cx:"12",cy:"19",r:"1"})],-1),Ze=[Qe],et={class:"flex align-items-center",style:{width:"88%"}},tt=["onClick"],ot=t("p",{class:"pi pi-times"},null,-1),st=[ot],lt={class:""},at=t("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[P("Set Task Close Status"),t("i",{class:"text-red-400 text-italic"},"*")],-1),it={class:""},nt={class:"field"},rt={key:0,class:"text-red-600 text-small"},ct={class:"flex w-full gap-2"},dt={class:"field flex flex-column mb-3",style:{width:"49%"}},ut=t("label",{for:"name"},"Gitlab ID ",-1),pt={class:"field flex flex-column mb-3",style:{width:"49%"}},mt=t("label",{for:"name"},"Gitlab Token ",-1),_t={key:0,class:"text-center",style:{color:"red"}},vt={class:"float-right"},ft={__name:"EditProject",props:["refProjectId","singleSpace"],emits:["closeEditProject"],setup(H,{emit:W}){const{editProject:z}=R(),{isProjectEdited:g}=_e(R()),O=ve(),{refProjectId:n,singleSpace:ie}=H,D=W,M=a(!0),h=a(!1),B=a(!0),U=a(!1),j=a(null),k=a(!0),X=le(()=>({animation:250,group:"tasks",disabled:!k.value,ghostClass:"ghost"})),S=le(()=>({backgroundColor:"inherit",boxShadow:"0px 2px 2px inherit",cursor:"grab",margin:"8px 0px"})),$=le(()=>({backgroundColor:"inherit",boxShadow:"0px 4px 4px inherit",cursor:"grab",margin:"8px 0px"})),v=a(""),Y=a(n==null?void 0:n.statuses.map((i,o)=>({...i,serial_no:o+1}))),r=a([]);r.value=JSON.parse(JSON.stringify(Y.value));const C=a("6466f1"),F=a(null),V=a(!1),p=a(n==null?void 0:n.name),d=a(n==null?void 0:n.description),N=a(n==null?void 0:n.git_project_id),y=a(n==null?void 0:n.git_token),Q=()=>{var i;if(v.value?V.value=!1:V.value=!0,((i=v==null?void 0:v.value)==null?void 0:i.length)>0){const o={name:v.value,color_code:`#${C.value}`,is_closed_status:0,serial_no:r.value.length+1};r.value.push(o),v.value=""}else V.value=!0;r.value.length>0&&(F.value=!0)},Z=i=>{var o,l;r.value.splice(i,1),((o=x.value)==null?void 0:o.is_closed_status)===((l=r.value[i])==null?void 0:l.is_closed_status)&&(x.value=null),r.value.length==0&&(F.value=!1)},x=a(null);x.value=r.value.find(i=>i.is_closed_status===1),ce(x,i=>{i&&r.value.forEach(o=>{o.is_closed_status=o.name===i.name?1:0})}),ce(r,i=>{i.forEach((o,l)=>{o.serial_no=l+1})});const ee=i=>i.map(o=>({taskStatusName:o.name,taskStatusColor:o.color_code.startsWith("#")?o.color_code:`#${o.color_code}`,is_closed_status:o.is_closed_status,serial_no:o.serial_no})),_=a(!1),te=async()=>{if(_.value=!0,p.value===null||r.value.length<=0||!x.value)h.value=!0,_.value=!1;else{h.value=!1,r.value.forEach(E=>{const q=["color_code","name","is_closed_status","serial_no"];Object.keys(E).forEach(G=>{q.includes(G)||delete E[G]})});const i=JSON.parse(JSON.stringify(r.value)),o=ee(i);console.log("shallow List",i),console.log("transformedTaskStatusList",o);const l={id:n==null?void 0:n.id,name:p.value,description:d.value,space_id:n==null?void 0:n.space_id,statuses:o,git_project_id:N.value,git_token:y.value};await z(l),g.value===!0?(D("closeEditProject",!1),_.value=!1,O.add({severity:"success",summary:"Project creation",detail:"Project updated successfully!",group:"br",life:3e3})):(_.value=!1,O.add({severity:"error",summary:"Project creation",detail:"Failed to update project!",group:"br",life:3e3}))}},oe=()=>{D("closeEditProject",!1)};return fe(()=>{Y.value=n==null?void 0:n.statuses;const i=document.getElementById("editProjectName");Ve(()=>{i&&i.focus()})}),(i,o)=>{var re;const l=pe,E=we,q=je,G=Pe,he=$e,ne=me,K=ge("tooltip");return m(),w("div",Ie,[e(M)?(m(),w("div",Le,[t("div",Oe,[t("label",Me,[P("Project: "),t("strong",null,J((re=H.refProjectId)==null?void 0:re.name),1)])]),t("div",Be,[Fe,s(l,{id:"editProjectName",modelValue:e(p),"onUpdate:modelValue":o[0]||(o[0]=c=>f(p)?p.value=c:null),required:"true"},null,8,["modelValue"])]),t("div",qe,[Ge,s(E,{id:"description",class:"border-gray-300",modelValue:e(d),"onUpdate:modelValue":o[1]||(o[1]=c=>f(d)?d.value=c:null),rows:"3",cols:"20"},null,8,["modelValue"])]),t("div",Ke,[Ae,t("div",Je,[s(G,null,{default:u(()=>[s(q,null,{default:u(()=>[L(s(e(de),{class:"color-pick",style:{width:"1.5rem"},modelValue:e(C),"onUpdate:modelValue":o[2]||(o[2]=c=>f(C)?C.value=c:null),inputId:"cp-hex",format:"hex"},null,8,["modelValue"]),[[K,{value:"Pick Color"},void 0,{left:!0}]])]),_:1}),L(s(l,{class:"form-control",modelValue:e(v),"onUpdate:modelValue":o[3]||(o[3]=c=>f(v)?v.value=c:null),placeholder:"e.g., TO-DO, DOING"},null,8,["modelValue"]),[[K,{value:"Type Status Name"},void 0,{top:!0}]]),s(q,{onClick:Q,class:"btn btn-outline-secondary cursor-pointer"},{default:u(()=>[Re]),_:1})]),_:1}),e(V)?(m(),w("p",He,"Please type status name!")):b("",!0),t("div",We,[t("div",ze,[s(e(Ce),{modelValue:e(r),"onUpdate:modelValue":o[5]||(o[5]=c=>f(r)?r.value=c:null),options:e(X),disabled:!e(B),class:"list-group","ghost-class":"ghost",move:i.checkMove,onStart:o[6]||(o[6]=c=>U.value=!0),onEnd:o[7]||(o[7]=c=>U.value=!1)},{item:u(({element:c,index:se})=>[(m(),w("div",{class:"flex delete-task justify-content-between",style:Ne(e(j)===se?e($):e(S)),onMouseenter:T=>j.value=se,onMouseleave:o[4]||(o[4]=T=>j.value=null),key:c.id},[(m(),w("svg",Ye,Ze)),t("div",et,[L(s(e(de),{class:"color-pick mr-2 status-colors border-none",modelValue:c.color_code,"onUpdate:modelValue":T=>c.color_code=T,inputId:"cp-hex",format:"hex"},null,8,["modelValue","onUpdate:modelValue"]),[[K,{value:"Change Color"},void 0,{left:!0}]]),L(s(l,{class:"text-uppercase text-muteds w-full",modelValue:c.name,"onUpdate:modelValue":T=>c.name=T,required:"true"},null,8,["modelValue","onUpdate:modelValue"]),[[K,{value:"Change Status Name"},void 0,{right:!0}]])]),t("div",{onClick:T=>Z(se),class:"cursor-pointer cross-icon ms-1 flex justify-content-center align-items-center"},st,8,tt)],44,Xe))]),_:1},8,["modelValue","options","disabled","move"])])])])]),t("div",lt,[at,t("div",it,[t("div",nt,[s(he,{modelValue:e(x),"onUpdate:modelValue":o[8]||(o[8]=c=>f(x)?x.value=c:null),options:e(r),optionLabel:"name",placeholder:"Select Status",class:"w-full"},null,8,["modelValue","options"])]),i.closeStatusError?(m(),w("p",rt,"Please set close status!")):b("",!0)])]),t("div",ct,[t("div",dt,[ut,s(l,{modelValue:e(N),"onUpdate:modelValue":o[9]||(o[9]=c=>f(N)?N.value=c:null),type:"number",required:"true"},null,8,["modelValue"])]),t("div",pt,[mt,s(l,{modelValue:e(y),"onUpdate:modelValue":o[10]||(o[10]=c=>f(y)?y.value=c:null),type:"text",required:"true"},null,8,["modelValue"])])]),e(h)?(m(),w("p",_t,"Please add/fill/check up all the fields")):b("",!0)])):b("",!0),t("div",vt,[s(ne,{label:"Cancel",icon:"pi pi-times",text:"",onClick:oe}),s(ne,{loading:e(_),label:"Save",icon:"pi pi-check",text:"",onClick:te},null,8,["loading"])])])}}};const gt={class:"card"},ht={class:"d-flex create-space-btn-wrapper mb-3"},xt={class:"breadCrumWrap"},yt=t("p",{class:"pi pi-angle-right"},null,-1),bt=t("p",{class:"pi pi-angle-right responsive-text"},null,-1),kt=t("p",{class:"pi pi-angle-right responsive-text"},null,-1),St={class:"text cursor-pointer responsive-text"},wt={class:"create-btn-wrapper"},jt={class:"flex justify-content-end mb-2"},Pt=t("i",{class:"pi pi-search"},null,-1),$t=t("p",{class:"py-2 text-center"},"No Data found...",-1),Ct={class:"cursor-pointer hover:text-primary font-semibold"},Vt=t("p",null,"Are you sure you want to delete?",-1),Po={__name:"index",setup(H){const{getSingleSpace:W,deleteProject:z}=R(),{singleSpace:g,singleSpaceProjects:O,isProjectDeleted:n}=_e(R()),ie=a(ae("create_project")),D=a(ae("update_project")),M=a(ae("delete_project")),h=a(),B=a(!0),U=ve(),{spaces:j}=Ee().params;if(a(!1),g.value===void 0)throw Te({statusCode:404,message:"Space not found",fatal:!0});const k=a(null),X=p=>{k.value=p,console.log("refCompanyId",k.value),S.value=!0},S=a(!1),$=a(!1),v=async()=>{$.value=!0,console.log("refCompanyIdFin",k.value),await z(k.value,j),n.value===!0?(U.add({severity:"success",summary:"Successful",detail:"Project Deleted Successfully",group:"br",life:3e3}),S.value=!1,console.log("space deleted"),$.value=!1):(U.add({severity:"error",summary:"Error",detail:"Unable to delete project",group:"br",life:3e3}),console.log("space not deleted"),$.value=!1)};fe(()=>{W(j),B.value=!1}),(()=>{h.value={global:{value:null,matchMode:De.CONTAINS}}})();const r=a(!1),C=p=>{r.value=!0,k.value=p},F=p=>{r.value=p},V=a(!0);return(p,d)=>{var i,o;const N=xe,y=ye,Q=be,Z=ke,x=pe,ee=Se,_=me,te=ft,oe=ge("tooltip");return m(),w("div",gt,[s(N,{position:"bottom-right",group:"br"}),t("div",ht,[t("div",xt,[s(y,{to:"/",class:"text pi pi-home responsive-text"}),yt,s(y,{to:"/companies",class:"text"},{default:u(()=>[P("Companies")]),_:1}),bt,s(y,{class:"text responsive-text",to:`/companies/${(i=e(g))==null?void 0:i.company_id}`},{default:u(()=>{var l;return[P(" Company - "+J((l=e(g))==null?void 0:l.company_name),1)]}),_:1},8,["to"]),kt,t("p",St,"Space - "+J((o=e(g))==null?void 0:o.name),1)]),t("div",wt,[e(ie)?L((m(),I(Q,{key:0,singleSpace:e(g),spaces:e(j),isPage:e(V)},null,8,["singleSpace","spaces","isPage"])),[[oe,{value:"Create Project"},void 0,{left:!0}]]):b("",!0)])]),t("div",jt,[s(ee,{iconPosition:"right"},{default:u(()=>[s(Z,null,{default:u(()=>[Pt]),_:1}),s(x,{modelValue:e(h).global.value,"onUpdate:modelValue":d[0]||(d[0]=l=>e(h).global.value=l),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),s(e(Ue),{filters:e(h),"onUpdate:filters":d[1]||(d[1]=l=>f(h)?h.value=l:null),class:"table-dsp",value:e(O),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:10,rowsPerPageOptions:[5,10,20,50],dataKey:"id",filterDisplay:"menu",loading:e(B)},{empty:u(()=>[$t]),loading:u(()=>[P(" Loading data. Please wait. ")]),default:u(()=>[s(e(A),{field:"index",header:"Serial",sortable:""}),s(e(A),{field:"name",header:"Project Name"},{body:u(l=>[s(y,{style:{color:"inherit"},to:`/companies/${e(g).company_id}/spaces/${e(g).id}/projects/${l.data.id}`},{default:u(()=>[t("p",Ct,J(l.data.name),1)]),_:2},1032,["to"])]),_:1}),s(e(A),{field:"space_name",header:"Under the Space of"}),s(e(A),{header:"Action"},{body:u(l=>[e(D)?(m(),I(_,{key:0,icon:"pi pi-pencil",text:"",class:"",severity:"success",rounded:"",onClick:E=>C(l.data)},null,8,["onClick"])):b("",!0),e(M)?(m(),I(_,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:E=>X(l.data.id)},null,8,["onClick"])):b("",!0),e(D)?b("",!0):(m(),I(_,{key:2,icon:"pi pi-pencil",text:"",class:"",severity:"success",style:{visibility:"hidden"}})),e(M)?b("",!0):(m(),I(_,{key:3,icon:"pi pi-trash",text:"",class:"",severity:"warning",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(ue),{visible:e(S),"onUpdate:visible":d[3]||(d[3]=l=>f(S)?S.value=l:null),header:" ",dismissableMask:"true",style:{width:"25rem"}},{default:u(()=>[Vt,s(_,{label:"No",icon:"pi pi-times",text:"",onClick:d[2]||(d[2]=l=>S.value=!1)}),s(_,{label:"Yes",icon:"pi pi-check",loading:e($),text:"",onClick:v},null,8,["loading"])]),_:1},8,["visible"]),s(e(ue),{visible:e(r),"onUpdate:visible":d[5]||(d[5]=l=>f(r)?r.value=l:null),modal:"",header:"Edit Project",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(te,{refProjectId:e(k),singleSpace:e(g),onCloseEditProject:d[4]||(d[4]=l=>F(l))},null,8,["refProjectId","singleSpace"])]),_:1},8,["visible"])])}}};export{Po as default};
