import De from"./dropdown.esm.4fa36b0b.js";import Pe from"./calendar.esm.b28ea8e1.js";import Te from"./button.esm.a55c2431.js";import{a as je}from"./CreateCompany.62a05c47.js";import{ao as ke,a2 as U,$ as t,a4 as K,al as B,b as u,i as o,l as i,u as v,F as Ve,f as Ie,c as Le,e as O,a as Fe,o as c,s as X,k as Ae,K as Me,t as R,q as Ne,ap as Ue,aq as Be,a6 as Oe,ah as Re}from"./entry.570ab878.js";import{u as ze}from"./fetch.11b9759f.js";import{u as Ee}from"./cookie.3ed14f9e.js";import{u as He}from"./layout.b18253cb.js";import{a as x}from"./usePermission.23a55d5e.js";import{u as Q}from"./auth.eab47870.js";import{u as Z}from"./company.198e2c6a.js";import{u as ee}from"./workCompany.886927d5.js";import te from"./chart.esm.6f3dde5e.js";import"./baseicon.esm.c7f0dea4.js";import"./basecomponent.esm.c7fbaad5.js";import"./index.esm.330f474a.js";import"./index.esm.d468d720.js";import"./index.esm.2cce7489.js";import"./index.esm.b72e702d.js";import"./index.esm.c6f3b761.js";import"./overlayeventbus.esm.c91907e9.js";import"./portal.esm.1e4af6e4.js";import"./virtualscroller.esm.84c3372a.js";import"./index.esm.7c91399e.js";import"./index.esm.b806f7cb.js";import"./index.esm.e138fc7f.js";import"./badge.esm.54d3e6c5.js";import"./inputtext.esm.5cd40da3.js";import"./dialog.esm.0b6d087d.js";const f=w=>(Ue("data-v-1b700d98"),w=w(),Be(),w),qe={class:"grid"},We={key:0,class:"col-12 xl:col-6"},Ye={class:"card h-full"},Ge={class:"flex gap-2 align-items-center flex-wrap md:flex-nowrap",style:{"padding-bottom":"10px"}},Je=f(()=>o("h5",{class:"mb-2"},"Tasks",-1)),Ke={class:"flex gap-2 flex-wrap justify-content-end filter-container"},Xe={class:"mb-2 relative w-full md:w-16rem"},Qe={class:"task-container"},Ze={key:0,class:"flex justify-content-center align-items-center",style:{height:"22rem"}},et=f(()=>o("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2.25rem"}},null,-1)),tt=[et],lt={key:1},at=["onClick"],ot={class:"title-group"},st={class:"title line-clamp-1",style:{"font-weight":"600"}},nt={class:"flex align-items-center gap-3"},it=f(()=>o("div",{style:{"background-color":"#00000040",height:"5px",width:"5px","border-radius":"15px"}},null,-1)),rt={class:"title-project line-clamp-1"},ct={style:{"font-size":"12px"}},dt={key:2},ut=f(()=>o("p",{class:"text-black text-lg text-center"},"No Tasks found!",-1)),pt=[ut],mt={class:"w-full flex justify-content-center"},vt={class:"col-12 xl:col-6"},_t={class:"card h-full"},ft=f(()=>o("h5",null,"Tasks Statistics",-1)),ht={class:"w-full flex justify-content-center"},gt={class:"col-12 h-full"},yt={class:"card dashChart"},bt={class:"flex justify-content-between align-items-start dash-inf"},Ct={class:"flex align-items-center gap-3 dash-inf-left"},xt=f(()=>o("h5",{class:"mb-0"},"Projects Overview",-1)),wt={class:"flex gap-2 flex-wrap dash-inf-right"},St={class:"chartWrapper"},$t={class:"chartAreaWrapper"},Dt={key:1},Pt={__name:"index",setup(w){ee();const{totalCompanies:Tt,totalProjects:le}=U(ee()),ae=Oe(),{getChartData:oe,getTaskAssignModalData:se,getRoles:ne,getTagsAssignModalData:ie}=Z(),{chartProjectInfo:re,inProgressCnt:ce,chartClosedTaskInfo:de,totalDashboardProjects:ue,completedTasksChartData:z,inProgressTasksChartData:E,unAssignedTasksChartData:H,users:jt,rolesLists:kt,tags:Vt}=U(Z());Q(),U(Q()),t(x("read_user")),t(x("read_role")),t(x("read_tags"));const pe=t(x("read_task"));t(x("create_company"));const{isDarkTheme:me}=He();t(null);const ve=t({labels:re,datasets:[{label:"In Progress",data:ce,fill:!1,backgroundColor:"#6366f1",borderColor:"#6366f1",tension:.4},{label:"Completed",data:de,fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4}]});K(()=>{S.value=fe(),B([z,E,H],([l,a,s])=>{l&&a&&s&&(q.value=_e(l,a,s))},{immediate:!0})});const q=t(),S=t(),_e=(l,a,s)=>(getComputedStyle(document.body),{labels:["Completed","In Progress","Unassigned"],datasets:[{data:[l,a,s],backgroundColor:["#33bd7c","#0ea5e9","#475569"],hoverBackgroundColor:["#1a8251","#0087c3","#2c3644"]}]}),fe=()=>({plugins:{legend:{labels:{usePointStyle:!0,color:getComputedStyle(document.documentElement).getPropertyValue("--text-color")}}}}),h=t([]);t([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const T=t(null),j=t(!1),k=t(null),he=()=>{var l;k.value=JSON.parse(localStorage.getItem("userCompany")),k.value===null||((l=k.value)==null?void 0:l.length)==0?j.value=!0:j.value=!1},ge=()=>{T.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}},S.value={plugins:{legend:{labels:{usePointStyle:!0,color:"#495057"}}}}},ye=()=>{T.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}},S.value={plugins:{legend:{labels:{usePointStyle:!0,color:"#ebedef"}}}}},d=t(),W=t(),Y=t(),r=t(),be=t(!1),Ce=t(!1),V=t(!1);B(d,l=>{var a,s;W.value=[{name:"All",id:""},...((s=(a=d.value)==null?void 0:a.statuses)==null?void 0:s.map(m=>({name:m.name,id:m.id})))||[]]});const g=t(),$=t(),D=t(),I=t(),L=t(),G=t(1);let p=t(1);const y=async()=>{$.value=d.value?d.value.id:"",D.value=g.value?g.value.id:"",I.value=r.value&&r.value[0]?F(r.value[0]):"",L.value=r.value&&r.value[1]?F(r.value[1]):"",M?p.value++:p.value=1,G.value=p.value,P.value=0,A($.value,D.value,I.value,L.value,G.value),M=!1},xe=()=>{y()},we=()=>{if(d.value||Y.value||r.value||p.value>1)d.value="",Y.value="",r.value=[],$.value="",D.value="",g.value="",Ce.value=!1,be.value=!1,y();else return},Se=async l=>{const a=localStorage.getItem("userCompany");console.log("Task click: ",l),await Re({path:`/companies/${a}/spaces/${l==null?void 0:l.space_id}/projects/${l==null?void 0:l.project_id}`,query:{task_key:l.id}})},F=l=>{const a=l,s=new Date(a),m=String(s.getFullYear()).slice(-2),n=String(s.getMonth()+1).padStart(2,"0");return`${String(s.getDate()).padStart(2,"0")}-${n}-${m}`},P=t(0),J=t(!1),b=t(!1),$e=async l=>{l==="hide-loader"&&(J.value=!0),b.value=!0,p.value++,await A($.value,D.value,I.value,L.value,p.value)},A=async(l="",a="",s="",m="",n=1)=>{var C;J.value||(V.value=!0);try{const e=Ee("token"),{data:_,pending:It,error:Lt}=await ze(`${ae.public.apiUrl}/tasks/list?start_due_date=${s}&end_due_date=${m}&status=${a}&project_id=${l}&limit=30&page=${n}`,{method:"GET",headers:{Authorization:`Bearer ${e.value}`}},"$PslAyef5YX");_.value&&_.value.data&&((C=_.value.counts)!=null&&C.total_tasks)?(P.value=Math.ceil(_.value.counts.total_tasks/30),h.value=n===1?_.value.data:[...h.value,..._.value.data],b.value=!1):(h.value=[],b.value=!1)}catch(e){console.log(e),b.value=!1}finally{V.value=!1}};let M=!1;return window.addEventListener("scroll",()=>{const{scrollTop:l,scrollHeight:a,clientHeight:s}=document.documentElement;l+s>=a-50&&p.value<P&&(M=!0,y())}),A(),K(()=>{ne(),se(),ie(),oe(),he()}),B(me,l=>{l?ye():ge()},{immediate:!0}),(l,a)=>{const s=De,m=Pe,n=Te,N=je,C=Fe("tooltip");return c(),u("div",qe,[pe.value?(c(),u("div",We,[o("div",Ye,[o("div",Ge,[Je,o("div",Ke,[i(s,{onChange:a[0]||(a[0]=e=>y()),modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=e=>d.value=e),options:v(le),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Project",class:"w-full md:w-10rem mb-2"},null,8,["modelValue","options"]),i(s,{onChange:a[2]||(a[2]=e=>y()),modelValue:g.value,"onUpdate:modelValue":a[3]||(a[3]=e=>g.value=e),options:W.value,disabled:!d.value,optionLabel:"name",placeholder:"Status",class:"w-full md:w-10rem mb-2"},null,8,["modelValue","options","disabled"]),o("div",Xe,[i(m,{onHide:xe,dateFormat:"dd/mm/yy",manualInput:!1,selectionMode:"range",modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=e=>r.value=e),placeholder:"Filter by Due Dates",class:"w-full text-sm"},null,8,["modelValue"])]),i(n,{onClick:we,label:"Reset",class:"mb-2",severity:"secondary"})])]),o("div",Qe,[V.value?(c(),u("div",Ze,tt)):h.value.length>0?(c(),u("div",lt,[(c(!0),u(Ve,null,Ie(h.value,e=>(c(),u("div",{key:e.id,onClick:()=>Se(e),class:"task-card card"},[o("div",ot,[X(o("div",{class:Ae("status"),style:Me(`background-color: ${e==null?void 0:e.status_color};`)},null,4),[[C,{value:`Status: ${e.status_name}`},void 0,{left:!0}]]),o("p",st,R(e==null?void 0:e.name),1)]),o("div",nt,[it,X((c(),u("p",rt,[Ne(R((e==null?void 0:e.project_name.length)>11?e.project_name.slice(0,11)+"...":e.project_name),1)])),[[C,(e==null?void 0:e.project_name.length)>11?{value:`Project: ${e.project_name}`}:!1,void 0,{left:!0}]]),o("i",ct,"Due: "+R(e.due_date?F(e==null?void 0:e.due_date):"Not Set"),1)])],8,at))),128))])):(c(),u("div",dt,pt)),o("div",mt,[v(p)<P.value?(c(),Le(n,{key:0,onClick:a[5]||(a[5]=e=>$e("hide-loader")),loading:b.value,label:"Load More",severity:"secondary"},null,8,["loading"])):O("",!0)])])])])):O("",!0),o("div",vt,[o("div",_t,[ft,o("div",ht,[i(v(te),{type:"pie",data:q.value,options:S.value,class:"w-full md:w-30rem"},null,8,["data","options"])])])]),o("div",gt,[o("div",yt,[o("div",bt,[o("div",Ct,[xt,i(n,{class:"nwrp",label:`Total Projects: ${v(ue)}`,severity:"secondary"},null,8,["label"])]),o("div",wt,[i(n,{class:"nwrp",label:`In Progress: ${v(E)}`,severity:"info",outlined:""},null,8,["label"]),i(n,{class:"nwrp",label:`Unassigned: ${v(H)}`,severity:"help",outlined:""},null,8,["label"]),i(n,{class:"nwrp",label:`Completed: ${v(z)}`,severity:"contrast",outlined:""},null,8,["label"])])]),o("div",St,[o("div",$t,[i(v(te),{type:"bar",data:ve.value,options:T.value},null,8,["data","options"])])])])]),j.value?(c(),u("div",Dt,[i(N)])):O("",!0)])}}},cl=ke(Pt,[["__scopeId","data-v-1b700d98"]]);export{cl as default};
