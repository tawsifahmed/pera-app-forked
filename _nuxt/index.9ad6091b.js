import M from"./toast.esm.377c0294.js";import R from"./multiselect.esm.f5deb6e5.js";import U from"./calendar.esm.120d7e8e.js";import G from"./button.esm.d3de2cb4.js";import Y from"./toolbar.esm.182a3c50.js";import z from"./column.esm.007d60ae.js";import A from"./datatable.esm.2c5cef05.js";import O from"./tabpanel.esm.5eff300d.js";import W from"./tabview.esm.b23f05f4.js";import{a2 as H,a3 as L,$ as D,a4 as q,b as T,l as e,w as h,o as C,i as l,u as _,a7 as j,e as J,a8 as K,a9 as Q,ca as X}from"./entry.6ba041bf.js";import{u as F}from"./fetch.773b5ca7.js";import{u as V}from"./cookie.3bc34ce6.js";import{u as Z}from"./workCompany.6298b5ea.js";import"./radiobutton.esm.bf509652.js";import"./portal.esm.b296c789.js";import"./basecomponent.esm.19c83d7f.js";import"./index.esm.1c033539.js";import"./baseicon.esm.f6241ef2.js";import"./index.esm.1c985e6c.js";import"./index.esm.1387be6f.js";import"./index.esm.a4c423a9.js";import"./checkbox.esm.e77e2fea.js";import"./index.esm.d782d6f7.js";import"./index.esm.87fd5dea.js";import"./index.esm.96bbbac9.js";import"./overlayeventbus.esm.f1a5c88a.js";import"./virtualscroller.esm.9bf0dc15.js";import"./index.esm.a2d74148.js";import"./index.esm.9b1be29b.js";import"./index.esm.bcabc8fe.js";import"./badge.esm.4bb7f42c.js";import"./paginator.esm.cee69934.js";import"./index.esm.df0f4f18.js";import"./dropdown.esm.301107b0.js";import"./inputnumber.esm.a0ad6bd1.js";import"./index.esm.143a5e72.js";import"./index.esm.7ee4a4bf.js";import"./inputtext.esm.d2ed1013.js";import"./index.esm.03d8c592.js";import"./index.esm.45008443.js";import"./index.esm.fcf04c40.js";import"./index.esm.4591863d.js";const b=y=>(K("data-v-136419df"),y=y(),Q(),y),ee={class:"card"},te=b(()=>l("div",{class:"d-flex mr-2"},[l("h5",{class:"mb-1"},"Project Reports")],-1)),oe={class:"card"},ae=b(()=>l("div",{class:"d-flex mr-2"},[l("h5",{class:"mb-1"},"Task Reports")],-1)),le={class:"flex gap-2 flex-wrap align-items-center"},re={class:"user-selection w-full md:w-14rem w-full"},se=b(()=>l("label",{class:"font-bold block mb-2"},"Project:",-1)),ne={class:"flex justify-content-center"},ie={class:"flex-auto"},de=b(()=>l("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),ce={class:"flex-auto"},ue=b(()=>l("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),pe={key:0,class:"card"},me={class:"flex align-items-center justify-content-between gap-2 mb-5"},fe=b(()=>l("h5",{class:"m-0"},"Preview",-1)),_e=b(()=>l("p",{class:"text-center"},"No Data found...",-1)),ve={__name:"index",setup(y){const{totalProjects:I}=L(Z()),$=X(),s=D(""),n=D(""),c=D(),x=D(null),g=D(!1),w=D(!1),k=q(),S=u=>{const o=u,a=new Date(o),r=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),m=String(a.getDate()).padStart(2,"0");return`${r}-${i}-${m}`},B=async()=>{var f,t;if(s.value&&!n.value||!s.value&&n.value)return g.value=!1,k.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const u=V("token");g.value=!0;const o=S(s.value),a=S(n.value),r=new FormData;if(c.value&&c.value.length>0){const d=(f=c.value)==null?void 0:f.map(v=>v.id);console.log("Project ID",d),r.append("project_id",d)}s.value&&n.value&&(r.append("start_date",o),r.append("end_date",a));const{data:i,error:m}=await F(`${$.public.apiUrl}/projects/report-view`,{method:"GET",headers:{Authorization:`Bearer ${u.value}`},body:r},"$tkCbN62YMP");return((t=i.value)==null?void 0:t.code)==200?(x.value=i.value.data.map((d,v)=>({...d,index:v+1})),g.value=!1):(g.value=!1,k.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},N=async()=>{var f;const u=V("token");if(w.value=!0,s.value&&!n.value||!s.value&&n.value)return g.value=!1,k.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const o=S(s.value),a=S(n.value),r=new FormData;if(c.value&&c.value.length>0){const t=(f=c.value)==null?void 0:f.map(d=>d.id);console.log("Project ID",t),t.length>0&&t.forEach(d=>{r.append("project_id[]",d)})}s.value&&n.value&&(r.append("start_due_date",o),r.append("end_due_date",a));const{data:i,error:m}=await F(`${$.public.apiUrl}/project-wise-task-report-download`,{method:"POST",headers:{Authorization:`Bearer ${u.value}`},body:r},"$tccjGN5izh");if(m.value)return console.log(m),w.value=!1;if(i.value.code==200){const t=document.createElement("a");return t.href=i.value.download_path,t.target="_blank",t.click(),w.value=!1}else return w.value=!1,k.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},P=(u,o)=>{const a=new Date(o);u=="startDate"?s.value=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate():n.value=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()};return(u,o)=>{const a=M,r=R,i=U,m=G,f=Y,t=z,d=A,v=O,E=W;return C(),T("div",ee,[e(a,{position:"bottom-right",group:"br"}),te,e(E,{onTabChange:u.onTabChange,class:"mt-3"},{default:h(()=>[e(v,{class:"file-upload",header:"Project Report"},{default:h(()=>[l("div",oe,[e(a,{position:"bottom-right",group:"br"}),ae,e(f,{class:"border-0 px-0"},{start:h(()=>[l("div",le,[l("div",re,[se,l("div",ne,[e(r,{display:"chip",modelValue:_(c),"onUpdate:modelValue":o[0]||(o[0]=p=>j(c)?c.value=p:null),options:_(I),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Project",class:"w-full"},null,8,["modelValue","options"])])]),l("div",ie,[de,e(i,{modelValue:_(s),"onUpdate:modelValue":o[1]||(o[1]=p=>j(s)?s.value=p:null),onDateSelect:o[2]||(o[2]=p=>P("startDate",p)),clearButton:"true",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),l("div",ce,[ue,e(i,{modelValue:_(n),"onUpdate:modelValue":o[3]||(o[3]=p=>j(n)?n.value=p:null),onDateSelect:o[4]||(o[4]=p=>P("endtDate",p)),clearButton:"",showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:h(()=>[e(m,{onClick:B,class:"w-full",label:"Generate",loading:_(g)},null,8,["loading"])]),_:1})]),_(x)?(C(),T("div",pe,[l("div",null,[l("div",me,[fe,e(m,{onClick:N,class:"w-fit",label:"Download",loading:_(w)},null,8,["loading"])]),e(d,{value:_(x),tableStyle:"min-width: 50rem"},{empty:h(()=>[_e]),default:h(()=>[e(t,{field:"index",header:"Serial",sortable:""}),e(t,{field:"task_name",style:{width:"40%"},header:"Task Name"}),e(t,{field:"project_name",header:"Project Name"}),e(t,{field:"task_status",header:"Status"}),e(t,{field:"task_due_date",header:"Due Date"}),e(t,{field:"task_date_done",header:"Date Done"}),e(t,{field:"duration",header:"Duration"}),e(t,{field:"unit",header:"Unit"}),e(t,{field:"overdue",header:"Missed Deadlines"})]),_:1},8,["value"])])])):J("",!0)]),_:1}),e(v,{header:"Specific Monthly Summary"}),e(v,{header:"Executive Summary"},{default:h(()=>[e(f,{class:"border-0 px-0"})]),_:1})]),_:1},8,["onTabChange"])])}}},rt=H(ve,[["__scopeId","data-v-136419df"]]);export{rt as default};
