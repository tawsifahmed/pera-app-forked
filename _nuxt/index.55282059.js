import le from"./toast.esm.1152c75b.js";import H from"./button.esm.99bebf04.js";import ie from"./inputicon.esm.1de707b0.js";import q from"./inputtext.esm.2b241ceb.js";import ae from"./iconfield.esm.80ede3e3.js";import re from"./toolbar.esm.dbd91443.js";import ne from"./progressspinner.esm.276d520a.js";import Q from"./multiselect.esm.39ef1dd1.js";import{a4 as j,$ as t,a as pe,o as f,b as V,i as o,q as M,s as Y,l,u as e,a6 as D,e as E,ca as K,a2 as ce,a7 as de,a8 as me,a5 as ue,w as u,P as _e,c as O,F as ve,f as fe,t as xe}from"./entry.47cc6144.js";import{u as A,a as W,b as G}from"./cookie.06a761fe.js";import I from"./column.esm.1d502bba.js";import ye from"./datatable.esm.71e5b2e8.js";import{a as z}from"./usePermission.00a9c392.js";import J from"./dialog.esm.9aca4fc6.js";import"./portal.esm.53c3bddd.js";import"./basecomponent.esm.e27d4a57.js";import"./index.esm.66a0c4ce.js";import"./baseicon.esm.909dfacd.js";import"./index.esm.148d8dcb.js";import"./index.esm.0aa8bacc.js";import"./index.esm.008fa3b1.js";import"./badge.esm.da680d61.js";import"./index.esm.b9f99795.js";import"./checkbox.esm.f481597e.js";import"./index.esm.bb985a39.js";import"./index.esm.cbe49632.js";import"./overlayeventbus.esm.cf701e86.js";import"./virtualscroller.esm.e8f4afe5.js";import"./paginator.esm.526d30c0.js";import"./index.esm.edc5f014.js";import"./dropdown.esm.d2b4d977.js";import"./inputnumber.esm.be0a394b.js";import"./index.esm.ad039c55.js";import"./index.esm.22e8262f.js";import"./index.esm.fd0fa327.js";import"./index.esm.db9fb6ed.js";import"./index.esm.5bdb4303.js";import"./radiobutton.esm.0fc3f5a0.js";import"./index.esm.131f5137.js";import"./index.esm.bdae94cc.js";const be={class:"field"},he={for:"company"},$e=o("i",{class:"text-red-400 text-italic"},"*",-1),ge={class:"pi pi-info-circle cursor-pointer ml-1 text-sm instruction-tip"},Te={class:"field permission_selection"},ke=o("i",{class:"text-red-400 text-italic"},"*",-1),we={class:"pi pi-info-circle cursor-pointer ml-1 text-sm instruction-tip"},Re={key:0,style:{color:"red"}},Ce={class:"create-btn-wrapper mb-0"},Se={__name:"CreateRole",props:{param:{type:Object,required:!0}},emits:["closeCreateModal"],setup(y,{emit:L}){const U=K(),b=y,h=j(),i=t(""),_=t(b.param.permissionsList),c=t([]),a=t(!1),x=t(!0),v=L,R=async()=>{var $;if(i.value===""){a.value=!0;return}else if(a.value=!1,!a.value){const p=A("token"),{data:d,pending:g}=await W(`${U.public.apiUrl}/roles/create`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:{name:i.value,permissions:c.value.map(T=>T.id)}},"$lLTkTCcXoV");(($=d.value)==null?void 0:$.code)===201?(i.value=null,x.value=!1,v("closeCreateModal",!1),h.add({severity:"success",summary:"Success",detail:"Role Created successfully!",group:"br",life:3e3})):h.add({severity:"error",summary:"Error",detail:"Role Creation Failed!",group:"br",life:3e3})}};return($,p)=>{const d=q,g=Q,T=H,k=pe("tooltip");return f(),V("div",null,[o("div",be,[o("label",he,[M("Role Name"),$e,M(),Y(o("span",ge,null,512),[[k,{value:"Demo Text Text Demo Text Text Demo Text Text Demo Text Text Demo Text Text."},void 0,{right:!0}]])]),l(d,{modelValue:e(i),"onUpdate:modelValue":p[0]||(p[0]=m=>D(i)?i.value=m:null),class:"w-full",placeholder:"Enter role name"},null,8,["modelValue"])]),o("div",Te,[o("label",null,[M("Permissions"),ke,M(),Y(o("span",we,null,512),[[k,{value:"Demo Text Text Demo Text Text Demo Text Text Demo Text Text Demo Text Text."},void 0,{right:!0}]])]),l(g,{display:"chip",modelValue:e(c),"onUpdate:modelValue":p[1]||(p[1]=m=>D(c)?c.value=m:null),options:e(_),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(a)?(f(),V("p",Re,"Please enter role name")):E("",!0),o("div",Ce,[l(T,{label:"Save",icon:"pi pi-check",text:"",onClick:R})])])}}};const Z=y=>(de("data-v-d5068835"),y=y(),me(),y),Pe={class:"field"},Ve=Z(()=>o("label",{for:"company"},[M("Role Name"),o("i",{class:"text-red-400 text-italic"},"*")],-1)),De={class:"field permission_selection"},Le=Z(()=>o("label",null,[M("Permissions"),o("i",{class:"text-red-400 text-italic"},"*")],-1)),Me={key:0,style:{color:"red"}},Ee={class:"create-btn-wrappe"},Ue={__name:"EditRole",props:{param:{type:Object,required:!0}},emits:["closeEditModal"],setup(y,{emit:L}){const U=K(),b=y,h=j(),i=t(b.param.id),_=t(b.param.name),c=t(b.param.permissionsList),a=t(b.param.slctdPermissions),x=t(!1),v=t(!0),R=L,$=async()=>{var p;if(_.value===""){x.value=!0;return}else if(x.value=!1,!x.value){const d=A("token"),{data:g,pending:T}=await W(`${U.public.apiUrl}/roles/update/${i.value}`,{method:"POST",headers:{Authorization:`Bearer ${d.value}`},body:{name:_.value,permissions:a.value.map(k=>k.id)}},"$AftFLbfnYe");((p=g.value)==null?void 0:p.code)===200?(v.value=!1,R("closeEditModal",!1),h.add({severity:"success",summary:"Success",detail:"Role updated successfully!",group:"br",life:3e3})):h.add({severity:"error",summary:"Error",detail:"Failed to update role!",group:"br",life:3e3})}};return(p,d)=>{const g=q,T=Q,k=H;return f(),V("div",null,[o("div",Pe,[Ve,l(g,{modelValue:e(_),"onUpdate:modelValue":d[0]||(d[0]=m=>D(_)?_.value=m:null),class:"w-full",placeholder:"Edit role name"},null,8,["modelValue"])]),o("div",De,[Le,l(T,{display:"chip",modelValue:e(a),"onUpdate:modelValue":d[1]||(d[1]=m=>D(a)?a.value=m:null),options:e(c),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(x)?(f(),V("p",Me,"Please enter tag name")):E("",!0),o("div",Ee,[l(k,{label:"Update",icon:"pi pi-check",text:"",onClick:$})])])}}},Fe=ce(Ue,[["__scopeId","data-v-d5068835"]]);const Be={key:0,class:"card"},Ne=o("div",{class:"d-flex mr-2"},[o("h5",{class:"mb-1"},"User Role")],-1),Ie=o("i",{class:"pi pi-search"},null,-1),Ae=o("p",{class:"text-center"},"No Data found...",-1),Oe={style:{display:"flex","flex-wrap":"wrap",gap:"5px"}},St={__name:"index",setup(y){const L=K(),U=t(z("read_role")),b=t(z("create_role")),h=t(z("update_role")),i=t(),_=t(!0);j();const c=t(!1),a=t(!1),x=t([]),v=t([]),R=t([]),$=t(""),p=t(""),d=n=>{c.value=!1,m()},g=n=>{a.value=!1,m()},T=()=>{c.value=!0,m()},k=n=>{var s;a.value=!0,$.value=n.id,p.value=n.name,v.value=v.value,R.value=[],((s=n==null?void 0:n.permissions)==null?void 0:s.length)>0&&n.permissions.map(F=>{v.value.map(w=>{F.id===w.id&&R.value.push(w)})})},m=async()=>{var C,S,P;const n=A("token"),{data:s,pending:F,error:w}=await G("roleList",()=>$fetch(`${L.public.apiUrl}/roles/list`,{headers:{Authorization:`Bearer ${n.value}`}}));((S=(C=s.value)==null?void 0:C.data)==null?void 0:S.length)>0&&(x.value=(P=s.value)==null?void 0:P.data.map((B,N)=>({...B,index:N+1})))},ee=async()=>{var C,S,P;const n=A("token"),{data:s,pending:F,error:w}=await G("permissionList",()=>$fetch(`${L.public.apiUrl}/permissions/list`,{headers:{Authorization:`Bearer ${n.value}`}}));((S=(C=s.value)==null?void 0:C.data)==null?void 0:S.length)>0&&(v.value=(P=s.value)==null?void 0:P.data.map((B,N)=>({...B,index:N+1})))},te=()=>{i.value={global:{value:null,matchMode:_e.CONTAINS}}};return ue(()=>{m(),ee(),_.value=!1}),te(),(n,s)=>{const F=le,w=H,C=ie,S=q,P=ae,B=re,N=ne,oe=Se,se=Fe;return e(U)?(f(),V("div",Be,[l(F,{position:"bottom-right",group:"br"}),Ne,l(B,{class:"border-0 px-0"},{start:u(()=>[e(b)?(f(),O(w,{key:0,icon:"pi pi-plus",label:"Create",onClick:T,class:"mr-2",severity:"secondary"})):E("",!0)]),end:u(()=>[l(P,{iconPosition:"right",raised:""},{default:u(()=>[l(C,null,{default:u(()=>[Ie]),_:1}),l(S,{modelValue:e(i).global.value,"onUpdate:modelValue":s[0]||(s[0]=r=>e(i).global.value=r),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),_:1}),l(e(ye),{filters:e(i),"onUpdate:filters":s[1]||(s[1]=r=>D(i)?i.value=r:null),class:"table-stR",value:e(x),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:e(_)},{empty:u(()=>[Ae]),loading:u(()=>[l(N,{style:{width:"50px",height:"50px"}})]),default:u(()=>[l(e(I),{field:"index",header:"Serial",sortable:""}),l(e(I),{style:{"text-wrap":"nowrap"},field:"name",header:"Role Name"}),l(e(I),{field:"permissions",header:"Permission"},{body:u(r=>[o("div",Oe,[(f(!0),V(ve,null,fe(r.data.permissions,X=>(f(),V("div",{class:"border rounded",key:n.permission,style:{border:"1px solid rgba(167, 167, 167, 0.486)","border-radius":"5px",padding:"2px 5px"}},[o("p",null,xe(X.name),1)]))),128))])]),_:1}),l(e(I),{field:"action",header:"Action"},{body:u(r=>[e(h)?(f(),O(w,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:X=>k(r.data)},null,8,["onClick"])):E("",!0),e(h)?E("",!0):(f(),O(w,{key:1,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),l(e(J),{visible:e(c),"onUpdate:visible":s[3]||(s[3]=r=>D(c)?c.value=r:null),modal:"",header:"Create Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[l(oe,{param:{permissionsList:e(v)},onCloseCreateModal:s[2]||(s[2]=r=>d(r))},null,8,["param"])]),_:1},8,["visible"]),l(e(J),{visible:e(a),"onUpdate:visible":s[5]||(s[5]=r=>D(a)?a.value=r:null),modal:"",header:"Edit Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[l(se,{param:{id:e($),name:e(p),permissionsList:e(v),slctdPermissions:e(R)},onCloseEditModal:s[4]||(s[4]=r=>g(r))},null,8,["param"])]),_:1},8,["visible"])])):E("",!0)}}};export{St as default};
