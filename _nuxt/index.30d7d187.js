import Y from"./toast.esm.16706d1d.js";import q from"./multiselect.esm.518951d2.js";import J from"./calendar.esm.0237c2ec.js";import K from"./button.esm.9c998168.js";import Q from"./toolbar.esm.7ff6602b.js";import X from"./column.esm.d0dd4893.js";import Z from"./datatable.esm.00cd79a6.js";import ee from"./tabpanel.esm.42a9e0ce.js";import te from"./tabview.esm.7ea73787.js";import{a2 as ae,a6 as oe,$ as h,ad as le,ae as se,a7 as ne,b as G,l as t,w as b,o as T,i as e,u as o,ag as R,c as M,e as B,a3 as ie,a4 as re,ca as de}from"./entry.12385925.js";import{u as W}from"./fetch.934ce5db.js";import{u as O}from"./cookie.48088fb4.js";import{u as ce}from"./workCompany.9c51fb99.js";import"./radiobutton.esm.8b88f7e6.js";import"./portal.esm.7c211f22.js";import"./basecomponent.esm.eff3cf3d.js";import"./index.esm.054fe2dd.js";import"./baseicon.esm.86ce3472.js";import"./index.esm.ef3b2b86.js";import"./index.esm.1b38267c.js";import"./index.esm.e001a8c3.js";import"./checkbox.esm.a1eb3d76.js";import"./index.esm.a0e9f148.js";import"./index.esm.f713f216.js";import"./index.esm.b334fb33.js";import"./overlayeventbus.esm.43aee091.js";import"./virtualscroller.esm.fd9c1abe.js";import"./index.esm.e36e94d4.js";import"./index.esm.9d5cefa2.js";import"./index.esm.0380718a.js";import"./badge.esm.8ec4b72c.js";import"./paginator.esm.6f66b768.js";import"./index.esm.bce58630.js";import"./dropdown.esm.fa37588e.js";import"./inputnumber.esm.fbc8edd5.js";import"./index.esm.91d08464.js";import"./index.esm.73ebdbae.js";import"./inputtext.esm.1c917bdc.js";import"./index.esm.879c66d9.js";import"./index.esm.a355524a.js";import"./index.esm.62331e7a.js";import"./index.esm.afe178f9.js";const s=C=>(ie("data-v-a81f9c66"),C=C(),re(),C),ue={class:"card"},pe=s(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"Project Reports")],-1)),me={class:"card"},fe=s(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"Task Reports")],-1)),_e={class:"flex gap-2 flex-wrap align-items-center"},ve={class:"user-selection w-full md:w-14rem w-full"},he=s(()=>e("label",{class:"font-bold block mb-2"},"Spaces:",-1)),be={class:"flex justify-content-center"},ge={class:"user-selection w-full md:w-14rem w-full"},ye=s(()=>e("label",{class:"font-bold block mb-2"},"Projects:",-1)),we={class:"flex justify-content-center"},je={class:"flex-auto"},De=s(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),Se={class:"flex-auto"},xe=s(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),ke={key:0,class:"card"},$e={class:"flex align-items-center justify-content-between gap-2 mb-5"},Ie=s(()=>e("h5",{class:"m-0",style:{visibility:"hidden"}},"Overview",-1)),Ne={class:"card"},Te=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Overview")],-1)),Ce=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Pe=s(()=>e("br",null,null,-1)),Ve={class:"card"},Fe=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Project Wise Count")],-1)),Re=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Be=s(()=>e("br",null,null,-1)),Me={class:"card"},Ue=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Sprint")],-1)),Ee=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Ge={__name:"index",setup(C){const{totalProjectsforReport:w,totalSpaces:z}=oe(ce()),U=de(),c=h(""),u=h(""),r=h(),j=h([]),_=h(),S=h(null),x=h(null),k=h(null),D=h(!1),$=h(!1),P=le();se(()=>{(!r.value||r.value.length===0)&&(w.value&&w.value.length>0?j.value=[...w.value]:j.value=[])}),ne(r,f=>{if(f&&f.length>0){const l=f.flatMap(p=>p.projects);j.value=l}else w.value&&w.value.length>0?j.value=[...w.value]:j.value=[]});const V=f=>{const l=f,p=new Date(l),n=p.getFullYear(),i=String(p.getMonth()+1).padStart(2,"0"),d=String(p.getDate()).padStart(2,"0");return`${n}-${i}-${d}`},A=async()=>{var a,g,m,F,v,E;if(c.value&&!u.value||!c.value&&u.value)return D.value=!1,P.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const f=O("token");D.value=!0;const l=V(c.value),p=V(u.value);let n;r.value&&r.value.length>0&&(n=(a=r.value)==null?void 0:a.map(y=>y.id),console.log("Space ID",n));let i;_.value&&_.value.length>0&&(i=(g=_.value)==null?void 0:g.map(y=>y.id),console.log("Project ID",i));const{data:d,error:I}=await W(`${U.public.apiUrl}/project-report/view?space_ids=${n||""}&project_ids=${i||""}&start_date=${c.value?l:""}&end_date=${u.value?p:""}`,{method:"GET",headers:{Authorization:`Bearer ${f.value}`}},"$tkCbN62YMP");return((m=d.value)==null?void 0:m.code)==200?(S.value=(F=d.value.data)==null?void 0:F.overView.map((y,N)=>({...y,index:N+1})),x.value=(v=d.value.data)==null?void 0:v.projectWiseCount.map((y,N)=>({...y,index:N+1})),k.value=(E=d.value.data)==null?void 0:E.sprintTask.map((y,N)=>({...y,index:N+1})),D.value=!1):(D.value=!1,P.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},L=async()=>{var a,g;const f=O("token");if($.value=!0,c.value&&!u.value||!c.value&&u.value)return D.value=!1,P.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const l=V(c.value),p=V(u.value);let n;r.value&&r.value.length>0&&(n=(a=r.value)==null?void 0:a.map(m=>m.id),console.log("Space ID",n));let i;_.value&&_.value.length>0&&(i=(g=_.value)==null?void 0:g.map(m=>m.id),console.log("Project ID",i));const{data:d,error:I}=await W(`${U.public.apiUrl}/project-report/download?space_ids=${n||""}&project_ids=${i||""}&start_date=${c.value?l:""}&end_date=${u.value?p:""}`,{method:"GET",headers:{Authorization:`Bearer ${f.value}`}},"$tccjGN5izh");if(I.value)return console.log(I),$.value=!1;if(d.value.code==200){const m=document.createElement("a");return m.href=d.value.download_path,m.target="_blank",m.click(),$.value=!1}else return $.value=!1,P.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},H=()=>{c.value="",u.value="",r.value=[],_.value=[],S.value=null,x.value=null,k.value=null};return(f,l)=>{const p=Y,n=q,i=J,d=K,I=Q,a=X,g=Z,m=ee,F=te;return T(),G("div",ue,[t(p,{position:"bottom-right",group:"br"}),pe,t(F,{onTabChange:f.onTabChange,class:"mt-3"},{default:b(()=>[t(m,{class:"file-upload",header:"Project Report"},{default:b(()=>[e("div",me,[t(p,{position:"bottom-right",group:"br"}),fe,t(I,{class:"border-0 px-0"},{start:b(()=>[e("div",_e,[e("div",ve,[he,e("div",be,[t(n,{display:"chip",modelValue:o(r),"onUpdate:modelValue":l[0]||(l[0]=v=>R(r)?r.value=v:null),options:o(z),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Spaces",class:"w-full"},null,8,["modelValue","options"])])]),e("div",ge,[ye,e("div",we,[t(n,{display:"chip",modelValue:o(_),"onUpdate:modelValue":l[1]||(l[1]=v=>R(_)?_.value=v:null),options:o(j),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Projects",class:"w-full"},null,8,["modelValue","options"])])]),e("div",je,[De,t(i,{modelValue:o(c),"onUpdate:modelValue":l[2]||(l[2]=v=>R(c)?c.value=v:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),e("div",Se,[xe,t(i,{modelValue:o(u),"onUpdate:modelValue":l[3]||(l[3]=v=>R(u)?u.value=v:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:b(()=>[t(d,{onClick:H,label:"Reset",class:"mr-2"}),t(d,{onClick:A,class:"",label:"Generate",loading:o(D)},null,8,["loading"])]),_:1})]),o(S)||o(x)||o(k)?(T(),G("div",ke,[e("div",$e,[Ie,t(d,{onClick:L,class:"w-fit",label:"Download",loading:o($)},null,8,["loading"])]),e("div",Ne,[Te,o(S)?(T(),M(g,{key:0,value:o(S),tableStyle:"min-width: 50rem"},{empty:b(()=>[Ce]),default:b(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"total_iteration",header:"Total Number of Iteration"}),t(a,{field:"total_missed_deadline",header:"No. of Missed Deadlines"}),t(a,{field:"missed_deadline_percentage",header:"% of Missed Deadlines"})]),_:1},8,["value"])):B("",!0)]),Pe,e("div",Ve,[Fe,o(x)?(T(),M(g,{key:0,value:o(x),tableStyle:"min-width: 50rem"},{empty:b(()=>[Re]),default:b(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"project_name",header:"Project Name"}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"total_iteration",header:"No. of Iteration"}),t(a,{field:"total_missed_deadline",header:"No.of Missed Deadlines"})]),_:1},8,["value"])):B("",!0)]),Be,e("div",Me,[Ue,o(k)?(T(),M(g,{key:0,value:o(k),tableStyle:"min-width: 50rem"},{empty:b(()=>[Ee]),default:b(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"task_name",style:{width:"40%"},header:"Task Name"}),t(a,{field:"project_name",header:"Project Name"}),t(a,{field:"status",header:"Status"}),t(a,{field:"due_date",header:"Due Date"}),t(a,{field:"end_date",header:"End Date"}),t(a,{field:"duration",header:"Duration"}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"missed_deadline",header:"Missed Deadlines"})]),_:1},8,["value"])):B("",!0)])])):B("",!0)]),_:1})]),_:1},8,["onTabChange"])])}}},Nt=ae(Ge,[["__scopeId","data-v-a81f9c66"]]);export{Nt as default};
