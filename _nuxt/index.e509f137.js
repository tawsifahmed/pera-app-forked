import U from"./dropdown.esm.4e9c9472.js";import E from"./calendar.esm.617e2cc2.js";import N from"./button.esm.e846d103.js";import R from"./toolbar.esm.54b5bb07.js";import G from"./column.esm.347a1d2a.js";import I from"./datatable.esm.549750af.js";import{a3 as Y,$ as u,a4 as A,b as y,u as i,l as a,w as h,e as C,i as o,F as M,o as D,a7 as w,ca as z}from"./entry.f1083d62.js";import{u as T}from"./fetch.10fa1737.js";import{u as V}from"./cookie.9dea65c9.js";import{a as L}from"./usePermission.0e59467d.js";import{u as O}from"./workCompany.9fc24a14.js";import"./baseicon.esm.9dc16ba1.js";import"./basecomponent.esm.dd1da9c1.js";import"./index.esm.0a9206fc.js";import"./index.esm.25dde301.js";import"./index.esm.dadcf415.js";import"./index.esm.0cabc4e6.js";import"./index.esm.1c5b7344.js";import"./overlayeventbus.esm.0f70953e.js";import"./portal.esm.a12ffff4.js";import"./virtualscroller.esm.8b3bbffe.js";import"./index.esm.1493f6f1.js";import"./index.esm.18ac01f2.js";import"./index.esm.e1839713.js";import"./badge.esm.06f68ce4.js";import"./paginator.esm.48f6f07f.js";import"./index.esm.59d7ab85.js";import"./inputnumber.esm.bd15fd88.js";import"./index.esm.db20bc22.js";import"./index.esm.262c264f.js";import"./inputtext.esm.2f4ebd3b.js";import"./index.esm.f2124f4a.js";import"./index.esm.26a78852.js";import"./checkbox.esm.f06bbf32.js";import"./radiobutton.esm.6dce7c4d.js";import"./index.esm.8aab8f7c.js";import"./index.esm.d83addac.js";const W={key:0,class:"card"},q=o("div",{class:"d-flex mr-2"},[o("h5",{class:"mb-1"},"User's Task Summary")],-1),H={class:"flex gap-2"},J={class:"flex-auto"},K=o("label",{for:"icondisplay",class:"font-bold block mb-2"},"Project: ",-1),Q={class:"flex-auto"},X=o("label",{for:"icondisplay",class:"font-bold block mb-2"},"Start Date: ",-1),Z={class:"flex-auto"},ee=o("label",{for:"icondisplay",class:"font-bold block mb-2"}," End Date: ",-1),te={key:1,class:"card"},oe={class:"flex align-items-center justify-content-between gap-2 mb-5"},ae=o("h5",{class:"m-0"},"Preview",-1),le=o("p",{class:"text-center"},"No Data found...",-1),Le={__name:"index",setup(se){const{companyList:re,totalProjects:x}=Y(O()),F=u(L("read_task")),$=z(),g=A(),s=u(""),r=u(""),p=u(!1),f=u(!1),b=u(null),c=u(""),v=n=>{const e=n,t=new Date(e),d=t.getFullYear(),_=String(t.getMonth()+1).padStart(2,"0"),k=String(t.getDate()).padStart(2,"0");return`${d}-${_}-${k}`},B=async()=>{if(s.value==""||r.value=="")return g.add({severity:"warn",summary:"Warning",detail:"Please Select Start Date and End Date",group:"br",life:3e3});const n=V("token");p.value=!0,v(s.value),v(r.value);const{data:e,error:t}=await T(`${$.public.apiUrl}/tasks/report-view?start_date=${s.value}&end_date=${r.value}&project_id=${c.value.id?c.value.id:""}`,{method:"GET",headers:{Authorization:`Bearer ${n.value}`}},"$7Y62SUoCiS");return e.value.code==200?(b.value=e.value.data,console.log("Report Value",e.value.data),p.value=!1):(p.value=!1,g.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},P=async()=>{const n=V("token");f.value=!0,v(s.value),v(r.value);const{data:e,error:t}=await T(`${$.public.apiUrl}/tasks/report-download?start_date=${s.value}&end_date=${r.value}&project_id=${c.value.id}`,{method:"GET",headers:{Authorization:`Bearer ${n.value}`}},"$BBxrS9PTT8");if(e.value.code==200){const d=document.createElement("a");d.href=e.value.download_path,d.target="_blank",d.click(),f.value=!1;return}else return f.value=!1,g.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})},S=(n,e)=>{const t=new Date(e);n=="startDate"?s.value=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate():r.value=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()};return(n,e)=>{const t=U,d=E,_=N,k=R,m=G,j=I;return D(),y(M,null,[i(F)?(D(),y("div",W,[q,a(k,{class:"border-0 px-0"},{start:h(()=>[o("div",H,[o("div",J,[K,a(t,{onChange:e[0]||(e[0]=l=>n.filterTasks()),modelValue:i(c),"onUpdate:modelValue":e[1]||(e[1]=l=>w(c)?c.value=l:null),options:i(x),optionLabel:"name",placeholder:"Select Project (Optional)"},null,8,["modelValue","options"])]),o("div",Q,[X,a(d,{modelValue:i(s),"onUpdate:modelValue":e[2]||(e[2]=l=>w(s)?s.value=l:null),onDateSelect:e[3]||(e[3]=l=>S("startDate",l)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),o("div",Z,[ee,a(d,{modelValue:i(r),"onUpdate:modelValue":e[4]||(e[4]=l=>w(r)?r.value=l:null),onDateSelect:e[5]||(e[5]=l=>S("endtDate",l)),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:h(()=>[a(_,{onClick:B,class:"w-full",label:"Generate",loading:i(p)},null,8,["loading"])]),_:1})])):C("",!0),i(b)?(D(),y("div",te,[o("div",null,[o("div",oe,[ae,a(_,{onClick:P,class:"w-fit",label:"Download",loading:i(f)},null,8,["loading"])]),a(j,{value:i(b),tableStyle:"min-width: 50rem"},{empty:h(()=>[le]),default:h(()=>[a(m,{field:"name",header:"Name"}),a(m,{field:"total_tasks_count",header:"Total Task"}),a(m,{field:"completed_count",header:"Completed"}),a(m,{field:"overdue_count",header:"Over Due"}),a(m,{field:"bounce_count",header:"Bounce"})]),_:1},8,["value"])])])):C("",!0)],64)}}};export{Le as default};
