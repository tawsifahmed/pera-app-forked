import fe from"./toast.esm.ce38771d.js";import{_ as ge}from"./nuxt-link.5c98a085.js";import{_ as he}from"./CreateSpecificProject.b9859f9a.js";import xe from"./inputicon.esm.714e5b85.js";import de from"./inputtext.esm.233582dc.js";import ye from"./iconfield.esm.8ed024d0.js";import ue from"./button.esm.c54db15a.js";import be from"./textarea.esm.6822d7a9.js";import ke from"./inputgroupaddon.esm.c43872b5.js";import Se from"./inputgroup.esm.a6e7f3aa.js";import we from"./dropdown.esm.1498a871.js";import{d as je}from"./vuedraggable.umd.6360ec42.js";import{a3 as pe,a4 as me,$ as a,V as oe,ar as ne,a5 as Pe,a6 as $e,a as _e,o as m,b as w,u as e,i as t,q as C,t as q,l as s,a7 as x,w as u,s as B,e as y,K as Ce,aa as Ve,ab as Ee,ac as Ne,c as O,P as Te}from"./entry.e89720bc.js";import{u as G}from"./company.6be7c7b7.js";import re from"./colorpicker.esm.14eb012a.js";import"./inputswitch.esm.11f16f53.js";import ce from"./dialog.esm.7fe8ed85.js";import{a as se}from"./usePermission.a160ee1c.js";import R from"./column.esm.23462c2c.js";import De from"./datatable.esm.6b7235cc.js";import"./portal.esm.a34e9c64.js";import"./basecomponent.esm.91e596c6.js";import"./index.esm.8eab902c.js";import"./baseicon.esm.fe79efc6.js";import"./index.esm.041242c3.js";import"./index.esm.441b8d98.js";import"./index.esm.e703480f.js";import"./cookie.f9cf43a3.js";import"./workCompany.7a687833.js";import"./badge.esm.cf8f221b.js";import"./index.esm.c9862811.js";import"./index.esm.14e1d642.js";import"./index.esm.272ad973.js";import"./overlayeventbus.esm.b72d439b.js";import"./virtualscroller.esm.2f55518a.js";import"./paginator.esm.7495ebe4.js";import"./index.esm.f40e3f95.js";import"./inputnumber.esm.e84393aa.js";import"./index.esm.edc43b09.js";import"./index.esm.50bef698.js";import"./index.esm.d38d4e1f.js";import"./index.esm.11311365.js";import"./index.esm.b0b5ba0a.js";import"./checkbox.esm.d0c3b3d0.js";import"./radiobutton.esm.ea07f46b.js";import"./index.esm.da61ff69.js";import"./index.esm.e73d6386.js";const Ue={class:"position-relative d-flex flex-column justify-content-between w-100 modal-container"},Ie={key:0},Le={class:"field"},Oe={for:"name"},Be={class:"field flex flex-column"},Me=t("label",{for:"editProjectName"},[C("Project Name"),t("i",{class:"text-red-400 text-italic"},"*")],-1),Fe={class:"field flex flex-column"},Ke=t("label",{for:"name"},"Project Description",-1),Ae={class:"mb-4"},Je=t("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[C("Setup Task Status"),t("i",{class:"text-red-400 text-italic"},"*")],-1),Re={class:"container"},qe=t("p",{class:"pi pi-plus cursor-pointer"},null,-1),Ge={key:0,class:"text-red-600 text-small"},He={class:"row mt-2"},We={class:"col-12 d-flex flex-column p-0"},ze=["onMouseenter"],Xe={style:{"margin-right":"-3px"},width:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",class:"cu-status-manager-status-list-item__drag-handler-icon"},Ye=t("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},[t("circle",{cx:"5",cy:"5",r:"1"}),t("circle",{cx:"5",cy:"12",r:"1"}),t("circle",{cx:"5",cy:"19",r:"1"}),t("circle",{cx:"12",cy:"5",r:"1"}),t("circle",{cx:"12",cy:"12",r:"1"}),t("circle",{cx:"12",cy:"19",r:"1"})],-1),Qe=[Ye],Ze={class:"flex align-items-center",style:{width:"88%"}},et=["onClick"],tt=t("p",{class:"pi pi-times"},null,-1),ot=[tt],st={class:"mb-3"},lt=t("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[C("Set Task Close Status"),t("i",{class:"text-red-400 text-italic"},"*")],-1),at={class:"container"},it={class:"field"},nt={key:0,class:"text-red-600 text-small"},rt={key:0,class:"text-center",style:{color:"red"}},ct={class:"float-right"},dt={__name:"EditProject",props:["refProjectId","singleSpace"],emits:["closeEditProject"],setup(H,{emit:W}){const{editProject:z}=G(),{isProjectEdited:f}=pe(G()),M=me(),{refProjectId:r,singleSpace:le}=H,I=W,F=a(!0),g=a(!1),K=a(!0),L=a(!1),j=a(null),b=a(!0),X=oe(()=>({animation:250,group:"tasks",disabled:!b.value,ghostClass:"ghost"})),k=oe(()=>({backgroundColor:"#fff",boxShadow:"0px 2px 2px #e2e2e2",cursor:"grab",margin:"8px 0px"})),V=oe(()=>({backgroundColor:"#f9f9f9",boxShadow:"0px 4px 4px #e2e2e3",cursor:"grab",margin:"8px 0px"})),v=a(""),Y=a(r==null?void 0:r.statuses.map((l,o)=>({...l,serial_no:o+1}))),n=a([]);n.value=JSON.parse(JSON.stringify(Y.value));const E=a("6466f1"),A=a(null),N=a(!1),_=a(r==null?void 0:r.name),d=a(r==null?void 0:r.description),Q=()=>{var l;if(v.value?N.value=!1:N.value=!0,((l=v==null?void 0:v.value)==null?void 0:l.length)>0){const o={name:v.value,color_code:`#${E.value}`,is_closed_status:0,serial_no:n.value.length+1};n.value.push(o),v.value=""}else N.value=!0;n.value.length>0&&(A.value=!0)},T=l=>{var o,p;n.value.splice(l,1),((o=h.value)==null?void 0:o.is_closed_status)===((p=n.value[l])==null?void 0:p.is_closed_status)&&(h.value=null),n.value.length==0&&(A.value=!1)},h=a(null);h.value=n.value.find(l=>l.is_closed_status===1),ne(h,l=>{l&&n.value.forEach(o=>{o.is_closed_status=o.name===l.name?1:0})}),ne(n,l=>{l.forEach((o,p)=>{o.serial_no=p+1})});const Z=l=>l.map(o=>({taskStatusName:o.name,taskStatusColor:o.color_code.startsWith("#")?o.color_code:`#${o.color_code}`,is_closed_status:o.is_closed_status,serial_no:o.serial_no})),P=a(!1),ee=async()=>{if(P.value=!0,_.value===null||n.value.length<=0||!h.value)g.value=!0,P.value=!1;else{g.value=!1,n.value.forEach($=>{const i=["color_code","name","is_closed_status","serial_no"];Object.keys($).forEach(D=>{i.includes(D)||delete $[D]})});const l=JSON.parse(JSON.stringify(n.value)),o=Z(l);console.log("shallow List",l),console.log("transformedTaskStatusList",o);const p={id:r==null?void 0:r.id,name:_.value,description:d.value,space_id:r==null?void 0:r.space_id,statuses:o};await z(p),f.value===!0?(I("closeEditProject",!1),P.value=!1,M.add({severity:"success",summary:"Project creation",detail:"Project updated successfully!",group:"br",life:3e3})):(P.value=!1,M.add({severity:"error",summary:"Project creation",detail:"Failed to update project!",group:"br",life:3e3}))}},S=()=>{I("closeEditProject",!1)};return Pe(()=>{Y.value=r==null?void 0:r.statuses;const l=document.getElementById("editProjectName");$e(()=>{l&&l.focus()})}),(l,o)=>{var ie;const p=de,$=be,i=ke,D=Se,ve=we,ae=ue,J=_e("tooltip");return m(),w("div",Ue,[e(F)?(m(),w("div",Ie,[t("div",Le,[t("label",Oe,[C("Project: "),t("strong",null,q((ie=H.refProjectId)==null?void 0:ie.name),1)])]),t("div",Be,[Me,s(p,{id:"editProjectName",modelValue:e(_),"onUpdate:modelValue":o[0]||(o[0]=c=>x(_)?_.value=c:null),required:"true"},null,8,["modelValue"])]),t("div",Fe,[Ke,s($,{id:"description",class:"border-gray-300",modelValue:e(d),"onUpdate:modelValue":o[1]||(o[1]=c=>x(d)?d.value=c:null),rows:"3",cols:"20"},null,8,["modelValue"])]),t("div",Ae,[Je,t("div",Re,[s(D,null,{default:u(()=>[s(i,null,{default:u(()=>[B(s(e(re),{class:"color-pick",style:{width:"1.5rem"},modelValue:e(E),"onUpdate:modelValue":o[2]||(o[2]=c=>x(E)?E.value=c:null),inputId:"cp-hex",format:"hex"},null,8,["modelValue"]),[[J,{value:"Pick Color"},void 0,{left:!0}]])]),_:1}),B(s(p,{class:"form-control",modelValue:e(v),"onUpdate:modelValue":o[3]||(o[3]=c=>x(v)?v.value=c:null),placeholder:"e.g., TO-DO, DOING"},null,8,["modelValue"]),[[J,{value:"Type Status Name"},void 0,{top:!0}]]),s(i,{onClick:Q,class:"btn btn-outline-secondary cursor-pointer"},{default:u(()=>[qe]),_:1})]),_:1}),e(N)?(m(),w("p",Ge," Please type status name! ")):y("",!0),t("div",He,[t("div",We,[s(e(je),{modelValue:e(n),"onUpdate:modelValue":o[5]||(o[5]=c=>x(n)?n.value=c:null),options:e(X),disabled:!e(K),class:"list-group","ghost-class":"ghost",move:l.checkMove,onStart:o[6]||(o[6]=c=>L.value=!0),onEnd:o[7]||(o[7]=c=>L.value=!1)},{item:u(({element:c,index:te})=>[(m(),w("div",{class:"flex delete-task justify-content-between",style:Ce(e(j)===te?e(V):e(k)),onMouseenter:U=>j.value=te,onMouseleave:o[4]||(o[4]=U=>j.value=null),key:c.id},[(m(),w("svg",Xe,Qe)),t("div",Ze,[B(s(e(re),{class:"color-pick mr-2 status-colors border-none",modelValue:c.color_code,"onUpdate:modelValue":U=>c.color_code=U,inputId:"cp-hex",format:"hex"},null,8,["modelValue","onUpdate:modelValue"]),[[J,{value:"Change Color"},void 0,{left:!0}]]),B(s(p,{class:"text-uppercase text-muteds w-full",modelValue:c.name,"onUpdate:modelValue":U=>c.name=U,required:"true"},null,8,["modelValue","onUpdate:modelValue"]),[[J,{value:"Change Status Name"},void 0,{right:!0}]])]),t("div",{onClick:U=>T(te),class:"cursor-pointer cross-icon ms-1 flex justify-content-center align-items-center"},ot,8,et)],44,ze))]),_:1},8,["modelValue","options","disabled","move"])])])])]),t("div",st,[lt,t("div",at,[t("div",it,[s(ve,{modelValue:e(h),"onUpdate:modelValue":o[8]||(o[8]=c=>x(h)?h.value=c:null),options:e(n),optionLabel:"name",placeholder:"Select Status",class:"w-full"},null,8,["modelValue","options"])]),l.closeStatusError?(m(),w("p",nt," Please set close status! ")):y("",!0)])]),e(g)?(m(),w("p",rt," Please add/fill/check up all the fields")):y("",!0)])):y("",!0),t("div",ct,[s(ae,{label:"Cancel",icon:"pi pi-times",text:"",onClick:S}),s(ae,{loading:e(P),label:"Save",icon:"pi pi-check",text:"",onClick:ee},null,8,["loading"])])])}}};const ut={class:"card"},pt={class:"d-flex create-space-btn-wrapper mb-3"},mt={class:"breadCrumWrap"},_t=t("p",{class:"pi pi-angle-right"},null,-1),vt=t("p",{class:"pi pi-angle-right responsive-text"},null,-1),ft=t("p",{class:"pi pi-angle-right responsive-text"},null,-1),gt={class:"text cursor-pointer responsive-text"},ht={class:"create-btn-wrapper"},xt={class:"flex justify-content-end mb-2"},yt=t("i",{class:"pi pi-search"},null,-1),bt=t("p",{class:"py-2 text-center"},"No Data found...",-1),kt={class:"cursor-pointer proj-name hover:text-primary font-semibold"},St=t("p",null,"Are you sure you want to delete?",-1),ho={__name:"index",setup(H){const{getSingleSpace:W,deleteProject:z}=G(),{singleSpace:f,singleSpaceProjects:M,isProjectDeleted:r}=pe(G()),le=a(se("create_project")),I=a(se("update_project")),F=a(se("delete_project")),g=a(),K=a(!0),L=me(),{spaces:j}=Ve().params;if(a(!1),f.value===void 0)throw Ee({statusCode:404,message:"Space not found",fatal:!0});const b=a(null),X=_=>{b.value=_,console.log("refCompanyId",b.value),k.value=!0},k=a(!1),V=a(!1),v=async()=>{V.value=!0,console.log("refCompanyIdFin",b.value),await z(b.value,j),r.value===!0?(L.add({severity:"success",summary:"Successful",detail:"Space Deleted Successfully",group:"br",life:3e3}),k.value=!1,console.log("space deleted"),V.value=!1):(L.add({severity:"error",summary:"Error",detail:"Unable to delete space",group:"br",life:3e3}),console.log("space not deleted"),V.value=!1)};Ne(()=>{W(j),K.value=!1}),(()=>{g.value={global:{value:null,matchMode:Te.CONTAINS}}})();const n=a(!1),E=_=>{n.value=!0,b.value=_},A=_=>{n.value=_},N=a(!0);return(_,d)=>{var p,$;const Q=fe,T=ge,h=he,Z=xe,P=de,ee=ye,S=ue,l=dt,o=_e("tooltip");return m(),w("div",ut,[s(Q,{position:"bottom-right",group:"br"}),t("div",pt,[t("div",mt,[s(T,{to:"/",class:"text pi pi-home responsive-text"}),_t,s(T,{to:"/companies",class:"text"},{default:u(()=>[C("Companies")]),_:1}),vt,s(T,{class:"text responsive-text",to:`/companies/${(p=e(f))==null?void 0:p.company_id}`},{default:u(()=>{var i;return[C(" Company - "+q((i=e(f))==null?void 0:i.company_name),1)]}),_:1},8,["to"]),ft,t("p",gt,"Space - "+q(($=e(f))==null?void 0:$.name),1)]),t("div",ht,[e(le)?B((m(),O(h,{key:0,singleSpace:e(f),spaces:e(j),isPage:e(N)},null,8,["singleSpace","spaces","isPage"])),[[o,{value:"Create Project"},void 0,{left:!0}]]):y("",!0)])]),t("div",xt,[s(ee,{iconPosition:"right"},{default:u(()=>[s(Z,null,{default:u(()=>[yt]),_:1}),s(P,{modelValue:e(g).global.value,"onUpdate:modelValue":d[0]||(d[0]=i=>e(g).global.value=i),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),s(e(De),{filters:e(g),"onUpdate:filters":d[1]||(d[1]=i=>x(g)?g.value=i:null),class:"table-dsp",value:e(M),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:10,dataKey:"id",filterDisplay:"menu",loading:e(K)},{empty:u(()=>[bt]),loading:u(()=>[C(" Loading data. Please wait. ")]),default:u(()=>[s(e(R),{field:"index",header:"Serial",sortable:""}),s(e(R),{field:"name",header:"Project Name"},{body:u(i=>[s(T,{to:`/companies/${e(f).company_id}/spaces/${e(f).id}/projects/${i.data.id}`},{default:u(()=>[t("p",kt,q(i.data.name),1)]),_:2},1032,["to"])]),_:1}),s(e(R),{field:"space_name",header:"Under the Space of"}),s(e(R),{header:"Action"},{body:u(i=>[e(I)?(m(),O(S,{key:0,icon:"pi pi-pencil",text:"",class:"",severity:"success",rounded:"",onClick:D=>E(i.data)},null,8,["onClick"])):y("",!0),e(F)?(m(),O(S,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:D=>X(i.data.id)},null,8,["onClick"])):y("",!0),e(I)?y("",!0):(m(),O(S,{key:2,icon:"pi pi-pencil",text:"",class:"",severity:"success",style:{visibility:"hidden"}})),e(F)?y("",!0):(m(),O(S,{key:3,icon:"pi pi-trash",text:"",class:"",severity:"warning",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(ce),{visible:e(k),"onUpdate:visible":d[3]||(d[3]=i=>x(k)?k.value=i:null),header:" ",style:{width:"25rem"}},{default:u(()=>[St,s(S,{label:"No",icon:"pi pi-times",text:"",onClick:d[2]||(d[2]=i=>k.value=!1)}),s(S,{label:"Yes",icon:"pi pi-check",loading:e(V),text:"",onClick:v},null,8,["loading"])]),_:1},8,["visible"]),s(e(ce),{visible:e(n),"onUpdate:visible":d[5]||(d[5]=i=>x(n)?n.value=i:null),modal:"",header:"Edit Project",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(l,{refProjectId:e(b),singleSpace:e(f),onCloseEditProject:d[4]||(d[4]=i=>A(i))},null,8,["refProjectId","singleSpace"])]),_:1},8,["visible"])])}}};export{ho as default};
