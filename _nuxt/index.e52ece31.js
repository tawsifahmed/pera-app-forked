import Ie from"./toast.esm.3d8d09e9.js";import le from"./button.esm.4dd3c46c.js";import Se from"./multiselect.esm.69a6d2aa.js";import Ne from"./inputicon.esm.236474d8.js";import te from"./inputtext.esm.ba89d3ee.js";import Pe from"./iconfield.esm.269144df.js";import Te from"./toolbar.esm.2d61f263.js";import Ae from"./progressspinner.esm.50cfa407.js";import{a2 as oe,$ as l,a4 as se,a5 as ae,a6 as pe,o as U,b as Y,i as t,l as s,u as e,a7 as _,e as M,a8 as ie,a9 as ne,q as T,ca as re,c as H,w as S,P as Le,a as Me,s as De,t as Be}from"./entry.e7d8f855.js";import{u as G,a as _e}from"./cookie.c68f5909.js";import{u as de}from"./fetch.6bb0f6b4.js";import X from"./column.esm.21b6fe69.js";import Fe from"./datatable.esm.18ad9dd7.js";import ye from"./textarea.esm.7e717f64.js";import Oe from"./password.esm.395d055b.js";import me from"./dropdown.esm.0fc7b8ad.js";import{a as W}from"./usePermission.e2b284f9.js";import ee from"./dialog.esm.b43638c3.js";import"./portal.esm.2728edee.js";import"./basecomponent.esm.cdf3b797.js";import"./index.esm.87eb8ee0.js";import"./baseicon.esm.e88ffaa5.js";import"./index.esm.278653f5.js";import"./index.esm.cf022044.js";import"./index.esm.6d9e5d17.js";import"./badge.esm.0637ea13.js";import"./index.esm.73cd2e1f.js";import"./checkbox.esm.31799cc8.js";import"./index.esm.380d3aa1.js";import"./index.esm.04396fb2.js";import"./overlayeventbus.esm.0060ac8d.js";import"./virtualscroller.esm.06412756.js";import"./paginator.esm.d94f7134.js";import"./index.esm.7622a950.js";import"./inputnumber.esm.9bcb0b9b.js";import"./index.esm.137a65da.js";import"./index.esm.5231292b.js";import"./index.esm.8b368644.js";import"./index.esm.fc6b3dc4.js";import"./index.esm.7e5a6e84.js";import"./radiobutton.esm.1336f95d.js";import"./index.esm.dd73ee1c.js";import"./index.esm.df498f99.js";import"./index.esm.11d92a32.js";const Z=u=>(ie("data-v-c22831e2"),u=u(),ne(),u),Re={class:"field"},He=Z(()=>t("label",{for:"company"},[T("Name"),t("i",{class:"text-red-400 text-italic"},"*"),T(" >")],-1)),ze={class:"field"},je=Z(()=>t("label",{for:"email"},[T("Email address"),t("i",{class:"text-red-400"},"*")],-1)),qe={class:"field"},Ge=Z(()=>t("label",{for:"phoneNo"},"Phone ",-1)),Ye={class:"field"},Ke=Z(()=>t("label",{for:"company"},"Address ",-1)),Xe={class:"field"},Ze=Z(()=>t("label",{for:"company"},[T("Password"),t("i",{class:"text-red-400"},"*")],-1)),Je={class:"field flex flex-column"},Qe=Z(()=>t("label",null,[T("Role"),t("i",{class:"text-red-400"},"*")],-1)),We={key:0,style:{color:"red"}},el={class:"create-btn-wrapper mb-0"},ll={__name:"CreateEmployee",props:{param:{type:Object,required:!0}},emits:["closeCreateModal"],setup(u,{emit:D}){const z=re(),A=l(u.param.rolesLists),E=l([]),v=se(),d=l(""),c=l(""),y=l(""),w=l(""),p=l("");l("");const h=l(!1),b=l(!0),$=D,r=l(!1),B=async()=>{var m,a,x;if(r.value=!0,d.value===""||c.value===""||p.value===""||E.value.length===0){h.value=!0,r.value=!1;return}else if(h.value=!1,!h.value){const C=G("token"),{data:k,error:f,pending:V}=await de(`${z.public.apiUrl}/users/create`,{method:"POST",headers:{Authorization:`Bearer ${C.value}`},body:{name:d.value,email:c.value,address:w.value,phone:y.value,password:p.value,password_confirmation:p.value,role:E.value.name}},"$HYNtwi2ZAs");if(f!=null&&f.value){if(((a=(m=f==null?void 0:f.value)==null?void 0:m.data)==null?void 0:a.code)===422){r.value=!1,v.add({severity:"error",summary:"Error",detail:"Email already exists!",group:"br",life:3e3});return}}else if(((x=k==null?void 0:k.value)==null?void 0:x.code)===201){r.value=!1,d.value=null,c.value=null,y.value=null,w.value=null,p.value=null,b.value=!1,$("closeCreateModal",!1),v.add({severity:"success",summary:"Success",detail:"Employee created successfully!",group:"br",life:3e3});return}else{r.value=!1,v.add({severity:"error",summary:"Error",detail:"Failed to create employee!",group:"br",life:3e3});return}}};return ae(()=>{const m=document.getElementById("createEmployeeName");pe(()=>{m&&m.focus()})}),(m,a)=>{const x=te,C=ye,k=Oe,f=me,V=le;return U(),Y("div",null,[t("div",Re,[He,s(x,{id:"createEmployeeName",modelValue:e(d),"onUpdate:modelValue":a[0]||(a[0]=I=>_(d)?d.value=I:null),class:"w-full",placeholder:"Enter Name"},null,8,["modelValue"])]),t("div",ze,[je,s(x,{type:"email",modelValue:e(c),"onUpdate:modelValue":a[1]||(a[1]=I=>_(c)?c.value=I:null),class:"w-full",placeholder:"Enter Email"},null,8,["modelValue"])]),t("div",qe,[Ge,s(x,{modelValue:e(y),"onUpdate:modelValue":a[2]||(a[2]=I=>_(y)?y.value=I:null),inputId:"worktype",type:"tel",class:"w-full",maxlength:"14",placeholder:"Enter Phone No."},null,8,["modelValue"])]),t("div",Ye,[Ke,s(C,{modelValue:e(w),"onUpdate:modelValue":a[3]||(a[3]=I=>_(w)?w.value=I:null),rows:"3",cols:"20",class:"w-full",placeholder:"Enter Address"},null,8,["modelValue"])]),t("div",Xe,[Ze,s(k,{modelValue:e(p),"onUpdate:modelValue":a[4]||(a[4]=I=>_(p)?p.value=I:null),placeholder:"Enter password",feedback:!1,invalid:m.confirmPassError,toggleMask:"",class:"w-full",inputClass:"w-full"},null,8,["modelValue","invalid"])]),t("div",Je,[Qe,s(f,{modelValue:e(E),"onUpdate:modelValue":a[5]||(a[5]=I=>_(E)?E.value=I:null),options:e(A),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Role",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e(h)?(U(),Y("p",We,"Please fill/check up all the fields")):M("",!0),t("div",el,[s(V,{loading:e(r),label:"Save",icon:"pi pi-check",text:"",onClick:B},null,8,["loading"])])])}}},tl=oe(ll,[["__scopeId","data-v-c22831e2"]]);const Q=u=>(ie("data-v-a1134ad4"),u=u(),ne(),u),ol={class:"field"},sl=Q(()=>t("label",{for:"company"},[T("Name"),t("i",{class:"text-red-500"},"*")],-1)),al={class:"field"},il=Q(()=>t("label",{for:"email"},[T("Email address"),t("i",{class:"text-red-500"},"*")],-1)),nl={class:"field"},rl=Q(()=>t("label",{for:"worktype"},"Phone",-1)),dl={class:"field"},ul=Q(()=>t("label",{for:"company"},"Address",-1)),cl={class:"field flex flex-column"},pl=Q(()=>t("label",null,[T("Role"),t("i",{class:"text-red-500"},"*")],-1)),ml={key:0,style:{color:"red"}},vl={class:"create-btn-wrappe"},fl={__name:"EditEmployee",props:{param:{type:Object,required:!0}},emits:["closeEditModal"],setup(u,{emit:D}){const z=re(),N=u,A=se(),E=l(N.param.id),v=l(N.param.name),d=l(N.param.email),c=l(N.param.phone),y=l(N.param.address),w=l(N.param.rolesLists),p=l(N.param.user_type),h=l(!1),b=l(!0),$=D,r=l(!1),B=async()=>{var m,a,x;if(r.value=!0,v.value===""||d.value===""){h.value=!0,r.value=!1;return}else if(h.value=!1,!h.value){const C=G("token"),{data:k,error:f,pending:V}=await de(`${z.public.apiUrl}/users/update/${E.value}`,{method:"POST",headers:{Authorization:`Bearer ${C.value}`},body:{name:v.value,email:d.value,address:y.value,phone:c.value,role:p.value.name}},"$D8HfpvkorG");if(f!=null&&f.value){if(((a=(m=f==null?void 0:f.value)==null?void 0:m.data)==null?void 0:a.code)===500){r.value=!1,A.add({severity:"error",summary:"Error",detail:"Email already exists!",group:"br",life:3e3});return}}else if(((x=k==null?void 0:k.value)==null?void 0:x.code)===200){r.value=!1,b.value=!1,$("closeEditModal",!1),A.add({severity:"success",summary:"Success",detail:"Employee Updated successfully!",group:"br",life:3e3});return}else{r.value=!1,A.add({severity:"error",summary:"Error",detail:"Failed to update employee!",group:"br",life:3e3});return}}};return ae(()=>{const m=document.getElementById("editEmployeeName");pe(()=>{m&&m.focus()})}),(m,a)=>{const x=te,C=ye,k=me,f=le;return U(),Y("div",null,[t("div",ol,[sl,s(x,{id:"editEmployeeName",modelValue:e(v),"onUpdate:modelValue":a[0]||(a[0]=V=>_(v)?v.value=V:null),class:"w-full",placeholder:"Enter Name"},null,8,["modelValue"])]),t("div",al,[il,s(x,{type:"email",modelValue:e(d),"onUpdate:modelValue":a[1]||(a[1]=V=>_(d)?d.value=V:null),class:"w-full",placeholder:"Enter Email"},null,8,["modelValue"])]),t("div",nl,[rl,s(x,{modelValue:e(c),"onUpdate:modelValue":a[2]||(a[2]=V=>_(c)?c.value=V:null),type:"tel",class:"w-full",placeholder:"Enter Phone No."},null,8,["modelValue"])]),t("div",dl,[ul,s(C,{modelValue:e(y),"onUpdate:modelValue":a[3]||(a[3]=V=>_(y)?y.value=V:null),rows:"3",cols:"20",class:"w-full",placeholder:"Enter Address"},null,8,["modelValue"])]),t("div",cl,[pl,s(k,{modelValue:e(p),"onUpdate:modelValue":a[4]||(a[4]=V=>_(p)?p.value=V:null),options:e(w),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Role",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e(h)?(U(),Y("p",ml,"Please fill/check up all the fields")):M("",!0),t("div",vl,[s(f,{label:"Update",icon:"pi pi-check",text:"",onClick:B,loading:e(r)},null,8,["loading"])])])}}},_l=oe(fl,[["__scopeId","data-v-a1134ad4"]]);const he=u=>(ie("data-v-d515e90e"),u=u(),ne(),u),yl={class:"field"},hl=he(()=>t("label",{for:"email"},[T("Email address"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),bl={class:"field flex flex-column"},$l=he(()=>t("label",null,[T("Role"),t("i",{class:"text-red-400 text-italic"},"*")],-1)),gl={key:0,style:{color:"red"}},El={class:"create-btn-wrapper"},xl={__name:"InviteGuest",props:{param:{type:Object,required:!0}},emits:["closeInviteModal"],setup(u,{emit:D}){const z=re(),A=l(u.param.rolesLists),E=l([]),v=se(),d=l(""),c=l(!1),y=l("false"),w=l(!0),p=D,h=async()=>{var b;if(d.value===""||E.value.length===0){c.value=!0;return}else if(y.value=!0,c.value=!1,!c.value){const $=G("token"),{data:r,pending:B}=await de(`${z.public.apiUrl}/invite-user`,{method:"POST",headers:{Authorization:`Bearer ${$.value}`},body:{email:d.value,role:E.value.name}},"$uaOzqXhdzF");((b=r==null?void 0:r.value)==null?void 0:b.code)===201?(d.value=null,w.value=!1,p("closeInviteModal",!1),y.value=!1,v.add({severity:"success",summary:"Success",detail:"Employee invitation sent!",group:"br",life:3e3})):v.add({severity:"error",summary:"Error",detail:"Employee invitation failed!",group:"br",life:3e3})}};return ae(()=>{const b=document.getElementById("inviteEmail");pe(()=>{b&&b.focus()})}),(b,$)=>{const r=te,B=me,m=le;return U(),Y("div",null,[t("div",yl,[hl,s(r,{id:"inviteEmail",type:"email",modelValue:e(d),"onUpdate:modelValue":$[0]||($[0]=a=>_(d)?d.value=a:null),class:"w-full"},null,8,["modelValue"])]),t("div",bl,[$l,s(B,{modelValue:e(E),"onUpdate:modelValue":$[1]||($[1]=a=>_(E)?E.value=a:null),options:e(A),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Role",checkmark:"",highlightOnSelect:!1,class:"w-full"},null,8,["modelValue","options"])]),e(c)?(U(),Y("p",gl,"Please fill/check up all the fields")):M("",!0),t("div",El,[e(y)=="false"?(U(),H(m,{key:0,label:"Send",icon:"pi pi-check",text:"",onClick:h})):(U(),H(m,{key:1,label:"Sending...",icon:"pi pi-spin pi-spinner",text:"",disabled:""}))])])}}},wl=oe(xl,[["__scopeId","data-v-d515e90e"]]);const ue=u=>(ie("data-v-be5fd4a2"),u=u(),ne(),u),kl={key:0,class:"card"},Vl={class:"d-flex mr-2"},Ul=ue(()=>t("div",{class:"d-flex mr-2"},[t("h5",{class:"mb-1"},"Employees")],-1)),Cl=ue(()=>t("i",{class:"pi pi-search"},null,-1)),Il=ue(()=>t("p",{class:"text-center"},"No Data found...",-1)),Sl=ue(()=>t("p",null,"Are you sure you want to delete?",-1)),Nl={__name:"index",setup(u){const D=re(),z=l(W("read_user")),N=l(W("create_user")),A=l(W("update_user")),E=l(W("delete_user")),v=l(),d=l(!0),c=l(!1),y=se(),w=l(!1),p=l(!1),h=l(!1),b=l([]),$=l(!1),r=l(""),B=l(""),m=l(""),a=l(""),x=l(""),C=l([]),k=l([]),f=i=>{w.value=!1,K()},V=i=>{h.value=!1,K()},I=()=>{w.value=!0},be=()=>{p.value=!0},$e=i=>{p.value=!1,K()},J=l([]),ve=l([]),ge=i=>{h.value=!0,r.value=i.id,B.value=i.name,m.value=i.email,a.value=i.phone,x.value=i.address,k.value=i.user_type,C.value.map(o=>{o.name===i.user_type&&(k.value=o)})},Ee=i=>{$.value=!0,r.value=i},xe=async()=>{c.value=!0;const i=G("token"),{data:o,pending:P}=await de(`${D.public.apiUrl}/users/delete/${r.value}`,{method:"DELETE",headers:{Authorization:`Bearer ${i.value}`}},"$BmbV2j3TY3");o.value.code===200?($.value=!1,y.add({severity:"success",summary:"Success",detail:"Employee Deleted successfully!",group:"br",life:3e3}),c.value=!1,K()):(y.add({severity:"error",summary:"Error",detail:"Employee Deleted Failed!",group:"br",life:3e3}),c.value=!1)},fe=l(),we=async()=>{fe.value=J.value?J.value.map(i=>i.id):"",K(fe.value)},K=async i=>{var F,O,R;const o=G("token"),{data:P,pending:g,error:j}=await _e("taskAssignModalData",()=>$fetch(`${D.public.apiUrl}/users/list${i?`?role_id=${i}`:""}`,{headers:{Authorization:`Bearer ${o.value}`}}));((O=(F=P.value)==null?void 0:F.data)==null?void 0:O.length)>0&&(b.value=(R=P.value)==null?void 0:R.data.map((L,q)=>({...L,index:q+1})))},ke=async()=>{var j,F,O,R;const i=G("token"),{data:o,pending:P,error:g}=await _e("roleLiist",()=>$fetch(`${D.public.apiUrl}/roles/list`,{headers:{Authorization:`Bearer ${i.value}`}}));((F=(j=o.value)==null?void 0:j.data)==null?void 0:F.length)>0&&(C.value=(O=o.value)==null?void 0:O.data.map((L,q)=>({...L,index:q+1})),ve.value=(R=o.value)==null?void 0:R.data.map(L=>({name:L.name,id:L.id})),console.log("rolesLists",C.value))},Ve=()=>{v.value={global:{value:null,matchMode:Le.CONTAINS}}};G("rolePermission"),ae(()=>{K(),ke(),d.value=!1}),Ve();const Ue=()=>{if(b.value.length>0){const i=`data:text/csv;charset=utf-8,"Serial No.","Employee Name","Email","Phone","Address","User Type",
`+b.value.map((g,j)=>{const F=j+1,O=g.name,R=g.email,L=g.phone,q=g.address,ce=g.user_type;return`"${F}","${O}","${R}","${L}","${q}","${ce}"`}).join(`
`),o=encodeURI(i),P=document.createElement("a");P.setAttribute("href",o),P.setAttribute("download","tasks.csv"),document.body.appendChild(P),P.click(),document.body.removeChild(P)}else y.add({severity:"error",summary:"Error",detail:"No data found to download",group:"br",life:3e3})};return(i,o)=>{const P=Ie,g=le,j=Se,F=Ne,O=te,R=Pe,L=Te,q=Ae,ce=Me("tooltip");return e(z)?(U(),Y("div",kl,[t("div",Vl,[s(P,{position:"bottom-right",group:"br"}),Ul]),s(L,{class:"border-0 px-0"},{start:S(()=>[e(N)?(U(),H(g,{key:0,icon:"pi pi-plus",label:"Create",onClick:I,class:"mr-2",severity:"secondary"})):M("",!0),e(N)?(U(),H(g,{key:1,icon:"pi pi-users",onClick:be,label:"Invite a guest",severity:"secondary"})):M("",!0)]),end:S(()=>[De(s(g,{onClick:o[0]||(o[0]=n=>Ue(i.tasks)),loading:e(d),severity:"secondary",class:"px-4",icon:"pi pi-file-excel"},null,8,["loading"]),[[ce,{value:"Download Tasks"},void 0,{right:!0}]]),s(j,{onChange:o[1]||(o[1]=n=>we()),modelValue:e(J),"onUpdate:modelValue":o[2]||(o[2]=n=>_(J)?J.value=n:null),options:e(ve),display:"chip",filter:"",resetFilterOnHide:"",maxSelectedLabels:2,optionLabel:"name",placeholder:"Filter User Type",class:"w-full mx-2 filtr"},null,8,["modelValue","options"]),s(R,{iconPosition:"right",raised:""},{default:S(()=>[s(F,null,{default:S(()=>[Cl]),_:1}),s(O,{modelValue:e(v).global.value,"onUpdate:modelValue":o[3]||(o[3]=n=>e(v).global.value=n),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),_:1}),s(e(Fe),{filters:e(v),"onUpdate:filters":o[4]||(o[4]=n=>_(v)?v.value=n:null),class:"table-st",value:e(b),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:e(d)},{empty:S(()=>[Il]),loading:S(()=>[s(q,{style:{width:"50px",height:"50px"}})]),footer:S(()=>[T(" In total there are "+Be(e(b)?e(b).length:0)+" rows. ",1)]),default:S(()=>[s(e(X),{field:"index",header:"Serial",sortable:""}),s(e(X),{field:"name",header:"Employee Name"}),s(e(X),{field:"email",header:"Email Address"}),s(e(X),{field:"phone",header:"Phone"}),s(e(X),{field:"user_type",header:"User Type"}),s(e(X),{field:"action",header:"Action"},{body:S(n=>[e(A)?(U(),H(g,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:Ce=>ge(n.data)},null,8,["onClick"])):M("",!0),e(A)?M("",!0):(U(),H(g,{key:1,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",style:{visibility:"hidden"}})),e(E)?(U(),H(g,{key:2,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:Ce=>Ee(n.data.id)},null,8,["onClick"])):M("",!0),e(E)?M("",!0):(U(),H(g,{key:3,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(ee),{visible:e(w),"onUpdate:visible":o[6]||(o[6]=n=>_(w)?w.value=n:null),modal:"",header:"Create Employee",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:S(()=>[s(tl,{param:{rolesLists:e(C)},onCloseCreateModal:o[5]||(o[5]=n=>f(n))},null,8,["param"])]),_:1},8,["visible"]),s(e(ee),{visible:e(h),"onUpdate:visible":o[8]||(o[8]=n=>_(h)?h.value=n:null),modal:"",header:"Edit Employee",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:S(()=>[s(_l,{param:{id:e(r),name:e(B),address:e(x),phone:e(a),email:e(m),user_type:e(k),rolesLists:e(C)},onCloseEditModal:o[7]||(o[7]=n=>V(n))},null,8,["param"])]),_:1},8,["visible"]),s(e(ee),{visible:e($),"onUpdate:visible":o[10]||(o[10]=n=>_($)?$.value=n:null),header:" ",style:{width:"25rem"}},{default:S(()=>[Sl,s(g,{label:"No",icon:"pi pi-times",text:"",onClick:o[9]||(o[9]=n=>$.value=!1)}),s(g,{label:"Yes",icon:"pi pi-check",text:"",onClick:xe,loading:e(c)},null,8,["loading"])]),_:1},8,["visible"]),s(e(ee),{visible:e(p),"onUpdate:visible":o[12]||(o[12]=n=>_(p)?p.value=n:null),modal:"",header:"Invite Employee",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:S(()=>[s(wl,{param:{rolesLists:e(C)},onCloseInviteModal:o[11]||(o[11]=n=>$e(n))},null,8,["param"])]),_:1},8,["visible"])])):M("",!0)}}},Et=oe(Nl,[["__scopeId","data-v-be5fd4a2"]]);export{Et as default};
