import H from"./toast.esm.b17bbc51.js";import Y from"./multiselect.esm.f28c9f3c.js";import q from"./calendar.esm.93994793.js";import J from"./button.esm.88347c6f.js";import K from"./toolbar.esm.73b64771.js";import Q from"./column.esm.8a6ee162.js";import X from"./datatable.esm.f74cef75.js";import Z from"./tabpanel.esm.9168d6b9.js";import ee from"./tabview.esm.d9dc7a0f.js";import{a2 as te,a3 as ae,$ as v,a4 as oe,a5 as le,ar as se,b as G,l as t,w as h,o as $,i as e,u as o,a7 as B,c as U,e as M,a8 as ie,a9 as ne,ca as re}from"./entry.3e031b31.js";import{u as W}from"./fetch.61c1c88e.js";import{u as O}from"./cookie.3a12c915.js";import{u as de}from"./workCompany.26742698.js";import"./radiobutton.esm.2c677a93.js";import"./portal.esm.448751c9.js";import"./basecomponent.esm.f10d2202.js";import"./index.esm.3bbfbffd.js";import"./baseicon.esm.ab14f454.js";import"./index.esm.491b053f.js";import"./index.esm.96be34b5.js";import"./index.esm.906520e3.js";import"./checkbox.esm.3d476e26.js";import"./index.esm.2869aa49.js";import"./index.esm.5dc4fd42.js";import"./index.esm.e4de41df.js";import"./overlayeventbus.esm.6bdd91ba.js";import"./virtualscroller.esm.36665890.js";import"./index.esm.b9209505.js";import"./index.esm.fda85297.js";import"./index.esm.282cf79d.js";import"./badge.esm.d2071273.js";import"./paginator.esm.b5f94b10.js";import"./index.esm.b1e73331.js";import"./dropdown.esm.4e38f6fc.js";import"./inputnumber.esm.9e5cecde.js";import"./index.esm.1ade529d.js";import"./index.esm.f7fd1575.js";import"./inputtext.esm.54067f1b.js";import"./index.esm.e37a6ddf.js";import"./index.esm.c53ff983.js";import"./index.esm.6604c4b8.js";import"./index.esm.112fa617.js";const s=I=>(ie("data-v-9d530c8e"),I=I(),ne(),I),ce={class:"card"},ue=s(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"Project Reports")],-1)),pe={class:"card"},me=s(()=>e("div",{class:"d-flex mr-2"},[e("h5",{class:"mb-1"},"Task Reports")],-1)),_e={class:"flex gap-2 flex-wrap align-items-center"},fe={class:"user-selection w-full md:w-14rem w-full"},ve=s(()=>e("label",{class:"font-bold block mb-2"},"Spaces:",-1)),he={class:"flex justify-content-center"},be={class:"user-selection w-full md:w-14rem w-full"},ge=s(()=>e("label",{class:"font-bold block mb-2"},"Projects:",-1)),ye={class:"flex justify-content-center"},we={class:"flex-auto"},je=s(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"From: ",-1)),De={class:"flex-auto"},Se=s(()=>e("label",{for:"icondisplay",class:"font-bold block mb-2"},"To: ",-1)),xe={key:0,class:"card"},ke={class:"flex align-items-center justify-content-between gap-2 mb-5"},$e=s(()=>e("h5",{class:"m-0",style:{visibility:"hidden"}},"Overview",-1)),Ie={class:"card"},Ne=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Overview")],-1)),Te=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Pe=s(()=>e("br",null,null,-1)),Ce={class:"card"},Ve=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Project Wise Count")],-1)),Fe=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Be=s(()=>e("br",null,null,-1)),Me={class:"card"},Ue=s(()=>e("div",{class:"flex align-items-center justify-content-between gap-2 mb-5"},[e("h5",{class:"m-0"},"Sprint")],-1)),Re=s(()=>e("p",{class:"text-center"},"No Data found...",-1)),Ee={__name:"index",setup(I){const{totalProjectsforReport:w,totalSpaces:z}=ae(de()),R=re(),p=v(""),m=v(""),r=v(),j=v([]),b=v(),N=v(null),T=v(null),P=v(null),D=v(!1),S=v(!1),C=oe();le(()=>{(!r.value||r.value.length===0)&&(w.value&&w.value.length>0?j.value=[...w.value]:j.value=[])}),se(r,_=>{if(_&&_.length>0){const l=_.flatMap(d=>d.projects);j.value=l}else w.value&&w.value.length>0?j.value=[...w.value]:j.value=[]});const V=_=>{const l=_,d=new Date(l),i=d.getFullYear(),n=String(d.getMonth()+1).padStart(2,"0"),c=String(d.getDate()).padStart(2,"0");return`${i}-${n}-${c}`},A=async()=>{var a,g,u,F,f,E;if(p.value&&!m.value||!p.value&&m.value)return D.value=!1,C.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const _=O("token");D.value=!0;const l=V(p.value),d=V(m.value);let i;r.value&&r.value.length>0&&(i=(a=r.value)==null?void 0:a.map(y=>y.id),console.log("Space ID",i));let n;b.value&&b.value.length>0&&(n=(g=b.value)==null?void 0:g.map(y=>y.id),console.log("Project ID",n));const{data:c,error:x}=await W(`${R.public.apiUrl}/project-report/view?space_ids=${i||""}&project_ids=${n||""}&start_date=${p.value?l:""}&end_date=${m.value?d:""}`,{method:"GET",headers:{Authorization:`Bearer ${_.value}`}},"$tkCbN62YMP");return((u=c.value)==null?void 0:u.code)==200?(N.value=(F=c.value.data)==null?void 0:F.overView.map((y,k)=>({...y,index:k+1})),T.value=(f=c.value.data)==null?void 0:f.projectWiseCount.map((y,k)=>({...y,index:k+1})),P.value=(E=c.value.data)==null?void 0:E.sprintTask.map((y,k)=>({...y,index:k+1})),D.value=!1):(D.value=!1,C.add({severity:"error",summary:"Failed",detail:"Failed to generate!",group:"br",life:3e3}))},L=async()=>{var a,g;const _=O("token");if(S.value=!0,p.value&&!m.value||!p.value&&m.value)return D.value=!1,C.add({severity:"warn",summary:"Warning",detail:"Please Select Both Dates",group:"br",life:3e3});const l=V(p.value),d=V(m.value);let i;r.value&&r.value.length>0&&(i=(a=r.value)==null?void 0:a.map(u=>u.id),console.log("Space ID",i));let n;b.value&&b.value.length>0&&(n=(g=b.value)==null?void 0:g.map(u=>u.id),console.log("Project ID",n));const{data:c,error:x}=await W(`${R.public.apiUrl}/project-report/download?space_ids=${i||""}&project_ids=${n||""}&start_date=${p.value?l:""}&end_date=${m.value?d:""}`,{method:"GET",headers:{Authorization:`Bearer ${_.value}`}},"$tccjGN5izh");if(x.value)return console.log(x),S.value=!1;if(c.value.code==200){const u=document.createElement("a");return u.href=c.value.download_path,u.target="_blank",u.click(),S.value=!1}else return S.value=!1,C.add({severity:"error",summary:"Failed",detail:"Failed to download",group:"br",life:3e3})};return(_,l)=>{const d=H,i=Y,n=q,c=J,x=K,a=Q,g=X,u=Z,F=ee;return $(),G("div",ce,[t(d,{position:"bottom-right",group:"br"}),ue,t(F,{onTabChange:_.onTabChange,class:"mt-3"},{default:h(()=>[t(u,{class:"file-upload",header:"Project Report"},{default:h(()=>[e("div",pe,[t(d,{position:"bottom-right",group:"br"}),me,t(x,{class:"border-0 px-0"},{start:h(()=>[e("div",_e,[e("div",fe,[ve,e("div",he,[t(i,{display:"chip",modelValue:o(r),"onUpdate:modelValue":l[0]||(l[0]=f=>B(r)?r.value=f:null),options:o(z),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Spaces",class:"w-full"},null,8,["modelValue","options"])])]),e("div",be,[ge,e("div",ye,[t(i,{display:"chip",modelValue:o(b),"onUpdate:modelValue":l[1]||(l[1]=f=>B(b)?b.value=f:null),options:o(j),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Projects",class:"w-full"},null,8,["modelValue","options"])])]),e("div",we,[je,t(n,{modelValue:o(p),"onUpdate:modelValue":l[2]||(l[2]=f=>B(p)?p.value=f:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])]),e("div",De,[Se,t(n,{modelValue:o(m),"onUpdate:modelValue":l[3]||(l[3]=f=>B(m)?m.value=f:null),showIcon:"",iconDisplay:"input",inputId:"icondisplay"},null,8,["modelValue"])])])]),end:h(()=>[t(c,{onClick:A,class:"w-full",label:"Generate",loading:o(D)},null,8,["loading"])]),_:1})]),o(N)||o(T)||o(P)?($(),G("div",xe,[e("div",ke,[$e,t(c,{onClick:L,class:"w-fit",label:"Download",loading:o(S)},null,8,["loading"])]),e("div",Ie,[Ne,o(N)?($(),U(g,{key:0,value:o(N),tableStyle:"min-width: 50rem"},{empty:h(()=>[Te]),default:h(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"total_iteration",header:"Total Number of Iteration"}),t(a,{field:"total_missed_deadline",header:"No. of Missed Deadlines"}),t(a,{field:"missed_deadline_percentage",header:"% of Missed Deadlines"})]),_:1},8,["value"])):M("",!0)]),Pe,e("div",Ce,[Ve,o(T)?($(),U(g,{key:0,value:o(T),tableStyle:"min-width: 50rem"},{empty:h(()=>[Fe]),default:h(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"project_name",header:"Project Name"}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"total_iteration",header:"No. of Iteration"}),t(a,{field:"total_missed_deadline",header:"No.of Missed Deadlines"})]),_:1},8,["value"])):M("",!0)]),Be,e("div",Me,[Ue,o(P)?($(),U(g,{key:0,value:o(P),tableStyle:"min-width: 50rem"},{empty:h(()=>[Re]),default:h(()=>[t(a,{field:"index",header:"Serial",sortable:""}),t(a,{field:"task_name",style:{width:"40%"},header:"Task Name"}),t(a,{field:"project_name",header:"Project Name"}),t(a,{field:"status",header:"Status"}),t(a,{field:"due_date",header:"Due Date"}),t(a,{field:"end_date",header:"End Date"}),t(a,{field:"duration",header:"Duration"}),t(a,{field:"unit_name",header:"Unit Name"}),t(a,{field:"missed_deadline",header:"Missed Deadlines"})]),_:1},8,["value"])):M("",!0)])])):M("",!0)]),_:1})]),_:1},8,["onTabChange"])])}}},It=te(Ee,[["__scopeId","data-v-9d530c8e"]]);export{It as default};
