import ae from"./toast.esm.b315e9a7.js";import H from"./button.esm.cf9d0562.js";import ie from"./inputicon.esm.35508b74.js";import q from"./inputtext.esm.6420a228.js";import re from"./iconfield.esm.0540315d.js";import ne from"./toolbar.esm.42bfa2eb.js";import de from"./progressspinner.esm.8110cf06.js";import Q from"./multiselect.esm.1dd8bd34.js";import{a4 as j,$ as t,a5 as K,a6 as W,o as f,b as L,i as l,l as s,u as e,a7 as N,e as T,q as O,ca as X,a2 as ce,a8 as pe,a9 as me,w as u,P as ue,c as D,F as _e,f as ve,t as fe}from"./entry.96805b80.js";import{u as A,a as Z,b as G}from"./cookie.7ef5219e.js";import I from"./column.esm.4d99c280.js";import ye from"./datatable.esm.2507d500.js";import{a as z}from"./usePermission.0205306e.js";import J from"./dialog.esm.80bb630d.js";import"./portal.esm.15c426bb.js";import"./basecomponent.esm.3decbfca.js";import"./index.esm.efaa8c11.js";import"./baseicon.esm.fddbd52e.js";import"./index.esm.7c32132d.js";import"./index.esm.dae45d6e.js";import"./index.esm.b26aa7fa.js";import"./badge.esm.4581aeeb.js";import"./index.esm.0676624a.js";import"./checkbox.esm.c029db23.js";import"./index.esm.a9c0fa91.js";import"./index.esm.5e30471d.js";import"./overlayeventbus.esm.de0024a9.js";import"./virtualscroller.esm.3009a4fc.js";import"./paginator.esm.32aa8892.js";import"./index.esm.1fa74bfc.js";import"./dropdown.esm.50168ae5.js";import"./inputnumber.esm.1b2f00de.js";import"./index.esm.35f58cc1.js";import"./index.esm.ddc74b33.js";import"./index.esm.bfe69164.js";import"./index.esm.f6c0662b.js";import"./index.esm.38168f8e.js";import"./radiobutton.esm.a4b3506e.js";import"./index.esm.02b23df2.js";import"./index.esm.8e48976f.js";const be={class:"field"},he=l("label",{for:"company"},[O("Role Name"),l("i",{class:"text-red-400 text-italic"},"*")],-1),xe={class:"field permission_selection"},$e=l("label",null,[O("Permissions"),l("i",{class:"text-red-400 text-italic"},"*")],-1),ge={key:0,style:{color:"red"}},Re={class:"create-btn-wrapper mb-0"},ke={__name:"CreateRole",props:{param:{type:Object,required:!0}},emits:["closeCreateModal"],setup(h,{emit:E}){const M=X(),x=h,$=j(),i=t(""),_=t(x.param.permissionsList),c=t([]),r=t(!1),y=t(!0),v=E,C=async()=>{var m;if(i.value===""){r.value=!0;return}else if(r.value=!1,!r.value){const a=A("token"),{data:p,pending:g}=await Z(`${M.public.apiUrl}/roles/create`,{method:"POST",headers:{Authorization:`Bearer ${a.value}`},body:{name:i.value,permissions:c.value.map(R=>R.id)}},"$lLTkTCcXoV");((m=p.value)==null?void 0:m.code)===201?(i.value=null,y.value=!1,v("closeCreateModal",!1),$.add({severity:"success",summary:"Success",detail:"Role Created successfully!",group:"br",life:3e3})):$.add({severity:"error",summary:"Error",detail:"Role Creation Failed!",group:"br",life:3e3})}};return K(()=>{const m=document.getElementById("createRoleName");W(()=>{m&&m.focus()})}),(m,a)=>{const p=q,g=Q,R=H;return f(),L("div",null,[l("div",be,[he,s(p,{id:"createRoleName",modelValue:e(i),"onUpdate:modelValue":a[0]||(a[0]=b=>N(i)?i.value=b:null),class:"w-full",placeholder:"Enter role name"},null,8,["modelValue"])]),l("div",xe,[$e,s(g,{display:"chip",modelValue:e(c),"onUpdate:modelValue":a[1]||(a[1]=b=>N(c)?c.value=b:null),options:e(_),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(r)?(f(),L("p",ge,"Please enter role name")):T("",!0),l("div",Re,[s(R,{label:"Save",icon:"pi pi-check",text:"",onClick:C})])])}}};const ee=h=>(pe("data-v-ae8a0175"),h=h(),me(),h),we={class:"field"},Ce=ee(()=>l("label",{for:"company"},[O("Role Name"),l("i",{class:"text-red-400 text-italic"},"*")],-1)),Se={class:"field permission_selection"},Pe=ee(()=>l("label",null,[O("Permissions"),l("i",{class:"text-red-400 text-italic"},"*")],-1)),Ve={key:0,style:{color:"red"}},Le={class:"create-btn-wrappe"},Ne={__name:"EditRole",props:{param:{type:Object,required:!0}},emits:["closeEditModal"],setup(h,{emit:E}){const M=X(),x=h,$=j(),i=t(x.param.id),_=t(x.param.name),c=t(x.param.permissionsList),r=t(x.param.slctdPermissions),y=t(!1),v=t(!0),C=E,m=async()=>{var a;if(_.value===""){y.value=!0;return}else if(y.value=!1,!y.value){const p=A("token"),{data:g,pending:R}=await Z(`${M.public.apiUrl}/roles/update/${i.value}`,{method:"POST",headers:{Authorization:`Bearer ${p.value}`},body:{name:_.value,permissions:r.value.map(b=>b.id)}},"$AftFLbfnYe");((a=g.value)==null?void 0:a.code)===200?(v.value=!1,C("closeEditModal",!1),$.add({severity:"success",summary:"Success",detail:"Role updated successfully!",group:"br",life:3e3})):$.add({severity:"error",summary:"Error",detail:"Failed to update role!",group:"br",life:3e3})}};return K(async()=>{const a=document.getElementById("editTeamName");W(()=>{a&&a.focus()})}),(a,p)=>{const g=q,R=Q,b=H;return f(),L("div",null,[l("div",we,[Ce,s(g,{id:"editTeamName",modelValue:e(_),"onUpdate:modelValue":p[0]||(p[0]=k=>N(_)?_.value=k:null),class:"w-full",placeholder:"Edit role name"},null,8,["modelValue"])]),l("div",Se,[Pe,s(R,{display:"chip",modelValue:e(r),"onUpdate:modelValue":p[1]||(p[1]=k=>N(r)?r.value=k:null),options:e(c),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Select Permissions",maxSelectedLabels:40,class:"w-full"},null,8,["modelValue","options"])]),e(y)?(f(),L("p",Ve,"Please enter tag name")):T("",!0),l("div",Le,[s(b,{label:"Update",icon:"pi pi-check",text:"",onClick:m})])])}}},Ee=ce(Ne,[["__scopeId","data-v-ae8a0175"]]);const Te={key:0,class:"card"},Me=l("div",{class:"d-flex mr-2"},[l("h5",{class:"mb-1"},"User Role")],-1),Ue=l("i",{class:"pi pi-search"},null,-1),Be=l("p",{class:"text-center"},"No Data found...",-1),Fe={style:{display:"flex","flex-wrap":"wrap",gap:"5px"}},kt={__name:"index",setup(h){const E=X(),M=t(z("read_role")),x=t(z("create_role")),$=t(z("update_role")),i=t(),_=t(!0);j();const c=t(!1),r=t(!1),y=t([]),v=t([]),C=t([]),m=t(""),a=t(""),p=d=>{c.value=!1,k()},g=d=>{r.value=!1,k()},R=()=>{c.value=!0,k()},b=d=>{var o;r.value=!0,m.value=d.id,a.value=d.name,v.value=v.value,C.value=[],((o=d==null?void 0:d.permissions)==null?void 0:o.length)>0&&d.permissions.map(U=>{v.value.map(w=>{U.id===w.id&&C.value.push(w)})})},k=async()=>{var S,P,V;const d=A("token"),{data:o,pending:U,error:w}=await G("roleList",()=>$fetch(`${E.public.apiUrl}/roles/list`,{headers:{Authorization:`Bearer ${d.value}`}}));((P=(S=o.value)==null?void 0:S.data)==null?void 0:P.length)>0&&(y.value=(V=o.value)==null?void 0:V.data.map((B,F)=>({...B,index:F+1})))},te=async()=>{var S,P,V;const d=A("token"),{data:o,pending:U,error:w}=await G("permissionList",()=>$fetch(`${E.public.apiUrl}/permissions/list`,{headers:{Authorization:`Bearer ${d.value}`}}));((P=(S=o.value)==null?void 0:S.data)==null?void 0:P.length)>0&&(v.value=(V=o.value)==null?void 0:V.data.map((B,F)=>({...B,index:F+1})))},oe=()=>{i.value={global:{value:null,matchMode:ue.CONTAINS}}};return K(()=>{k(),te(),_.value=!1}),oe(),(d,o)=>{const U=ae,w=H,S=ie,P=q,V=re,B=ne,F=de,se=ke,le=Ee;return e(M)?(f(),L("div",Te,[s(U,{position:"bottom-right",group:"br"}),Me,s(B,{class:"border-0 px-0"},{start:u(()=>[e(x)?(f(),D(w,{key:0,icon:"pi pi-plus",label:"Create",onClick:R,class:"mr-2",severity:"secondary"})):T("",!0)]),end:u(()=>[s(V,{iconPosition:"right",raised:""},{default:u(()=>[s(S,null,{default:u(()=>[Ue]),_:1}),s(P,{modelValue:e(i).global.value,"onUpdate:modelValue":o[0]||(o[0]=n=>e(i).global.value=n),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),_:1}),s(e(ye),{filters:e(i),"onUpdate:filters":o[1]||(o[1]=n=>N(i)?i.value=n:null),class:"table-stR",value:e(y),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:15,dataKey:"id",filterDisplay:"menu",loading:e(_)},{empty:u(()=>[Be]),loading:u(()=>[s(F,{style:{width:"50px",height:"50px"}})]),default:u(()=>[s(e(I),{field:"index",header:"Serial",sortable:""}),s(e(I),{style:{"text-wrap":"nowrap"},field:"name",header:"Role Name"}),s(e(I),{field:"permissions",header:"Permission"},{body:u(n=>[l("div",Fe,[(f(!0),L(_e,null,ve(n.data.permissions,Y=>(f(),L("div",{class:"border rounded",key:d.permission,style:{border:"1px solid rgba(167, 167, 167, 0.486)","border-radius":"5px",padding:"2px 5px"}},[l("p",null,fe(Y.name),1)]))),128))])]),_:1}),s(e(I),{field:"action",header:"Action"},{body:u(n=>[e($)?(f(),D(w,{key:0,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",onClick:Y=>b(n.data)},null,8,["onClick"])):T("",!0),e($)?T("",!0):(f(),D(w,{key:1,icon:"pi pi-pencil",text:"",class:"mr-2",severity:"success",rounded:"",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(J),{visible:e(c),"onUpdate:visible":o[3]||(o[3]=n=>N(c)?c.value=n:null),modal:"",header:"Create Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(se,{param:{permissionsList:e(v)},onCloseCreateModal:o[2]||(o[2]=n=>p(n))},null,8,["param"])]),_:1},8,["visible"]),s(e(J),{visible:e(r),"onUpdate:visible":o[5]||(o[5]=n=>N(r)?r.value=n:null),modal:"",header:"Edit Role",style:{width:"35rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(le,{param:{id:e(m),name:e(a),permissionsList:e(v),slctdPermissions:e(C)},onCloseEditModal:o[4]||(o[4]=n=>g(n))},null,8,["param"])]),_:1},8,["visible"])])):T("",!0)}}};export{kt as default};
