import he from"./toast.esm.53b25a6c.js";import{_ as xe}from"./nuxt-link.07695651.js";import{_ as ye}from"./CreateSpecificProject.d1c7d080.js";import be from"./inputicon.esm.ff606314.js";import ue from"./inputtext.esm.426f9e47.js";import ke from"./iconfield.esm.c13561ec.js";import pe from"./button.esm.ab872eb1.js";import Se from"./textarea.esm.abb72b36.js";import je from"./inputgroupaddon.esm.373b9979.js";import we from"./inputgroup.esm.a98d68c6.js";import Pe from"./dropdown.esm.d38a9420.js";import{d as $e}from"./vuedraggable.umd.828ac519.js";import{a3 as me,a4 as _e,$ as l,V as se,ar as re,a5 as ve,a6 as Ce,a as fe,o as _,b as j,u as e,i as o,q as $,t as R,l as s,a7 as x,w as u,s as M,e as y,K as Ve,aa as Ne,ab as Ee,c as O,P as Te}from"./entry.198ba3db.js";import{u as H}from"./company.9b6106ad.js";import ce from"./colorpicker.esm.1a9e9e74.js";import"./inputswitch.esm.e6ea0382.js";import de from"./dialog.esm.88595072.js";import{a as le}from"./usePermission.e4dc5c7d.js";import J from"./column.esm.a6b2ff04.js";import De from"./datatable.esm.6f5cdcea.js";import"./portal.esm.1155227e.js";import"./basecomponent.esm.8266eeb3.js";import"./index.esm.d18f7c7e.js";import"./baseicon.esm.9510ddf5.js";import"./index.esm.557db23e.js";import"./index.esm.428bbe49.js";import"./index.esm.1cf25068.js";import"./fetch.53facc60.js";import"./cookie.4537ecc8.js";import"./workCompany.6a66780b.js";import"./badge.esm.ac3ed985.js";import"./index.esm.6bc1d8f1.js";import"./index.esm.3622bfba.js";import"./index.esm.b37bf06f.js";import"./overlayeventbus.esm.97fbed22.js";import"./virtualscroller.esm.31157379.js";import"./_commonjsHelpers.87174ba5.js";import"./paginator.esm.f4459061.js";import"./index.esm.c33042e5.js";import"./inputnumber.esm.d672b7db.js";import"./index.esm.752f6995.js";import"./index.esm.6e5674eb.js";import"./index.esm.7dd22d7d.js";import"./index.esm.2e9e6151.js";import"./index.esm.91bae4af.js";import"./checkbox.esm.f9968f65.js";import"./radiobutton.esm.8904be74.js";import"./index.esm.809f33f6.js";import"./index.esm.599bc207.js";const Ue={class:"position-relative d-flex flex-column justify-content-between w-100 modal-container"},Ie={key:0},Le={class:"field"},Oe={for:"name"},Me={class:"field flex flex-column"},Be=o("label",{for:"editProjectName"},[$("Project Name"),o("i",{class:"text-red-400 text-italic"},"*")],-1),Fe={class:"field flex flex-column"},Ke=o("label",{for:"name"},"Project Description",-1),qe={class:"mb-4"},Ae=o("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[$("Setup Task Status"),o("i",{class:"text-red-400 text-italic"},"*")],-1),Ge={class:"container"},Je=o("p",{class:"pi pi-plus cursor-pointer"},null,-1),Re={key:0,class:"text-red-600 text-small"},He={class:"row mt-2"},We={class:"col-12 d-flex flex-column p-0"},ze=["onMouseenter"],Xe={style:{"margin-right":"-3px"},width:"15",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",class:"cu-status-manager-status-list-item__drag-handler-icon"},Ye=o("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"},[o("circle",{cx:"5",cy:"5",r:"1"}),o("circle",{cx:"5",cy:"12",r:"1"}),o("circle",{cx:"5",cy:"19",r:"1"}),o("circle",{cx:"12",cy:"5",r:"1"}),o("circle",{cx:"12",cy:"12",r:"1"}),o("circle",{cx:"12",cy:"19",r:"1"})],-1),Qe=[Ye],Ze={class:"flex align-items-center",style:{width:"88%"}},et=["onClick"],tt=o("p",{class:"pi pi-times"},null,-1),ot=[tt],st={class:""},lt=o("p",{class:"text-slate-700 mb-2 tracking-wide left-3"},[$("Set Task Close Status"),o("i",{class:"text-red-400 text-italic"},"*")],-1),at={class:"container"},it={class:"field"},nt={key:0,class:"text-red-600 text-small"},rt={class:"field flex flex-column mb-3"},ct=o("label",{for:"name"},"Gitlab ID ",-1),dt={key:0,class:"text-center",style:{color:"red"}},ut={class:"float-right"},pt={__name:"EditProject",props:["refProjectId","singleSpace"],emits:["closeEditProject"],setup(W,{emit:z}){const{editProject:X}=H(),{isProjectEdited:f}=me(H()),B=_e(),{refProjectId:n,singleSpace:ae}=W,I=z,F=l(!0),g=l(!1),K=l(!0),L=l(!1),w=l(null),b=l(!0),Y=se(()=>({animation:250,group:"tasks",disabled:!b.value,ghostClass:"ghost"})),k=se(()=>({backgroundColor:"#fff",boxShadow:"0px 2px 2px #e2e2e2",cursor:"grab",margin:"8px 0px"})),C=se(()=>({backgroundColor:"#f9f9f9",boxShadow:"0px 4px 4px #e2e2e3",cursor:"grab",margin:"8px 0px"})),v=l(""),Q=l(n==null?void 0:n.statuses.map((a,t)=>({...a,serial_no:t+1}))),r=l([]);r.value=JSON.parse(JSON.stringify(Q.value));const V=l("6466f1"),q=l(null),N=l(!1),m=l(n==null?void 0:n.name),d=l(n==null?void 0:n.description),E=l(n==null?void 0:n.git_project_id),T=()=>{var a;if(v.value?N.value=!1:N.value=!0,((a=v==null?void 0:v.value)==null?void 0:a.length)>0){const t={name:v.value,color_code:`#${V.value}`,is_closed_status:0,serial_no:r.value.length+1};r.value.push(t),v.value=""}else N.value=!0;r.value.length>0&&(q.value=!0)},Z=a=>{var t,p;r.value.splice(a,1),((t=h.value)==null?void 0:t.is_closed_status)===((p=r.value[a])==null?void 0:p.is_closed_status)&&(h.value=null),r.value.length==0&&(q.value=!1)},h=l(null);h.value=r.value.find(a=>a.is_closed_status===1),re(h,a=>{a&&r.value.forEach(t=>{t.is_closed_status=t.name===a.name?1:0})}),re(r,a=>{a.forEach((t,p)=>{t.serial_no=p+1})});const ee=a=>a.map(t=>({taskStatusName:t.name,taskStatusColor:t.color_code.startsWith("#")?t.color_code:`#${t.color_code}`,is_closed_status:t.is_closed_status,serial_no:t.serial_no})),P=l(!1),S=async()=>{if(P.value=!0,m.value===null||r.value.length<=0||!h.value)g.value=!0,P.value=!1;else{g.value=!1,r.value.forEach(i=>{const D=["color_code","name","is_closed_status","serial_no"];Object.keys(i).forEach(A=>{D.includes(A)||delete i[A]})});const a=JSON.parse(JSON.stringify(r.value)),t=ee(a);console.log("shallow List",a),console.log("transformedTaskStatusList",t);const p={id:n==null?void 0:n.id,name:m.value,description:d.value,space_id:n==null?void 0:n.space_id,statuses:t,git_project_id:E.value};await X(p),f.value===!0?(I("closeEditProject",!1),P.value=!1,B.add({severity:"success",summary:"Project creation",detail:"Project updated successfully!",group:"br",life:3e3})):(P.value=!1,B.add({severity:"error",summary:"Project creation",detail:"Failed to update project!",group:"br",life:3e3}))}},te=()=>{I("closeEditProject",!1)};return ve(()=>{Q.value=n==null?void 0:n.statuses;const a=document.getElementById("editProjectName");Ce(()=>{a&&a.focus()})}),(a,t)=>{var ne;const p=ue,i=Se,D=je,A=we,ge=Pe,ie=pe,G=fe("tooltip");return _(),j("div",Ue,[e(F)?(_(),j("div",Ie,[o("div",Le,[o("label",Oe,[$("Project: "),o("strong",null,R((ne=W.refProjectId)==null?void 0:ne.name),1)])]),o("div",Me,[Be,s(p,{id:"editProjectName",modelValue:e(m),"onUpdate:modelValue":t[0]||(t[0]=c=>x(m)?m.value=c:null),required:"true"},null,8,["modelValue"])]),o("div",Fe,[Ke,s(i,{id:"description",class:"border-gray-300",modelValue:e(d),"onUpdate:modelValue":t[1]||(t[1]=c=>x(d)?d.value=c:null),rows:"3",cols:"20"},null,8,["modelValue"])]),o("div",qe,[Ae,o("div",Ge,[s(A,null,{default:u(()=>[s(D,null,{default:u(()=>[M(s(e(ce),{class:"color-pick",style:{width:"1.5rem"},modelValue:e(V),"onUpdate:modelValue":t[2]||(t[2]=c=>x(V)?V.value=c:null),inputId:"cp-hex",format:"hex"},null,8,["modelValue"]),[[G,{value:"Pick Color"},void 0,{left:!0}]])]),_:1}),M(s(p,{class:"form-control",modelValue:e(v),"onUpdate:modelValue":t[3]||(t[3]=c=>x(v)?v.value=c:null),placeholder:"e.g., TO-DO, DOING"},null,8,["modelValue"]),[[G,{value:"Type Status Name"},void 0,{top:!0}]]),s(D,{onClick:T,class:"btn btn-outline-secondary cursor-pointer"},{default:u(()=>[Je]),_:1})]),_:1}),e(N)?(_(),j("p",Re," Please type status name! ")):y("",!0),o("div",He,[o("div",We,[s(e($e),{modelValue:e(r),"onUpdate:modelValue":t[5]||(t[5]=c=>x(r)?r.value=c:null),options:e(Y),disabled:!e(K),class:"list-group","ghost-class":"ghost",move:a.checkMove,onStart:t[6]||(t[6]=c=>L.value=!0),onEnd:t[7]||(t[7]=c=>L.value=!1)},{item:u(({element:c,index:oe})=>[(_(),j("div",{class:"flex delete-task justify-content-between",style:Ve(e(w)===oe?e(C):e(k)),onMouseenter:U=>w.value=oe,onMouseleave:t[4]||(t[4]=U=>w.value=null),key:c.id},[(_(),j("svg",Xe,Qe)),o("div",Ze,[M(s(e(ce),{class:"color-pick mr-2 status-colors border-none",modelValue:c.color_code,"onUpdate:modelValue":U=>c.color_code=U,inputId:"cp-hex",format:"hex"},null,8,["modelValue","onUpdate:modelValue"]),[[G,{value:"Change Color"},void 0,{left:!0}]]),M(s(p,{class:"text-uppercase text-muteds w-full",modelValue:c.name,"onUpdate:modelValue":U=>c.name=U,required:"true"},null,8,["modelValue","onUpdate:modelValue"]),[[G,{value:"Change Status Name"},void 0,{right:!0}]])]),o("div",{onClick:U=>Z(oe),class:"cursor-pointer cross-icon ms-1 flex justify-content-center align-items-center"},ot,8,et)],44,ze))]),_:1},8,["modelValue","options","disabled","move"])])])])]),o("div",st,[lt,o("div",at,[o("div",it,[s(ge,{modelValue:e(h),"onUpdate:modelValue":t[8]||(t[8]=c=>x(h)?h.value=c:null),options:e(r),optionLabel:"name",placeholder:"Select Status",class:"w-full"},null,8,["modelValue","options"])]),a.closeStatusError?(_(),j("p",nt," Please set close status! ")):y("",!0)])]),o("div",rt,[ct,s(p,{modelValue:e(E),"onUpdate:modelValue":t[9]||(t[9]=c=>x(E)?E.value=c:null),required:"true"},null,8,["modelValue"])]),e(g)?(_(),j("p",dt," Please add/fill/check up all the fields")):y("",!0)])):y("",!0),o("div",ut,[s(ie,{label:"Cancel",icon:"pi pi-times",text:"",onClick:te}),s(ie,{loading:e(P),label:"Save",icon:"pi pi-check",text:"",onClick:S},null,8,["loading"])])])}}};const mt={class:"card"},_t={class:"d-flex create-space-btn-wrapper mb-3"},vt={class:"breadCrumWrap"},ft=o("p",{class:"pi pi-angle-right"},null,-1),gt=o("p",{class:"pi pi-angle-right responsive-text"},null,-1),ht=o("p",{class:"pi pi-angle-right responsive-text"},null,-1),xt={class:"text cursor-pointer responsive-text"},yt={class:"create-btn-wrapper"},bt={class:"flex justify-content-end mb-2"},kt=o("i",{class:"pi pi-search"},null,-1),St=o("p",{class:"py-2 text-center"},"No Data found...",-1),jt={class:"cursor-pointer proj-name hover:text-primary font-semibold"},wt=o("p",null,"Are you sure you want to delete?",-1),ko={__name:"index",setup(W){const{getSingleSpace:z,deleteProject:X}=H(),{singleSpace:f,singleSpaceProjects:B,isProjectDeleted:n}=me(H()),ae=l(le("create_project")),I=l(le("update_project")),F=l(le("delete_project")),g=l(),K=l(!0),L=_e(),{spaces:w}=Ne().params;if(l(!1),f.value===void 0)throw Ee({statusCode:404,message:"Space not found",fatal:!0});const b=l(null),Y=m=>{b.value=m,console.log("refCompanyId",b.value),k.value=!0},k=l(!1),C=l(!1),v=async()=>{C.value=!0,console.log("refCompanyIdFin",b.value),await X(b.value,w),n.value===!0?(L.add({severity:"success",summary:"Successful",detail:"Project Deleted Successfully",group:"br",life:3e3}),k.value=!1,console.log("space deleted"),C.value=!1):(L.add({severity:"error",summary:"Error",detail:"Unable to delete project",group:"br",life:3e3}),console.log("space not deleted"),C.value=!1)};ve(()=>{z(w),K.value=!1}),(()=>{g.value={global:{value:null,matchMode:Te.CONTAINS}}})();const r=l(!1),V=m=>{r.value=!0,b.value=m},q=m=>{r.value=m},N=l(!0);return(m,d)=>{var t,p;const E=he,T=xe,Z=ye,h=be,ee=ue,P=ke,S=pe,te=pt,a=fe("tooltip");return _(),j("div",mt,[s(E,{position:"bottom-right",group:"br"}),o("div",_t,[o("div",vt,[s(T,{to:"/",class:"text pi pi-home responsive-text"}),ft,s(T,{to:"/companies",class:"text"},{default:u(()=>[$("Companies")]),_:1}),gt,s(T,{class:"text responsive-text",to:`/companies/${(t=e(f))==null?void 0:t.company_id}`},{default:u(()=>{var i;return[$(" Company - "+R((i=e(f))==null?void 0:i.company_name),1)]}),_:1},8,["to"]),ht,o("p",xt,"Space - "+R((p=e(f))==null?void 0:p.name),1)]),o("div",yt,[e(ae)?M((_(),O(Z,{key:0,singleSpace:e(f),spaces:e(w),isPage:e(N)},null,8,["singleSpace","spaces","isPage"])),[[a,{value:"Create Project"},void 0,{left:!0}]]):y("",!0)])]),o("div",bt,[s(P,{iconPosition:"right"},{default:u(()=>[s(h,null,{default:u(()=>[kt]),_:1}),s(ee,{modelValue:e(g).global.value,"onUpdate:modelValue":d[0]||(d[0]=i=>e(g).global.value=i),placeholder:"Keyword Search"},null,8,["modelValue"])]),_:1})]),s(e(De),{filters:e(g),"onUpdate:filters":d[1]||(d[1]=i=>x(g)?g.value=i:null),class:"table-dsp",value:e(B),stripedRows:"",paginator:"",tableStyle:"min-width: 50rem",rows:10,rowsPerPageOptions:[5,10,20,50],dataKey:"id",filterDisplay:"menu",loading:e(K)},{empty:u(()=>[St]),loading:u(()=>[$(" Loading data. Please wait. ")]),default:u(()=>[s(e(J),{field:"index",header:"Serial",sortable:""}),s(e(J),{field:"name",header:"Project Name"},{body:u(i=>[s(T,{to:`/companies/${e(f).company_id}/spaces/${e(f).id}/projects/${i.data.id}`},{default:u(()=>[o("p",jt,R(i.data.name),1)]),_:2},1032,["to"])]),_:1}),s(e(J),{field:"space_name",header:"Under the Space of"}),s(e(J),{header:"Action"},{body:u(i=>[e(I)?(_(),O(S,{key:0,icon:"pi pi-pencil",text:"",class:"",severity:"success",rounded:"",onClick:D=>V(i.data)},null,8,["onClick"])):y("",!0),e(F)?(_(),O(S,{key:1,icon:"pi pi-trash",text:"",class:"",severity:"warning",rounded:"",onClick:D=>Y(i.data.id)},null,8,["onClick"])):y("",!0),e(I)?y("",!0):(_(),O(S,{key:2,icon:"pi pi-pencil",text:"",class:"",severity:"success",style:{visibility:"hidden"}})),e(F)?y("",!0):(_(),O(S,{key:3,icon:"pi pi-trash",text:"",class:"",severity:"warning",style:{visibility:"hidden"}}))]),_:1})]),_:1},8,["filters","value","loading"]),s(e(de),{visible:e(k),"onUpdate:visible":d[3]||(d[3]=i=>x(k)?k.value=i:null),header:" ",dismissableMask:"true",style:{width:"25rem"}},{default:u(()=>[wt,s(S,{label:"No",icon:"pi pi-times",text:"",onClick:d[2]||(d[2]=i=>k.value=!1)}),s(S,{label:"Yes",icon:"pi pi-check",loading:e(C),text:"",onClick:v},null,8,["loading"])]),_:1},8,["visible"]),s(e(de),{visible:e(r),"onUpdate:visible":d[5]||(d[5]=i=>x(r)?r.value=i:null),modal:"",header:"Edit Project",dismissableMask:"true",style:{width:"30rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:u(()=>[s(te,{refProjectId:e(b),singleSpace:e(f),onCloseEditProject:d[4]||(d[4]=i=>q(i))},null,8,["refProjectId","singleSpace"])]),_:1},8,["visible"])])}}};export{ko as default};
