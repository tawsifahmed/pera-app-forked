import Pe from"./dropdown.esm.bebe6347.js";import je from"./calendar.esm.b4c54a4f.js";import Ve from"./button.esm.618db59f.js";import{a as Ie}from"./CreateCompany.4809b45f.js";import{a2 as Le,a6 as O,$ as a,ae as Q,a7 as R,b as c,i as s,l as n,u as m,e as D,F as Fe,f as Me,c as Ae,a as Ue,o as r,s as Be,k as Ne,K as Oe,t as z,a3 as Re,a4 as ze,ca as Ee,as as Ye}from"./entry.adada75d.js";import{u as He}from"./fetch.079d260e.js";import{u as We}from"./cookie.5d273b70.js";import{u as qe}from"./layout.e70b181f.js";import{a as S}from"./usePermission.957acf66.js";import{u as Z}from"./auth.44d7461d.js";import{u as ee}from"./company.bc3d6c99.js";import{u as te}from"./workCompany.5f1846f7.js";import le from"./chart.esm.14bce57c.js";import"./baseicon.esm.d10b284b.js";import"./basecomponent.esm.83c9d650.js";import"./index.esm.5ba39205.js";import"./index.esm.9648514f.js";import"./index.esm.4d026df0.js";import"./index.esm.0e5550b4.js";import"./index.esm.5f422ca7.js";import"./overlayeventbus.esm.3d8cd3db.js";import"./portal.esm.39957f2b.js";import"./virtualscroller.esm.b9b5f7da.js";import"./index.esm.b3310d1a.js";import"./index.esm.b59d805a.js";import"./index.esm.6fb9b1bc.js";import"./badge.esm.87264ac3.js";import"./inputtext.esm.447a6bf2.js";import"./dialog.esm.deaa99fc.js";const h=x=>(Re("data-v-04f7af13"),x=x(),ze(),x),Ge={class:"grid"},Je={key:0,class:"col-12 xl:col-6"},Ke={class:"card h-full"},Xe={class:"flex gap-2 align-items-center flex-wrap",style:{"padding-bottom":"10px"}},Qe=h(()=>s("h5",{class:"mb-2"},"Tasks",-1)),Ze={class:"flex gap-2 flex-wrap justify-content-end filter-container"},et={class:"mb-2 relative w-full md:w-8rem"},tt={class:"mb-2 relative w-full md:w-8rem"},lt={class:"task-container"},at={key:0,class:"flex justify-content-center align-items-center",style:{height:"22rem"}},st=h(()=>s("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2.25rem"}},null,-1)),ot=[st],nt={key:1},it=["onClick"],rt={class:"title-group"},ct={class:"title line-clamp-1",style:{"font-weight":"600"}},ut=h(()=>s("div",{style:{"background-color":"#00000040",height:"5px",width:"5px","border-radius":"15px"}},null,-1)),dt={class:"title-project line-clamp-1"},pt={style:{"font-size":"12px"}},vt={key:2},mt=h(()=>s("p",{class:"text-black text-lg text-center"},"No Tasks found!",-1)),ft=[mt],_t={class:"w-full flex justify-content-center"},gt={class:"col-12 xl:col-6"},ht={class:"card h-full"},yt=h(()=>s("h5",null,"Tasks Statistics",-1)),bt={class:"w-full flex justify-content-center"},Ct={class:"col-12 h-full"},wt={class:"card dashChart"},Dt={class:"flex justify-content-between align-items-start dash-inf"},St={class:"flex align-items-center gap-3 dash-inf-left"},xt=h(()=>s("h5",{class:"mb-0"},"Projects Overview",-1)),kt={class:"flex gap-2 flex-wrap dash-inf-right"},$t={class:"chartWrapper"},Tt={class:"chartAreaWrapper"},Pt={key:1},jt={__name:"index",setup(x){te();const{totalCompanies:Vt,totalProjects:ae}=O(te()),se=Ee(),{getChartData:oe,getTaskAssignModalData:ne,getRoles:ie,getTagsAssignModalData:re}=ee(),{chartProjectInfo:ce,inProgressCnt:ue,chartClosedTaskInfo:de,totalDashboardProjects:pe,completedTasksChartData:E,inProgressTasksChartData:Y,unAssignedTasksChartData:H,users:It,rolesLists:Lt,tags:Ft}=O(ee());Z(),O(Z()),a(S("read_user")),a(S("read_role")),a(S("read_tags"));const ve=a(S("read_task"));a(S("create_company"));const{isDarkTheme:me}=qe();a(null);const fe=a({labels:ce,datasets:[{label:"In Progress",data:ue,fill:!1,backgroundColor:"#6366f1",borderColor:"#6366f1",tension:.4},{label:"Completed",data:de,fill:!1,backgroundColor:"#2f4860",borderColor:"#2f4860",tension:.4}]});Q(()=>{q.value=ge(),R([E,Y,H],([l,e,o])=>{l&&e&&o&&(W.value=_e(l,e,o))},{immediate:!0})});const W=a(),q=a(),_e=(l,e,o)=>(getComputedStyle(document.body),{labels:["Completed","In Progress","Unassigned"],datasets:[{data:[l,e,o],backgroundColor:["#33bd7c","#0ea5e9","#475569"],hoverBackgroundColor:["#1a8251","#0087c3","#2c3644"]}]}),ge=()=>({plugins:{legend:{labels:{usePointStyle:!0,color:getComputedStyle(document.documentElement).getPropertyValue("--text-color")}}}}),y=a([]);a([{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-minus"}]);const I=a(null),L=a(!1),F=a(null),he=()=>{var l;F.value=JSON.parse(localStorage.getItem("userCompany")),F.value===null||((l=F.value)==null?void 0:l.length)==0?L.value=!0:L.value=!1},ye=()=>{I.value={plugins:{legend:{labels:{color:"#495057"}}},scales:{x:{ticks:{color:"#495057"},grid:{color:"#ebedef"}},y:{ticks:{color:"#495057"},grid:{color:"#ebedef"}}}}},be=()=>{I.value={plugins:{legend:{labels:{color:"#ebedef"}}},scales:{x:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}},y:{ticks:{color:"#ebedef"},grid:{color:"rgba(160, 167, 181, .3)"}}}}},u=a(),G=a(),J=a(),f=a(),_=a(),k=a(!1),$=a(!1),M=a(!1);R(u,l=>{var e,o;G.value=[{name:"All",id:""},...((o=(e=u.value)==null?void 0:e.statuses)==null?void 0:o.map(d=>({name:d.name,id:d.id})))||[]]});const b=a(),T=a(),P=a(),A=a(),C=a(),K=a(1);let p=a(1);const v=async()=>{T.value=u.value?u.value.id:"",P.value=b.value?b.value.id:"",A.value=f.value,C.value=_.value,B?p.value++:p.value=1,K.value=p.value,j.value=0,U(T.value,P.value,A.value,C.value,K.value),B=!1},Ce=l=>{k.value=!0;const e=new Date(l);f.value=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate(),v()},we=l=>{$.value=!0;const e=new Date(l);_.value=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate(),v()},De=()=>{k.value=!1,f.value="",C.value="",v()},Se=()=>{$.value=!1,_.value="",C.value="",v()},xe=()=>{if(u.value||J.value||f.value||_.value||p.value>1)u.value="",J.value="",f.value="",_.value="",T.value="",P.value="",b.value="",$.value=!1,k.value=!1,v();else return},ke=async l=>{const e=localStorage.getItem("userCompany");console.log("Task click: ",l),await Ye({path:`/companies/${e}/spaces/${l==null?void 0:l.space_id}/projects/${l==null?void 0:l.project_id}`,query:{task_key:l.id}})},$e=l=>{const e=l,o=new Date(e),d=o.getFullYear(),i=String(o.getMonth()+1).padStart(2,"0");return`${String(o.getDate()).padStart(2,"0")}-${i}-${d}`},j=a(0),X=a(!1),w=a(!1),Te=async l=>{l==="hide-loader"&&(X.value=!0),w.value=!0,p.value++,await U(T.value,P.value,A.value,C.value,p.value)},U=async(l="",e="",o="",d="",i=1)=>{var V;X.value||(M.value=!0);try{const t=We("token"),{data:g,pending:Mt,error:At}=await He(`${se.public.apiUrl}/tasks/list?start_due_date=${o}&end_due_date=${d}&status=${e}&project_id=${l}&limit=30&page=${i}`,{method:"GET",headers:{Authorization:`Bearer ${t.value}`}},"$PslAyef5YX");g.value&&g.value.data&&((V=g.value.counts)!=null&&V.total_tasks)?(j.value=Math.ceil(g.value.counts.total_tasks/30),y.value=i===1?g.value.data:[...y.value,...g.value.data],w.value=!1):(y.value=[],w.value=!1)}catch(t){console.log(t),w.value=!1}finally{M.value=!1}};let B=!1;return window.addEventListener("scroll",()=>{const{scrollTop:l,scrollHeight:e,clientHeight:o}=document.documentElement;l+o>=e-50&&p.value<j&&(B=!0,v())}),U(),Q(()=>{ie(),ne(),re(),oe(),he()}),R(me,l=>{l?be():ye()},{immediate:!0}),(l,e)=>{const o=Pe,d=je,i=Ve,N=Ie,V=Ue("tooltip");return r(),c("div",Ge,[ve.value?(r(),c("div",Je,[s("div",Ke,[s("div",Xe,[Qe,s("div",Ze,[n(o,{onChange:e[0]||(e[0]=t=>v()),modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),options:m(ae),filter:"",resetFilterOnHide:"",optionLabel:"name",placeholder:"Project",class:"w-full md:w-10rem mb-2"},null,8,["modelValue","options"]),n(o,{onChange:e[2]||(e[2]=t=>v()),modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),options:G.value,disabled:!u.value,optionLabel:"name",placeholder:"Status",class:"w-full md:w-10rem mb-2"},null,8,["modelValue","options","disabled"]),s("div",et,[n(d,{onDateSelect:e[4]||(e[4]=t=>Ce(t)),modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=t=>f.value=t),placeholder:"Start Date",class:"w-full md:w-8rem"},null,8,["modelValue"]),k.value?(r(),c("p",{key:0,onClick:De,class:"pi pi-times end-cross absolute cursor-pointer"})):D("",!0)]),s("div",tt,[n(d,{onDateSelect:e[6]||(e[6]=t=>we(t)),modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=t=>_.value=t),placeholder:"Due Date",class:"w-full md:w-8rem"},null,8,["modelValue"]),$.value?(r(),c("p",{key:0,onClick:Se,class:"pi pi-times end-cross absolute cursor-pointer"})):D("",!0)]),n(i,{onClick:xe,label:"Reset",class:"mb-2",severity:"secondary"})])]),s("div",lt,[M.value?(r(),c("div",at,ot)):y.value.length>0?(r(),c("div",nt,[(r(!0),c(Fe,null,Me(y.value,t=>(r(),c("div",{key:t.id,onClick:()=>ke(t),class:"task-card"},[s("div",rt,[Be(s("div",{class:Ne("status"),style:Oe(`background-color: ${t==null?void 0:t.status_color};`)},null,4),[[V,{value:`Status: ${t.status_name}`},void 0,{left:!0}]]),s("p",ct,z(t==null?void 0:t.name),1),ut,s("p",dt,z(t==null?void 0:t.project_name),1)]),s("div",null,[s("p",pt,"Due: "+z(t.due_date?$e(t==null?void 0:t.due_date):"Not Set"),1)])],8,it))),128))])):(r(),c("div",vt,ft)),s("div",_t,[m(p)<j.value?(r(),Ae(i,{key:0,onClick:e[8]||(e[8]=t=>Te("hide-loader")),loading:w.value,label:"Load More",severity:"secondary"},null,8,["loading"])):D("",!0)])])])])):D("",!0),s("div",gt,[s("div",ht,[yt,s("div",bt,[n(m(le),{type:"pie",data:W.value,options:q.value,class:"w-full md:w-30rem"},null,8,["data","options"])])])]),s("div",Ct,[s("div",wt,[s("div",Dt,[s("div",St,[xt,n(i,{class:"nwrp",label:`Total Projects: ${m(pe)}`,severity:"secondary"},null,8,["label"])]),s("div",kt,[n(i,{class:"nwrp",label:`In Progress: ${m(Y)}`,severity:"info",outlined:""},null,8,["label"]),n(i,{class:"nwrp",label:`Unassigned: ${m(H)}`,severity:"help",outlined:""},null,8,["label"]),n(i,{class:"nwrp",label:`Completed: ${m(E)}`,severity:"contrast",outlined:""},null,8,["label"])])]),s("div",$t,[s("div",Tt,[n(m(le),{type:"bar",data:fe.value,options:I.value},null,8,["data","options"])])])])]),L.value?(r(),c("div",Pt,[n(N)])):D("",!0)])}}},pl=Le(jt,[["__scopeId","data-v-04f7af13"]]);export{pl as default};
